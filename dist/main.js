(()=>{"use strict";function e(e){const t=document.querySelector(".project-list");return t.textContent="",e.forEach((e=>{const n=document.createElement("div");n.classList.add("new-project-con");const o=document.createElement("p");o.classList.add("project-title"),o.textContent=e.title,n.appendChild(o),n.appendChild(c()),t.appendChild(n)})),t}function t(e){const t=document.querySelector(".project-task-list");r(),e.forEach((e=>{const n=document.createElement("div");n.classList.add("project-task");const o=document.createElement("div");o.classList.add("project-task-left");const r=document.createElement("div");r.classList.add("checkbox");const d=document.createElement("p");d.classList.add("project-task-desc"),d.textContent=e,o.appendChild(r),o.appendChild(d),n.appendChild(o),n.appendChild(c());const l=document.querySelector(".add-task");return t.insertBefore(n,l)}))}function n(e){r(),document.querySelector(".main-hd").textContent=e.title,document.querySelector(".main-hd-desc").textContent=e.description,document.querySelector(".main-hd-date-user").textContent=e.dueDate;const t=document.querySelector(".main-hd-priority-user");t.textContent=e.priority,t.style.color=o(e.priority);for(const t of document.querySelectorAll(".project-title"))t.textContent.includes(e.title)?(t.setAttribute("style","color: white; opacity: 1;"),t.parentElement.style.backgroundColor="rgba(255, 255, 255, 0.296)"):(t.setAttribute("style","color: #EBEBEB; opacity: .5;"),t.parentElement.style.background="none")}function o(e){return"Low"===e?"green":"Medium"===e?"yellow":"red"}function c(){const e=document.createElement("div");e.classList.add("project-btn");const t=document.createElement("span"),n=document.createElement("span");return t.classList.add("material-icons-outlined"),t.classList.add("edit"),n.classList.add("material-icons-outlined"),n.classList.add("delete"),t.textContent="edit",n.textContent="delete",e.appendChild(t),e.appendChild(n),e}function r(){const e=document.querySelector(".project-task-list"),t=document.querySelectorAll(".project-task");for(let n=0;n<t.length;n++)e.removeChild(document.querySelector(".project-task"));return e}let d=[];let l=[];document.querySelector(".add-project").addEventListener("click",(()=>{!function(){const e=document.querySelector(".project-modal");e.showModal(),document.querySelector(".project-close").addEventListener("click",(()=>{e.close()}))}()})),function(){const t=document.querySelector(".project-form"),o=document.querySelector(".project-modal");t.addEventListener("submit",(c=>{c.preventDefault();const r=document.getElementById("title"),d=document.getElementById("description"),i=document.getElementById("due-date");let s="Low";document.querySelector(".project-modal #medium").checked?s="Medium":document.querySelector(".project-modal #high").checked&&(s="High");const a=((e,t,n,o)=>({title:e,description:t,dueDate:n,priority:o}))(r.value,d.value,i.value,s);return l.push(a),e(l),n(a),o.close(),t.reset(),l}))}(),function(){const e=document.querySelector(".task-form"),n=document.querySelector(".task-modal"),o=document.querySelector(".main-hd");e.addEventListener("submit",(c=>{c.preventDefault();const r=document.getElementById("task-description");if(function(e){if(0===d.length)return!1;for(let t=0;t<d.length;t++)if(d[t].project===e)return!0}(o.textContent)){const e=d.findIndex((e=>e.project===o.textContent));d[e].description.push(r.value),t(d[e].description)}else{const e=((e,t)=>({project:e,description:t}))(o.textContent,[r.value]);d.push(e);const n=d.findIndex((e=>e.project===o.textContent));t(d[n].description)}return n.close(),e.reset(),d}))}(),document.querySelectorAll(".project-list").forEach((e=>{e.addEventListener("click",(e=>{let o="";o="project-title"===e.target.classList.value||"new-project-con"===e.target.classList.value?e.target.childNodes[0].textContent:e.target.parentElement.parentElement.childNodes[0].textContent;const c=l.findIndex((e=>e.title===o));n(l[c]);const r=d.findIndex((e=>e.project===o));-1!==r&&t(d[r].description)}))})),document.querySelectorAll(".project-list").forEach((c=>{c.addEventListener("click",(c=>{if("material-icons-outlined edit"===c.target.classList.value){const o=c.target.parentElement.parentElement.childNodes[0].textContent,r=l.findIndex((e=>e.title===o));d.findIndex((e=>e.project===o)),!function(){const e=document.querySelector(".edit-modal");e.showModal(),document.querySelector(".edit-close").addEventListener("click",(()=>{e.close()}))}(),function(o){const c=document.querySelector(".edit-form"),r=document.querySelector(".edit-modal");c.addEventListener("submit",(i=>{i.preventDefault();const s=document.getElementById("edit-title");l[o].title=s.value;const a=document.getElementById("edit-description");l[o].description=a.value;const u=document.getElementById("edit-due-date");l[o].dueDate=u.value;let m="Low";var p,y;return document.querySelector(".edit-modal #medium").checked?m="Medium":document.querySelector(".edit-modal #high").checked&&(m="High"),l[o].priority=m,console.log("project-module"),console.log(l),e(l),n(l[o]),p=o,y=l[o].title,d[p].project=y,t(d[p].description),console.log(d[p]),r.close(),c.reset(),l}),{once:!0})}(r)}if("material-icons-outlined delete"===c.target.classList.value){const e=c.target.parentElement.parentElement.childNodes[0].textContent;r=l.findIndex((t=>t.title===e)),l.splice(r,1),document.querySelector(".project-list").removeChild(c.target.parentElement.parentElement),function(){if(0===l.length){const e=document.querySelector(".main-hd-con");return e.textContent="",e.style.paddingBottom="6.15rem",e}{document.querySelector(".main-hd").textContent=l[0].title,document.querySelector(".main-hd-desc").textContent=l[0].description,document.querySelector(".main-hd-date-user").textContent=l[0].dueDate;const e=document.querySelector(".main-hd-priority-user");e.textContent=l[0].priority,e.style.color=o(l[0].priority);const t=document.querySelector(".project-title");t.setAttribute("style","color: white; opacity: 1;"),t.parentElement.style.backgroundColor="rgba(255, 255, 255, 0.296)"}}()}var r}))})),document.querySelectorAll(".project-task-list").forEach((e=>{e.addEventListener("click",(e=>{if("material-icons-outlined edit"===e.target.classList.value){const n=e.target.parentElement.parentElement.childNodes[0].childNodes[1].textContent,o=document.querySelector(".main-hd").textContent,c=d.findIndex((e=>e.project===o)),r=d[c].description.findIndex((e=>e===n));console.log(r),function(){const e=document.querySelector(".edit-task-modal");e.showModal(),document.querySelector(".edit-task-close").addEventListener("click",(t=>{e.close()}))}(),function(e,n){const o=document.querySelector(".edit-task-form"),c=document.querySelector(".edit-task-modal");o.addEventListener("submit",(r=>{r.preventDefault();const l=document.getElementById("edit-task-description");return d[e].description[n]=l.value,t(d[e].description),c.close(),o.reset(),d}),{once:!0})}(c,r)}if("material-icons-outlined delete"===e.target.classList.value){const t=e.target.parentElement.parentElement.childNodes[0].childNodes[1].textContent,n=document.querySelector(".main-hd").textContent,o=d.findIndex((e=>e.project===n));!function(e,t){d[e].description.splice(t,1)}(o,d[o].description.findIndex((e=>e===t))),document.querySelector(".project-task-list").removeChild(e.target.parentElement.parentElement)}}))})),document.querySelector(".add-task").addEventListener("click",(()=>{!function(){const e=document.querySelector(".task-modal");e.showModal(),document.querySelector(".task-close").addEventListener("click",(t=>{e.close()}))}()})),document.querySelector(".completed-tab").addEventListener("click",(e=>{const t=e.target.innerText;var n;n=t,document.querySelector(".completed-tab .material-icons-outlined").innerText="Completed\nexpand_more"===n||"expand_more"===n?"expand_less":"expand_more",function(e){const t=document.querySelector(".completed-list");"Completed\nexpand_more"===e||"expand_more"===e?(document.querySelectorAll(".user-project").forEach((e=>{e.addEventListener("mouseover",(()=>{e.setAttribute("style","background-color: rgba(255, 255, 255, 0.296); border-radius: 5px;")})),e.addEventListener("mouseout",(()=>{e.style.background="none"}))})),t.classList.remove("hidden")):t.classList.add("hidden")}(t)}))})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUFvRSxJQUV0RzlCLEVBQVEwQyxpQkFBaUIsWUFBWSxLQUNqQzFDLEVBQVF3QixNQUFNUyxXQUFhLE1BQU0sR0FDbkMsSUFFQ3RDLEVBQWNRLFVBQVV1RixPQUFPLFdBQzdCL0YsRUFBY1EsVUFBVUMsSUFBSSxTQUM3QyxDRzBFUXVGLENBQXFCSCxFQUl6QixHIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vdG8tZG8vLi9zcmMvVUkuanMiLCJ3ZWJwYWNrOi8vdG8tZG8vLi9zcmMvdGFzay5qcyIsIndlYnBhY2s6Ly90by1kby8uL3NyYy9wcm9qZWN0LmpzIiwid2VicGFjazovL3RvLWRvLy4vc3JjL2luZGV4LmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IHByb2plY3RBcnIgfSBmcm9tIFwiLi9wcm9qZWN0XCI7XG5cbmZ1bmN0aW9uIGRpc3BsYXlDb21wbGV0ZWRMaXN0KGlubmVyVGV4dCkge1xuICAgIGNvbnN0IGNvbXBsZXRlZExpc3QgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmNvbXBsZXRlZC1saXN0XCIpO1xuICAgIGlmKGlubmVyVGV4dCA9PT0gXCJDb21wbGV0ZWRcXG5leHBhbmRfbW9yZVwiIHx8IGlubmVyVGV4dCA9PT0gXCJleHBhbmRfbW9yZVwiKSB7XG4gICAgICAgIGNvbnN0IHByb2plY3RIb3ZlciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIudXNlci1wcm9qZWN0XCIpO1xuICAgICAgICBwcm9qZWN0SG92ZXIuZm9yRWFjaCgocHJvamVjdCkgPT4ge1xuICAgICAgICAgICAgcHJvamVjdC5hZGRFdmVudExpc3RlbmVyKFwibW91c2VvdmVyXCIsICgpID0+IHtcbiAgICAgICAgICAgICAgICBwcm9qZWN0LnNldEF0dHJpYnV0ZShcInN0eWxlXCIsIFwiYmFja2dyb3VuZC1jb2xvcjogcmdiYSgyNTUsIDI1NSwgMjU1LCAwLjI5Nik7IGJvcmRlci1yYWRpdXM6IDVweDtcIik7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHByb2plY3QuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlb3V0XCIsICgpID0+IHtcbiAgICAgICAgICAgICAgICBwcm9qZWN0LnN0eWxlLmJhY2tncm91bmQgPSBcIm5vbmVcIjtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KVxuICAgICAgICByZXR1cm4gY29tcGxldGVkTGlzdC5jbGFzc0xpc3QucmVtb3ZlKFwiaGlkZGVuXCIpO1xuICAgIH1lbHNlIHJldHVybiBjb21wbGV0ZWRMaXN0LmNsYXNzTGlzdC5hZGQoXCJoaWRkZW5cIik7XG59XG5cbmZ1bmN0aW9uIGNoYW5nZUFycm93KGFycm93RGlyZWN0aW9uKSB7XG4gICAgY29uc3QgYXJyb3dJY29uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5jb21wbGV0ZWQtdGFiIC5tYXRlcmlhbC1pY29ucy1vdXRsaW5lZFwiKTtcbiAgICBpZihhcnJvd0RpcmVjdGlvbiA9PT0gXCJDb21wbGV0ZWRcXG5leHBhbmRfbW9yZVwiIHx8IGFycm93RGlyZWN0aW9uID09PSBcImV4cGFuZF9tb3JlXCIpIHJldHVybiBhcnJvd0ljb24uaW5uZXJUZXh0ID0gXCJleHBhbmRfbGVzc1wiXG4gICAgZWxzZSByZXR1cm4gYXJyb3dJY29uLmlubmVyVGV4dCA9IFwiZXhwYW5kX21vcmVcIjtcbn1cblxuZnVuY3Rpb24gYWRkVG9Qcm9qZWN0TGlzdChhcnIpIHtcbiAgICBjb25zdCBjb21wbGV0ZWRMaXN0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9qZWN0LWxpc3RcIik7XG4gICAgY29tcGxldGVkTGlzdC50ZXh0Q29udGVudCA9IFwiXCI7XG4gICAgYXJyLmZvckVhY2goKHByb2plY3QpID0+IHtcbiAgICAgICAgY29uc3QgbmV3UHJvamVjdENvbnRhaW5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4gICAgICAgIG5ld1Byb2plY3RDb250YWluZXIuY2xhc3NMaXN0LmFkZChcIm5ldy1wcm9qZWN0LWNvblwiKTtcbiAgICAgICAgY29uc3QgcHJvamVjdFRpdGxlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInBcIik7XG4gICAgICAgIHByb2plY3RUaXRsZS5jbGFzc0xpc3QuYWRkKFwicHJvamVjdC10aXRsZVwiKTtcbiAgICAgICAgcHJvamVjdFRpdGxlLnRleHRDb250ZW50ID0gcHJvamVjdC50aXRsZTtcbiAgICAgICAgbmV3UHJvamVjdENvbnRhaW5lci5hcHBlbmRDaGlsZChwcm9qZWN0VGl0bGUpO1xuICAgICAgICBuZXdQcm9qZWN0Q29udGFpbmVyLmFwcGVuZENoaWxkKGNyZWF0ZVByb2plY3RCdXR0b25zKCkpO1xuICAgICAgICBjb21wbGV0ZWRMaXN0LmFwcGVuZENoaWxkKG5ld1Byb2plY3RDb250YWluZXIpO1xuICAgIH0pXG4gICAgcmV0dXJuIGNvbXBsZXRlZExpc3Q7XG59XG5cbmZ1bmN0aW9uIGRpc3BsYXlUYXNrKGFycikge1xuICAgIGNvbnN0IHRhc2tMaXN0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9qZWN0LXRhc2stbGlzdFwiKTtcbiAgICBjbGVhclRhc2tMaXN0KCk7XG4gICAgYXJyLmZvckVhY2godGFzayA9PiB7XG4gICAgICAgIGNvbnN0IHByb2plY3RUYXNrID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcbiAgICAgICAgcHJvamVjdFRhc2suY2xhc3NMaXN0LmFkZCgncHJvamVjdC10YXNrJyk7XG4gICAgICAgIGNvbnN0IHByb2plY3RUYXNrTGVmdCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4gICAgICAgIHByb2plY3RUYXNrTGVmdC5jbGFzc0xpc3QuYWRkKFwicHJvamVjdC10YXNrLWxlZnRcIik7XG4gICAgICAgIGNvbnN0IGNoZWNrQm94ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcbiAgICAgICAgY2hlY2tCb3guY2xhc3NMaXN0LmFkZCgnY2hlY2tib3gnKTtcbiAgICAgICAgY29uc3QgdGFza0Rlc2NyaXB0aW9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInBcIik7XG4gICAgICAgIHRhc2tEZXNjcmlwdGlvbi5jbGFzc0xpc3QuYWRkKFwicHJvamVjdC10YXNrLWRlc2NcIik7XG4gICAgICAgIHRhc2tEZXNjcmlwdGlvbi50ZXh0Q29udGVudCA9IHRhc2s7XG4gICAgICAgIHByb2plY3RUYXNrTGVmdC5hcHBlbmRDaGlsZChjaGVja0JveCk7XG4gICAgICAgIHByb2plY3RUYXNrTGVmdC5hcHBlbmRDaGlsZCh0YXNrRGVzY3JpcHRpb24pO1xuICAgICAgICBwcm9qZWN0VGFzay5hcHBlbmRDaGlsZChwcm9qZWN0VGFza0xlZnQpO1xuICAgICAgICBwcm9qZWN0VGFzay5hcHBlbmRDaGlsZChjcmVhdGVQcm9qZWN0QnV0dG9ucygpKTtcbiAgICAgICAgY29uc3QgYWRkVGFza0J0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuYWRkLXRhc2tcIik7XG4gICAgICAgIHJldHVybiB0YXNrTGlzdC5pbnNlcnRCZWZvcmUocHJvamVjdFRhc2ssIGFkZFRhc2tCdG4pO1xuICAgIH0pO1xufVxuXG5mdW5jdGlvbiBkaXNwbGF5UHJvamVjdChwcm9qZWN0T2JqKSB7XG4gICAgY2xlYXJUYXNrTGlzdCgpO1xuICAgIGNvbnN0IGhlYWRlciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubWFpbi1oZFwiKTtcbiAgICBoZWFkZXIudGV4dENvbnRlbnQgPSBwcm9qZWN0T2JqLnRpdGxlO1xuICAgIGNvbnN0IGRlc2NyaXB0aW9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tYWluLWhkLWRlc2NcIik7XG4gICAgZGVzY3JpcHRpb24udGV4dENvbnRlbnQgPSBwcm9qZWN0T2JqLmRlc2NyaXB0aW9uO1xuICAgIGNvbnN0IGRhdGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLm1haW4taGQtZGF0ZS11c2VyXCIpO1xuICAgIGRhdGUudGV4dENvbnRlbnQgPSBwcm9qZWN0T2JqLmR1ZURhdGU7XG4gICAgY29uc3QgcHJpb3JpdHkgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLm1haW4taGQtcHJpb3JpdHktdXNlclwiKTtcbiAgICBwcmlvcml0eS50ZXh0Q29udGVudCA9IHByb2plY3RPYmoucHJpb3JpdHk7XG4gICAgcHJpb3JpdHkuc3R5bGUuY29sb3IgPSBjaGFuZ2VQcmlvcml0eUNvbG9yKHByb2plY3RPYmoucHJpb3JpdHkpO1xuXG4gICAgLy9pdGVyYXRlIHRocm91Z2ggcHJvamVjdCB0aXRsZSBlbGVtZW50IHRoYXQgY29udGFpbnMgcHJvamVjdCB0aXRsZVxuICAgIGZvciAoY29uc3QgYSBvZiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLnByb2plY3QtdGl0bGVcIikpIHtcbiAgICAgICAgaWYoYS50ZXh0Q29udGVudC5pbmNsdWRlcyhwcm9qZWN0T2JqLnRpdGxlKSkge1xuICAgICAgICAgICAgYS5zZXRBdHRyaWJ1dGUoXCJzdHlsZVwiLCBcImNvbG9yOiB3aGl0ZTsgb3BhY2l0eTogMTtcIik7XG4gICAgICAgICAgICBhLnBhcmVudEVsZW1lbnQuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gXCJyZ2JhKDI1NSwgMjU1LCAyNTUsIDAuMjk2KVwiO1xuICAgICAgICB9ZWxzZSB7XG4gICAgICAgICAgICBhLnNldEF0dHJpYnV0ZShcInN0eWxlXCIsIFwiY29sb3I6ICNFQkVCRUI7IG9wYWNpdHk6IC41O1wiKTtcbiAgICAgICAgICAgIGEucGFyZW50RWxlbWVudC5zdHlsZS5iYWNrZ3JvdW5kID0gXCJub25lXCI7XG4gICAgICAgIH1cbiAgICB9XG59XG5cbmZ1bmN0aW9uIHJlbW92ZVByb2plY3QoKSB7XG4gICAgaWYocHJvamVjdEFyci5sZW5ndGggPT09IDApIHtcbiAgICAgICAgY29uc3QgaGVhZGVyQ29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tYWluLWhkLWNvblwiKTtcbiAgICAgICAgaGVhZGVyQ29udGFpbmVyLnRleHRDb250ZW50ID0gXCJcIjtcbiAgICAgICAgaGVhZGVyQ29udGFpbmVyLnN0eWxlLnBhZGRpbmdCb3R0b20gPSBcIjYuMTVyZW1cIjtcbiAgICAgICAgcmV0dXJuIGhlYWRlckNvbnRhaW5lcjtcbiAgICB9ZWxzZSB7XG4gICAgICAgIGNvbnN0IGhlYWRlciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubWFpbi1oZFwiKTtcbiAgICAgICAgaGVhZGVyLnRleHRDb250ZW50ID0gcHJvamVjdEFyclswXS50aXRsZTtcbiAgICAgICAgY29uc3QgZGVzY3JpcHRpb24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLm1haW4taGQtZGVzY1wiKTtcbiAgICAgICAgZGVzY3JpcHRpb24udGV4dENvbnRlbnQgPSBwcm9qZWN0QXJyWzBdLmRlc2NyaXB0aW9uO1xuICAgICAgICBjb25zdCBkYXRlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tYWluLWhkLWRhdGUtdXNlclwiKTtcbiAgICAgICAgZGF0ZS50ZXh0Q29udGVudCA9IHByb2plY3RBcnJbMF0uZHVlRGF0ZTtcbiAgICAgICAgY29uc3QgcHJpb3JpdHkgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLm1haW4taGQtcHJpb3JpdHktdXNlclwiKTtcbiAgICAgICAgcHJpb3JpdHkudGV4dENvbnRlbnQgPSBwcm9qZWN0QXJyWzBdLnByaW9yaXR5O1xuICAgICAgICBwcmlvcml0eS5zdHlsZS5jb2xvciA9IGNoYW5nZVByaW9yaXR5Q29sb3IocHJvamVjdEFyclswXS5wcmlvcml0eSk7XG4gICAgICAgIGNvbnN0IHNlbGVjdGVkID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9qZWN0LXRpdGxlXCIpO1xuICAgICAgICBzZWxlY3RlZC5zZXRBdHRyaWJ1dGUoXCJzdHlsZVwiLCBcImNvbG9yOiB3aGl0ZTsgb3BhY2l0eTogMTtcIik7XG4gICAgICAgIHNlbGVjdGVkLnBhcmVudEVsZW1lbnQuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gXCJyZ2JhKDI1NSwgMjU1LCAyNTUsIDAuMjk2KVwiO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gY2hhbmdlUHJpb3JpdHlDb2xvcihwcmlvcml0eSkge1xuICAgIGlmKHByaW9yaXR5ID09PSBcIkxvd1wiKSByZXR1cm4gXCJncmVlblwiO1xuICAgIGVsc2UgaWYocHJpb3JpdHkgPT09IFwiTWVkaXVtXCIpIHJldHVybiBcInllbGxvd1wiO1xuICAgIGVsc2UgcmV0dXJuIFwicmVkXCI7XG59XG5cbmZ1bmN0aW9uIGNyZWF0ZVByb2plY3RCdXR0b25zKCkge1xuICAgIGNvbnN0IHByb2plY3RCdG4gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICAgIHByb2plY3RCdG4uY2xhc3NMaXN0LmFkZChcInByb2plY3QtYnRuXCIpO1xuICAgIGNvbnN0IGVkaXRCdG4gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwic3BhblwiKTtcbiAgICBjb25zdCBkZWxldGVCdG4gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwic3BhblwiKTtcbiAgICBlZGl0QnRuLmNsYXNzTGlzdC5hZGQoXCJtYXRlcmlhbC1pY29ucy1vdXRsaW5lZFwiKTtcbiAgICBlZGl0QnRuLmNsYXNzTGlzdC5hZGQoXCJlZGl0XCIpO1xuICAgIGRlbGV0ZUJ0bi5jbGFzc0xpc3QuYWRkKFwibWF0ZXJpYWwtaWNvbnMtb3V0bGluZWRcIik7XG4gICAgZGVsZXRlQnRuLmNsYXNzTGlzdC5hZGQoXCJkZWxldGVcIik7XG4gICAgZWRpdEJ0bi50ZXh0Q29udGVudCA9IFwiZWRpdFwiO1xuICAgIGRlbGV0ZUJ0bi50ZXh0Q29udGVudCA9IFwiZGVsZXRlXCI7XG4gICAgcHJvamVjdEJ0bi5hcHBlbmRDaGlsZChlZGl0QnRuKTtcbiAgICBwcm9qZWN0QnRuLmFwcGVuZENoaWxkKGRlbGV0ZUJ0bik7XG4gICAgcmV0dXJuIHByb2plY3RCdG47XG59XG5cbmZ1bmN0aW9uIGNsZWFyVGFza0xpc3QoKSB7XG4gICAgY29uc3QgdGFza0xpc3QgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2plY3QtdGFzay1saXN0XCIpO1xuICAgIGNvbnN0IHByb2plY3RUYXNrID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5wcm9qZWN0LXRhc2tcIik7XG4gICAgZm9yKGxldCBpID0gMDsgaSA8IHByb2plY3RUYXNrLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIHRhc2tMaXN0LnJlbW92ZUNoaWxkKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvamVjdC10YXNrXCIpKTtcbiAgICB9XG4gICAgcmV0dXJuIHRhc2tMaXN0O1xufVxuXG5leHBvcnQge2Rpc3BsYXlDb21wbGV0ZWRMaXN0LCBjaGFuZ2VBcnJvdywgYWRkVG9Qcm9qZWN0TGlzdCwgZGlzcGxheVByb2plY3QsIGRpc3BsYXlUYXNrLCByZW1vdmVQcm9qZWN0fTsiLCJpbXBvcnQgeyBhZGRUb1Rhc2tMaXN0LCBkaXNwbGF5VGFzayB9IGZyb20gXCIuL1VJXCI7XG5cbmxldCB0YXNrQXJyID0gW107XG5cbmZ1bmN0aW9uIHRhc2tNb2RhbCgpIHtcbiAgICBjb25zdCB0YXNrTW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnRhc2stbW9kYWxcIik7XG4gICAgdGFza01vZGFsLnNob3dNb2RhbCgpO1xuICAgIGNvbnN0IGNsb3NlQnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi50YXNrLWNsb3NlXCIpO1xuICAgIGNsb3NlQnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZSkgPT4ge1xuICAgICAgICB0YXNrTW9kYWwuY2xvc2UoKTtcbiAgICB9KTtcbiAgICByZXR1cm4gdGFza01vZGFsO1xufVxuXG5mdW5jdGlvbiB0YXNrRm9ybSgpIHtcbiAgICBjb25zdCBmb3JtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi50YXNrLWZvcm1cIik7XG4gICAgY29uc3QgdGFza01vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi50YXNrLW1vZGFsXCIpO1xuICAgIGNvbnN0IHRpdGxlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tYWluLWhkXCIpO1xuICAgIGZvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZSkgPT4ge1xuICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIGNvbnN0IGRlc2NyaXB0aW9uID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJ0YXNrLWRlc2NyaXB0aW9uXCIpO1xuICAgICAgICBpZighY2hlY2tUYXNrQXJyYXkodGl0bGUudGV4dENvbnRlbnQpKSB7XG4gICAgICAgICAgICBjb25zdCBuZXdUYXNrID0gdXNlclRhc2sodGl0bGUudGV4dENvbnRlbnQsIFtkZXNjcmlwdGlvbi52YWx1ZV0pO1xuICAgICAgICAgICAgdGFza0Fyci5wdXNoKG5ld1Rhc2spO1xuICAgICAgICAgICAgY29uc3QgcHJvamVjdEluZGV4ID0gdGFza0Fyci5maW5kSW5kZXgodGFzayA9PiB0YXNrLnByb2plY3QgPT09IHRpdGxlLnRleHRDb250ZW50KTtcbiAgICAgICAgICAgIGRpc3BsYXlUYXNrKHRhc2tBcnJbcHJvamVjdEluZGV4XS5kZXNjcmlwdGlvbik7XG4gICAgICAgIH1lbHNlIHtcbiAgICAgICAgICAgIGNvbnN0IHByb2plY3RJbmRleCA9IHRhc2tBcnIuZmluZEluZGV4KHRhc2sgPT4gdGFzay5wcm9qZWN0ID09PSB0aXRsZS50ZXh0Q29udGVudCk7XG4gICAgICAgICAgICB0YXNrQXJyW3Byb2plY3RJbmRleF0uZGVzY3JpcHRpb24ucHVzaChkZXNjcmlwdGlvbi52YWx1ZSk7IFxuICAgICAgICAgICAgZGlzcGxheVRhc2sodGFza0Fycltwcm9qZWN0SW5kZXhdLmRlc2NyaXB0aW9uKTtcbiAgICAgICAgfVxuICAgICAgICAvLyBhZGRUb1Rhc2tMaXN0KHRhc2tBcnIpO1xuICAgICAgICB0YXNrTW9kYWwuY2xvc2UoKTtcbiAgICAgICAgZm9ybS5yZXNldCgpO1xuICAgICAgICAvLyBjb25zb2xlLmxvZyh0YXNrQXJyKTtcbiAgICAgICAgLy8gY29uc29sZS5sb2codGFza0FyclswXS5kZXNjcmlwdGlvbik7XG4gICAgICAgIHJldHVybiB0YXNrQXJyO1xuICAgIH0pXG59XG5cbmZ1bmN0aW9uIGVkaXRUYXNrTW9kYWwoKSB7XG4gICAgY29uc3QgdGFza01vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5lZGl0LXRhc2stbW9kYWxcIik7XG4gICAgdGFza01vZGFsLnNob3dNb2RhbCgpO1xuICAgIGNvbnN0IGNsb3NlQnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5lZGl0LXRhc2stY2xvc2VcIik7XG4gICAgY2xvc2VCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChlKSA9PiB7XG4gICAgICAgIHRhc2tNb2RhbC5jbG9zZSgpO1xuICAgIH0pO1xuICAgIHJldHVybiB0YXNrTW9kYWw7XG59XG5cbmZ1bmN0aW9uIGVkaXRUYXNrRm9ybSh0YXNrSW5kZXgsIHRhc2tEZXNjKSB7XG4gICAgY29uc3QgZm9ybSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZWRpdC10YXNrLWZvcm1cIik7XG4gICAgY29uc3QgdGFza01vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5lZGl0LXRhc2stbW9kYWxcIik7XG4gICAgZm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChlKSA9PiB7XG4gICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgY29uc3QgZGVzY3JpcHRpb24gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImVkaXQtdGFzay1kZXNjcmlwdGlvblwiKTtcbiAgICAgICAgdGFza0Fyclt0YXNrSW5kZXhdLmRlc2NyaXB0aW9uW3Rhc2tEZXNjXSA9IGRlc2NyaXB0aW9uLnZhbHVlO1xuICAgICAgICBkaXNwbGF5VGFzayh0YXNrQXJyW3Rhc2tJbmRleF0uZGVzY3JpcHRpb24pO1xuICAgICAgICB0YXNrTW9kYWwuY2xvc2UoKTtcbiAgICAgICAgZm9ybS5yZXNldCgpO1xuICAgICAgICByZXR1cm4gdGFza0FycjtcbiAgICB9LCB7b25jZTogdHJ1ZX0pO1xufVxuXG5mdW5jdGlvbiBkZWxldGVUYXNrKHRhc2tJbmRleCwgZGVzY0luZGV4KSB7XG4gICAgcmV0dXJuIHRhc2tBcnJbdGFza0luZGV4XS5kZXNjcmlwdGlvbi5zcGxpY2UoZGVzY0luZGV4LCAxKTtcbn1cblxuZnVuY3Rpb24gdXBkYXRlVGFzayhpbmRleCwgbmV3VGl0bGUpIHtcbiAgICB0YXNrQXJyW2luZGV4XS5wcm9qZWN0ID0gbmV3VGl0bGU7XG4gICAgZGlzcGxheVRhc2sodGFza0FycltpbmRleF0uZGVzY3JpcHRpb24pO1xuICAgIGNvbnNvbGUubG9nKHRhc2tBcnJbaW5kZXhdKTtcbiAgICByZXR1cm4gdGFza0Fycjtcbn1cblxuZnVuY3Rpb24gY2hlY2tUYXNrQXJyYXkodGl0bGUpIHtcbiAgICBpZih0YXNrQXJyLmxlbmd0aCA9PT0gMCkgcmV0dXJuIGZhbHNlO1xuICAgIGZvcihsZXQgeCA9IDA7IHggPCB0YXNrQXJyLmxlbmd0aDsgeCsrKSB7XG4gICAgICAgIGlmKHRhc2tBcnJbeF0ucHJvamVjdCA9PT0gdGl0bGUpIHJldHVybiB0cnVlO1xuICAgIH1cbn1cblxuY29uc3QgdXNlclRhc2sgPSAocHJvamVjdCwgZGVzY3JpcHRpb24pID0+IHtcbiAgICByZXR1cm4ge3Byb2plY3QsIGRlc2NyaXB0aW9ufTtcbn0gXG5cbmV4cG9ydCB7dGFza01vZGFsLCB0YXNrRm9ybSwgdGFza0FyciwgdXBkYXRlVGFzaywgZWRpdFRhc2tNb2RhbCwgZWRpdFRhc2tGb3JtLCBkZWxldGVUYXNrfTsiLCJpbXBvcnQgeyBhZGRUb1Byb2plY3RMaXN0LCBkaXNwbGF5UHJvamVjdCB9IGZyb20gXCIuL1VJXCI7XG5pbXBvcnQgeyB1cGRhdGVUYXNrIH0gZnJvbSBcIi4vdGFza1wiO1xuXG5sZXQgcHJvamVjdEFyciA9IFtdO1xuXG5mdW5jdGlvbiBwcm9qZWN0TW9kYWwoKSB7XG4gICAgY29uc3QgcHJvamVjdE1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9qZWN0LW1vZGFsXCIpO1xuICAgIHByb2plY3RNb2RhbC5zaG93TW9kYWwoKTtcbiAgICBjb25zdCBjbG9zZUJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvamVjdC1jbG9zZVwiKTtcbiAgICBjbG9zZUJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgICAgICBwcm9qZWN0TW9kYWwuY2xvc2UoKTtcbiAgICB9KTtcbiAgICByZXR1cm4gcHJvamVjdE1vZGFsO1xufVxuXG5mdW5jdGlvbiBwcm9qZWN0Rm9ybSgpIHtcbiAgICBjb25zdCBmb3JtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9qZWN0LWZvcm1cIik7XG4gICAgY29uc3QgcHJvamVjdE1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9qZWN0LW1vZGFsXCIpO1xuICAgIGZvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZSkgPT4ge1xuICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIGNvbnN0IHRpdGxlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJ0aXRsZVwiKTtcbiAgICAgICAgY29uc3QgZGVzY3JpcHRpb24gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImRlc2NyaXB0aW9uXCIpO1xuICAgICAgICBjb25zdCBkdWVEYXRlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJkdWUtZGF0ZVwiKTtcbiAgICAgICAgbGV0IHByaW9yaXR5ID0gXCJMb3dcIjtcbiAgICAgICAgaWYoZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9qZWN0LW1vZGFsICNtZWRpdW1cIikuY2hlY2tlZCkgcHJpb3JpdHkgPSBcIk1lZGl1bVwiO1xuICAgICAgICBlbHNlIGlmKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvamVjdC1tb2RhbCAjaGlnaFwiKS5jaGVja2VkKSBwcmlvcml0eSA9IFwiSGlnaFwiO1xuICAgICAgICBlbHNlIHByaW9yaXR5O1xuICAgICAgICBjb25zdCBuZXdQcm9qZWN0ID0gdXNlclByb2plY3QodGl0bGUudmFsdWUsIGRlc2NyaXB0aW9uLnZhbHVlLCBkdWVEYXRlLnZhbHVlLCBwcmlvcml0eSk7XG4gICAgICAgIHByb2plY3RBcnIucHVzaChuZXdQcm9qZWN0KTtcbiAgICAgICAgYWRkVG9Qcm9qZWN0TGlzdChwcm9qZWN0QXJyKTtcbiAgICAgICAgZGlzcGxheVByb2plY3QobmV3UHJvamVjdCk7XG4gICAgICAgIHByb2plY3RNb2RhbC5jbG9zZSgpO1xuICAgICAgICBmb3JtLnJlc2V0KCk7XG4gICAgICAgIC8vIGNvbnNvbGUubG9nKHByb2plY3RBcnIpO1xuICAgICAgICByZXR1cm4gcHJvamVjdEFycjtcbiAgICB9KTtcbn1cblxuZnVuY3Rpb24gZWRpdE1vZGFsKCkge1xuICAgIGNvbnN0IGVkaXRNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZWRpdC1tb2RhbFwiKTtcbiAgICBlZGl0TW9kYWwuc2hvd01vZGFsKCk7XG4gICAgY29uc3QgY2xvc2VCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmVkaXQtY2xvc2VcIik7XG4gICAgY2xvc2VCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICAgICAgZWRpdE1vZGFsLmNsb3NlKCk7XG4gICAgfSk7XG4gICAgcmV0dXJuIGVkaXRNb2RhbDtcbn1cblxuZnVuY3Rpb24gZWRpdEZvcm0ocHJvamVjdEluZGV4KSB7XG4gICAgY29uc3QgZm9ybSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZWRpdC1mb3JtXCIpO1xuICAgIGNvbnN0IHByb2plY3RNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZWRpdC1tb2RhbFwiKTtcbiAgICBmb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGUpID0+IHtcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICBjb25zdCB0aXRsZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiZWRpdC10aXRsZVwiKTtcbiAgICAgICAgcHJvamVjdEFycltwcm9qZWN0SW5kZXhdLnRpdGxlID0gdGl0bGUudmFsdWU7XG4gICAgICAgIGNvbnN0IGRlc2NyaXB0aW9uID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJlZGl0LWRlc2NyaXB0aW9uXCIpO1xuICAgICAgICBwcm9qZWN0QXJyW3Byb2plY3RJbmRleF0uZGVzY3JpcHRpb24gPSBkZXNjcmlwdGlvbi52YWx1ZTtcbiAgICAgICAgY29uc3QgZHVlRGF0ZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiZWRpdC1kdWUtZGF0ZVwiKTtcbiAgICAgICAgcHJvamVjdEFycltwcm9qZWN0SW5kZXhdLmR1ZURhdGUgPSBkdWVEYXRlLnZhbHVlO1xuICAgICAgICBsZXQgcHJpb3JpdHkgPSBcIkxvd1wiO1xuICAgICAgICBpZihkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmVkaXQtbW9kYWwgI21lZGl1bVwiKS5jaGVja2VkKSBwcmlvcml0eSA9IFwiTWVkaXVtXCI7XG4gICAgICAgIGVsc2UgaWYoZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5lZGl0LW1vZGFsICNoaWdoXCIpLmNoZWNrZWQpIHByaW9yaXR5ID0gXCJIaWdoXCI7XG4gICAgICAgIGVsc2UgcHJpb3JpdHk7XG4gICAgICAgIHByb2plY3RBcnJbcHJvamVjdEluZGV4XS5wcmlvcml0eSA9IHByaW9yaXR5O1xuICAgICAgICBjb25zb2xlLmxvZyhcInByb2plY3QtbW9kdWxlXCIpO1xuICAgICAgICBjb25zb2xlLmxvZyhwcm9qZWN0QXJyKTtcbiAgICAgICAgYWRkVG9Qcm9qZWN0TGlzdChwcm9qZWN0QXJyKTtcbiAgICAgICAgZGlzcGxheVByb2plY3QocHJvamVjdEFycltwcm9qZWN0SW5kZXhdKTtcbiAgICAgICAgdXBkYXRlVGFzayhwcm9qZWN0SW5kZXgsIHByb2plY3RBcnJbcHJvamVjdEluZGV4XS50aXRsZSk7XG4gICAgICAgIHByb2plY3RNb2RhbC5jbG9zZSgpO1xuICAgICAgICBmb3JtLnJlc2V0KCk7XG4gICAgICAgIHJldHVybiBwcm9qZWN0QXJyO1xuICAgIH0sIHtvbmNlOiB0cnVlfSk7IC8vcHJldmVudCBmb3JtIGZyb20gc3VibWl0dGluZyB0d2ljZSB3aGVuIGVkaXRpbmcgbW9yZSB0aGFuIG9uY2Vcbn1cblxuZnVuY3Rpb24gZGVsZXRlUHJvamVjdChwcm9qZWN0SW5kZXgpIHtcbiAgICByZXR1cm4gcHJvamVjdEFyci5zcGxpY2UocHJvamVjdEluZGV4LCAxKTtcbn1cblxuY29uc3QgdXNlclByb2plY3QgPSAodGl0bGUsIGRlc2NyaXB0aW9uLCBkdWVEYXRlLCBwcmlvcml0eSkgPT4ge1xuICAgIHJldHVybiB7dGl0bGUsIGRlc2NyaXB0aW9uLCBkdWVEYXRlLCBwcmlvcml0eX07XG59IFxuXG5cbmV4cG9ydCB7cHJvamVjdE1vZGFsLCBwcm9qZWN0Rm9ybSwgcHJvamVjdEFyciwgZWRpdE1vZGFsLCBlZGl0Rm9ybSwgZGVsZXRlUHJvamVjdH07IiwiaW1wb3J0IHsgcHJvamVjdE1vZGFsLCBwcm9qZWN0Rm9ybSwgcHJvamVjdEFyciwgZWRpdE1vZGFsLCBlZGl0Rm9ybSwgZGVsZXRlUHJvamVjdH0gZnJvbSBcIi4vcHJvamVjdFwiO1xuaW1wb3J0IHsgdGFza01vZGFsLCB0YXNrRm9ybSwgdGFza0FyciwgdXBkYXRlVGFzaywgZWRpdFRhc2tNb2RhbCwgZWRpdFRhc2tGb3JtLCBkZWxldGVUYXNrIH0gZnJvbSBcIi4vdGFza1wiO1xuaW1wb3J0IHsgZGlzcGxheUNvbXBsZXRlZExpc3QsIGNoYW5nZUFycm93LCBkaXNwbGF5UHJvamVjdCwgZGlzcGxheVRhc2ssIHJlbW92ZVByb2plY3R9IGZyb20gXCIuL1VJXCI7XG5cbmNvbnN0IGFkZFByb2plY3RCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmFkZC1wcm9qZWN0XCIpO1xuYWRkUHJvamVjdEJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgIHByb2plY3RNb2RhbCgpO1xufSk7XG5cbnByb2plY3RGb3JtKCk7XG50YXNrRm9ybSgpO1xuXG5jb25zdCBwcm9qZWN0TGlzdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIucHJvamVjdC1saXN0XCIpO1xucHJvamVjdExpc3QuZm9yRWFjaCgocHJvamVjdCkgPT4ge1xuICAgIHByb2plY3QuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChlKSA9PiB7XG4gICAgICAgIC8vIGNvbnNvbGUubG9nKHByb2plY3RBcnIpO1xuICAgICAgICBsZXQgcHJvamVjdFRpdGxlID0gXCJcIjtcbiAgICAgICAgaWYoZS50YXJnZXQuY2xhc3NMaXN0LnZhbHVlID09PSBcInByb2plY3QtdGl0bGVcIikge1xuICAgICAgICAgICAgcHJvamVjdFRpdGxlID0gZS50YXJnZXQuY2hpbGROb2Rlc1swXS50ZXh0Q29udGVudDtcbiAgICAgICAgfWVsc2UgaWYoZS50YXJnZXQuY2xhc3NMaXN0LnZhbHVlID09PSBcIm5ldy1wcm9qZWN0LWNvblwiKSB7XG4gICAgICAgICAgICBwcm9qZWN0VGl0bGUgPSBlLnRhcmdldC5jaGlsZE5vZGVzWzBdLnRleHRDb250ZW50O1xuICAgICAgICB9ZWxzZSB7XG4gICAgICAgICAgICBwcm9qZWN0VGl0bGUgPSBlLnRhcmdldC5wYXJlbnRFbGVtZW50LnBhcmVudEVsZW1lbnQuY2hpbGROb2Rlc1swXS50ZXh0Q29udGVudDtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBwcm9qZWN0SW5kZXggPSBwcm9qZWN0QXJyLmZpbmRJbmRleChwcm9qZWN0ID0+IHByb2plY3QudGl0bGUgPT09IHByb2plY3RUaXRsZSk7XG4gICAgICAgIGRpc3BsYXlQcm9qZWN0KHByb2plY3RBcnJbcHJvamVjdEluZGV4XSk7XG4gICAgICAgIGNvbnN0IHRhc2tJbmRleCA9IHRhc2tBcnIuZmluZEluZGV4KHRhc2sgPT4gdGFzay5wcm9qZWN0ID09PSBwcm9qZWN0VGl0bGUpO1xuICAgICAgICBpZih0YXNrSW5kZXggIT09IC0xKSBkaXNwbGF5VGFzayh0YXNrQXJyW3Rhc2tJbmRleF0uZGVzY3JpcHRpb24pO1xuICAgIH0pXG59KVxuXG5jb25zdCBwcm9qZWN0QnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5wcm9qZWN0LWxpc3RcIik7XG5wcm9qZWN0QnRuLmZvckVhY2goYnRuID0+IHtcbiAgICBidG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChlKSA9PiB7XG4gICAgICAgIGlmKGUudGFyZ2V0LmNsYXNzTGlzdC52YWx1ZSA9PT0gXCJtYXRlcmlhbC1pY29ucy1vdXRsaW5lZCBlZGl0XCIpIHtcbiAgICAgICAgICAgIGNvbnN0IHRpdGxlID0gZS50YXJnZXQucGFyZW50RWxlbWVudC5wYXJlbnRFbGVtZW50LmNoaWxkTm9kZXNbMF0udGV4dENvbnRlbnQ7XG4gICAgICAgICAgICBjb25zdCBwcm9qZWN0SW5kZXggPSBwcm9qZWN0QXJyLmZpbmRJbmRleChwcm9qZWN0ID0+IHByb2plY3QudGl0bGUgPT09IHRpdGxlKTtcbiAgICAgICAgICAgIGNvbnN0IHRhc2tJbmRleCA9IHRhc2tBcnIuZmluZEluZGV4KHRhc2sgPT4gdGFzay5wcm9qZWN0ID09PSB0aXRsZSk7XG4gICAgICAgICAgICBlZGl0TW9kYWwoKTtcbiAgICAgICAgICAgIGVkaXRGb3JtKHByb2plY3RJbmRleCk7XG4gICAgICAgICAgICAvLyB1cGRhdGVUYXNrKHRhc2tJbmRleCwgdGl0bGUpO1xuICAgICAgICAgICAgLy8gY29uc29sZS5sb2coXCJpbmRleCBtb2R1bGVcIik7XG4gICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhwcm9qZWN0QXJyKTtcbiAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKHByb2plY3RBcnJbcHJvamVjdEluZGV4XSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYoZS50YXJnZXQuY2xhc3NMaXN0LnZhbHVlID09PSBcIm1hdGVyaWFsLWljb25zLW91dGxpbmVkIGRlbGV0ZVwiKSB7XG4gICAgICAgICAgICBjb25zdCB0aXRsZSA9IGUudGFyZ2V0LnBhcmVudEVsZW1lbnQucGFyZW50RWxlbWVudC5jaGlsZE5vZGVzWzBdLnRleHRDb250ZW50O1xuICAgICAgICAgICAgY29uc3QgcHJvamVjdEluZGV4ID0gcHJvamVjdEFyci5maW5kSW5kZXgocHJvamVjdCA9PiBwcm9qZWN0LnRpdGxlID09PSB0aXRsZSk7XG4gICAgICAgICAgICBkZWxldGVQcm9qZWN0KHByb2plY3RJbmRleCk7XG4gICAgICAgICAgICBjb25zdCBwcm9qZWN0TGlzdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvamVjdC1saXN0XCIpO1xuICAgICAgICAgICAgcHJvamVjdExpc3QucmVtb3ZlQ2hpbGQoZS50YXJnZXQucGFyZW50RWxlbWVudC5wYXJlbnRFbGVtZW50KTtcbiAgICAgICAgICAgIHJlbW92ZVByb2plY3QocHJvamVjdEFycik7XG4gICAgICAgIH1cbiAgICB9KVxufSlcblxuY29uc3QgdGFza0J0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIucHJvamVjdC10YXNrLWxpc3RcIik7XG50YXNrQnRuLmZvckVhY2godGFzayA9PiB7XG4gICAgdGFzay5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGUpID0+IHtcbiAgICAgICAgaWYoZS50YXJnZXQuY2xhc3NMaXN0LnZhbHVlID09PSBcIm1hdGVyaWFsLWljb25zLW91dGxpbmVkIGVkaXRcIikge1xuICAgICAgICAgICAgY29uc3QgdGFza0Rlc2MgPSBlLnRhcmdldC5wYXJlbnRFbGVtZW50LnBhcmVudEVsZW1lbnQuY2hpbGROb2Rlc1swXS5jaGlsZE5vZGVzWzFdLnRleHRDb250ZW50O1xuICAgICAgICAgICAgY29uc3QgaGVhZGVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tYWluLWhkXCIpLnRleHRDb250ZW50O1xuICAgICAgICAgICAgY29uc3QgdGFza0luZGV4ID0gdGFza0Fyci5maW5kSW5kZXgodGFzayA9PiB0YXNrLnByb2plY3QgPT09IGhlYWRlcik7XG4gICAgICAgICAgICBjb25zdCBkZXNjSW5kZXggPSB0YXNrQXJyW3Rhc2tJbmRleF0uZGVzY3JpcHRpb24uZmluZEluZGV4KGRlc2MgPT4gZGVzYyA9PT0gdGFza0Rlc2MpO1xuICAgICAgICAgICAgY29uc29sZS5sb2coZGVzY0luZGV4KTtcbiAgICAgICAgICAgIGVkaXRUYXNrTW9kYWwoKTtcbiAgICAgICAgICAgIGVkaXRUYXNrRm9ybSh0YXNrSW5kZXgsIGRlc2NJbmRleCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYoZS50YXJnZXQuY2xhc3NMaXN0LnZhbHVlID09PSBcIm1hdGVyaWFsLWljb25zLW91dGxpbmVkIGRlbGV0ZVwiKSB7XG4gICAgICAgICAgICBjb25zdCB0YXNrRGVzYyA9IGUudGFyZ2V0LnBhcmVudEVsZW1lbnQucGFyZW50RWxlbWVudC5jaGlsZE5vZGVzWzBdLmNoaWxkTm9kZXNbMV0udGV4dENvbnRlbnQ7XG4gICAgICAgICAgICBjb25zdCBoZWFkZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLm1haW4taGRcIikudGV4dENvbnRlbnQ7XG4gICAgICAgICAgICBjb25zdCB0YXNrSW5kZXggPSB0YXNrQXJyLmZpbmRJbmRleCh0YXNrID0+IHRhc2sucHJvamVjdCA9PT0gaGVhZGVyKTtcbiAgICAgICAgICAgIGNvbnN0IGRlc2NJbmRleCA9IHRhc2tBcnJbdGFza0luZGV4XS5kZXNjcmlwdGlvbi5maW5kSW5kZXgoZGVzYyA9PiBkZXNjID09PSB0YXNrRGVzYyk7XG4gICAgICAgICAgICBkZWxldGVUYXNrKHRhc2tJbmRleCwgZGVzY0luZGV4KTtcbiAgICAgICAgICAgIGNvbnN0IHByb2plY3RUYXNrTGlzdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvamVjdC10YXNrLWxpc3RcIik7XG4gICAgICAgICAgICBwcm9qZWN0VGFza0xpc3QucmVtb3ZlQ2hpbGQoZS50YXJnZXQucGFyZW50RWxlbWVudC5wYXJlbnRFbGVtZW50KTtcbiAgICAgICAgfVxuICAgIH0pXG59KVxuXG5jb25zdCBhZGRUYXNrYnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5hZGQtdGFza1wiKTtcbmFkZFRhc2tidG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICB0YXNrTW9kYWwoKTtcbn0pO1xuXG5jb25zdCBjb21wbGV0ZWRUYWIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmNvbXBsZXRlZC10YWJcIik7XG5jb21wbGV0ZWRUYWIuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChlKSA9PiB7XG4gICAgY29uc3QgaW5uZXJUZXh0ID0gZS50YXJnZXQuaW5uZXJUZXh0O1xuICAgIGlmKGlubmVyVGV4dCA9PT0gXCJDb21wbGV0ZWRcXG5leHBhbmRfbW9yZVwiIHx8IGlubmVyVGV4dCA9PT0gXCJleHBhbmRfbW9yZVwiKSB7XG4gICAgICAgIGNoYW5nZUFycm93KGlubmVyVGV4dCk7XG4gICAgICAgIGRpc3BsYXlDb21wbGV0ZWRMaXN0KGlubmVyVGV4dCk7XG4gICAgfWVsc2Uge1xuICAgICAgICBjaGFuZ2VBcnJvdyhpbm5lclRleHQpO1xuICAgICAgICBkaXNwbGF5Q29tcGxldGVkTGlzdChpbm5lclRleHQpO1xuICAgIH1cbn0pO1xuIl0sIm5hbWVzIjpbImFkZFRvUHJvamVjdExpc3QiLCJhcnIiLCJjb21wbGV0ZWRMaXN0IiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwidGV4dENvbnRlbnQiLCJmb3JFYWNoIiwicHJvamVjdCIsIm5ld1Byb2plY3RDb250YWluZXIiLCJjcmVhdGVFbGVtZW50IiwiY2xhc3NMaXN0IiwiYWRkIiwicHJvamVjdFRpdGxlIiwidGl0bGUiLCJhcHBlbmRDaGlsZCIsImNyZWF0ZVByb2plY3RCdXR0b25zIiwiZGlzcGxheVRhc2siLCJ0YXNrTGlzdCIsImNsZWFyVGFza0xpc3QiLCJ0YXNrIiwicHJvamVjdFRhc2siLCJwcm9qZWN0VGFza0xlZnQiLCJjaGVja0JveCIsInRhc2tEZXNjcmlwdGlvbiIsImFkZFRhc2tCdG4iLCJpbnNlcnRCZWZvcmUiLCJkaXNwbGF5UHJvamVjdCIsInByb2plY3RPYmoiLCJkZXNjcmlwdGlvbiIsImR1ZURhdGUiLCJwcmlvcml0eSIsInN0eWxlIiwiY29sb3IiLCJjaGFuZ2VQcmlvcml0eUNvbG9yIiwiYSIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJpbmNsdWRlcyIsInNldEF0dHJpYnV0ZSIsInBhcmVudEVsZW1lbnQiLCJiYWNrZ3JvdW5kQ29sb3IiLCJiYWNrZ3JvdW5kIiwicHJvamVjdEJ0biIsImVkaXRCdG4iLCJkZWxldGVCdG4iLCJpIiwibGVuZ3RoIiwicmVtb3ZlQ2hpbGQiLCJ0YXNrQXJyIiwicHJvamVjdEFyciIsImFkZEV2ZW50TGlzdGVuZXIiLCJwcm9qZWN0TW9kYWwiLCJzaG93TW9kYWwiLCJjbG9zZSIsImZvcm0iLCJlIiwicHJldmVudERlZmF1bHQiLCJnZXRFbGVtZW50QnlJZCIsImNoZWNrZWQiLCJuZXdQcm9qZWN0IiwidXNlclByb2plY3QiLCJ2YWx1ZSIsInB1c2giLCJyZXNldCIsInByb2plY3RGb3JtIiwidGFza01vZGFsIiwieCIsImNoZWNrVGFza0FycmF5IiwicHJvamVjdEluZGV4IiwiZmluZEluZGV4IiwibmV3VGFzayIsInVzZXJUYXNrIiwidGFza0Zvcm0iLCJ0YXJnZXQiLCJjaGlsZE5vZGVzIiwidGFza0luZGV4IiwiYnRuIiwiZWRpdE1vZGFsIiwiaW5kZXgiLCJuZXdUaXRsZSIsImNvbnNvbGUiLCJsb2ciLCJvbmNlIiwiZWRpdEZvcm0iLCJzcGxpY2UiLCJoZWFkZXJDb250YWluZXIiLCJwYWRkaW5nQm90dG9tIiwic2VsZWN0ZWQiLCJyZW1vdmVQcm9qZWN0IiwidGFza0Rlc2MiLCJoZWFkZXIiLCJkZXNjSW5kZXgiLCJkZXNjIiwiZWRpdFRhc2tNb2RhbCIsImVkaXRUYXNrRm9ybSIsImRlbGV0ZVRhc2siLCJpbm5lclRleHQiLCJhcnJvd0RpcmVjdGlvbiIsInJlbW92ZSIsImRpc3BsYXlDb21wbGV0ZWRMaXN0Il0sInNvdXJjZVJvb3QiOiIifQ==