(()=>{"use strict";let e=[];function t(t){const o=n(t);m(e[o])}function n(t){return e.findIndex((e=>e.title===t))}let o=[];function c(){const e=d(o);-1!=e&&i(o[e].desc)}function d(e,t){const n=document.querySelector(".main-hd");return void 0===t?e.findIndex((e=>e.title===n.textContent)):e.findIndex((e=>e.title===t))}function l(e,t){return document.querySelector(".main-hd"),e.findIndex((e=>e===t))}function r(e){document.querySelector(".main-hd-con").style.paddingBottom="1rem";const t=document.querySelector(".project-list");t.textContent="";for(let n=0;n<e.length;n++)t.appendChild(s(e[n]))}function s(e){const t=document.createElement("div");t.classList.add("new-project-con");const n=document.createElement("p");return n.classList.add("project-title"),n.textContent=e.title,t.appendChild(n),t.appendChild(function(){const e=document.createElement("div");e.classList.add("project-btn");const t=document.createElement("span");t.classList.add("material-icons-outlined"),t.classList.add("edit"),t.textContent="edit",e.appendChild(t);const n=document.createElement("span");return n.classList.add("material-icons-outlined"),n.classList.add("delete"),n.textContent="delete",e.appendChild(n),e}()),t}function i(e){const t=document.querySelector(".project-task-list");if(void 0===e)t.textContent="";else{t.textContent="";for(let n=0;n<e.length;n++)console.log(e[n]),t.appendChild(a(e[n]))}t.appendChild(u())}function a(e){const t=document.createElement("div");t.classList.add("project-task");const n=document.createElement("div");n.classList.add("project-task-left"),t.appendChild(n);const o=document.createElement("div");o.classList.add("checkbox"),n.appendChild(o);const c=document.createElement("p");return c.classList.add("project-task-desc"),c.textContent=e,n.appendChild(c),t.appendChild(function(){const e=document.createElement("div");e.classList.add("project-task-btn");const t=document.createElement("span");t.classList.add("material-icons-outlined"),t.classList.add("edit"),t.textContent="edit",e.appendChild(t);const n=document.createElement("span");return n.classList.add("material-icons-outlined"),n.classList.add("delete"),n.textContent="delete",e.appendChild(n),e}()),t}function u(){const e=document.createElement("button");e.classList.add("add-task");const t=document.createElement("span");return t.classList.add("material-icons-outlined"),t.classList.add("add-icon"),t.textContent="add",e.prepend(t,"Add Task"),e}function m(e){document.querySelector(".main-hd").textContent=e.title,document.querySelector(".main-hd-desc").textContent=e.desc,document.querySelector(".main-hd-date-user").textContent=e.dueDate;const t=document.querySelector(".main-hd-priority-user");var n;t.textContent=e.priority,t.style.color="Low"===(n=e.priority)?"green":"Medium"===n?"yellow":"red";const o=document.querySelector(".project-task-list");o.textContent="",o.appendChild(u())}document.querySelector(".add-project").addEventListener("click",(()=>{!function(){const t=document.querySelector(".project-form"),n=document.querySelector(".project-modal");n.showModal(),function(){const t=document.querySelector(".project-modal"),n=document.querySelector(".project-form");n.addEventListener("submit",(o=>{o.preventDefault();const c=document.getElementById("title"),d=document.getElementById("description"),l=document.getElementById("due-date");let s="Low";document.querySelector(".project-modal #medium").checked?s="Medium":document.querySelector(".project-modal #high").checked&&(s="High");const i=((e,t,n,o)=>({title:e,desc:t,dueDate:n,priority:o}))(c.value,d.value,l.value,s);e.push(i),r(e),m(i),t.close(),HTMLFormElement.prototype.reset.call(n)}),{once:!0})}(),document.querySelector(".project-close").addEventListener("click",(()=>{n.close(),HTMLFormElement.prototype.reset.call(t)}))}()})),document.querySelector(".project-list").addEventListener("click",(l=>{if("material-icons-outlined edit"===l.target.className)!function(t){const o=document.querySelector(".edit-form"),c=document.querySelector(".edit-modal");c.showModal(),function(t){const o=document.querySelector(".edit-modal"),c=document.querySelector(".edit-form");c.addEventListener("submit",(d=>{d.preventDefault();const l=document.getElementById("edit-title"),s=document.getElementById("edit-description"),i=document.getElementById("edit-due-date");let a="Low";document.querySelector(".edit-form #medium").checked?a="Medium":document.querySelector(".edit-form #high").checked&&(a="High");const u=n(t);e[u].title=l.value,e[u].desc=s.value,e[u].dueDate=i.value,e[u].priority=a,r(e),m(e[u]),o.close(),console.log(e),HTMLFormElement.prototype.reset.call(c)}),{once:!0})}(t),document.querySelector(".edit-close").addEventListener("click",(()=>{c.close(),HTMLFormElement.prototype.reset.call(o)}))}(l.target.parentElement.parentElement.childNodes[0].textContent);else if("material-icons-outlined delete"===l.target.className){const t=l.target.parentElement.parentElement.childNodes[0].textContent;(function(t){const o=n(t);e.splice(o,1),console.log(e),r(e),function(e){const t=document.querySelector(".main-hd-con"),n=document.querySelector(".main-hd"),o=document.querySelector(".main-hd-desc"),c=document.querySelector(".main-hd-date-user"),d=document.querySelector(".main-hd-priority-user");0===e.length?(n.textContent="",o.textContent="",c.textContent="",d.textContent="",t.style.paddingBottom="4.9rem"):(n.textContent=e[0].title,o.textContent=e[0].desc,c.textContent=e[0].dueDate,d.textContent=e[0].priority)}(e)})(t),function(e){const t=d(o,e);o.splice(t,1),i(o[t]),0!==o.length&&i(o[0].desc)}(t)}else if("project-title"===l.target.className){const e=l.target.className;l.target.parentElement.parentElement,t(e),c()}else{const e=l.target.childNodes[0].textContent;l.target.parentElement,t(e),c()}})),document.querySelector(".project-task-list").addEventListener("click",(e=>{if("add-task"===e.target.className)!function(){const e=document.querySelector(".task-form"),t=document.querySelector(".task-modal");t.showModal(),function(){const e=document.querySelector(".task-modal"),t=document.querySelector(".task-form");t.addEventListener("submit",(n=>{n.preventDefault();const c=document.querySelector(".main-hd"),l=document.getElementById("task-description");if(function(e){if(0===o.length)return!1;for(let t=0;t<o.length;t++)if(o[t].title===e)return!0;return!1}(c.textContent)){const e=d(o);o[e].desc.push(l.value)}else{const e=((e,t)=>({title:e,desc:t}))(c.textContent,[l.value]);o.push(e)}const r=d(o);i(o[r].desc),e.close(),HTMLFormElement.prototype.reset.call(t)}),{once:!0})}(),document.querySelector(".task-close").addEventListener("click",(()=>{t.close(),HTMLFormElement.prototype.reset.call(e)}))}();else if("material-icons-outlined edit"===e.target.className){const t=e.target.parentElement.parentElement.childNodes[0].textContent;!function(e,t){const n=document.querySelector(".edit-task-form"),c=document.querySelector(".edit-task-modal");c.showModal(),function(e,t){const n=document.querySelector(".edit-task-modal"),c=document.querySelector(".edit-task-form");c.addEventListener("submit",(r=>{r.preventDefault(),document.querySelector(".main-hd");const s=document.getElementById("edit-task-description"),a=d(o,e),u=l(o[a].desc,t);console.log(u),o[a].desc[u]=s.value,i(o[a].desc),n.close(),HTMLFormElement.prototype.reset.call(c)}),{once:!0})}(e,t),document.querySelector(".edit-task-close").addEventListener("click",(()=>{c.close(),HTMLFormElement.prototype.reset.call(n)}))}(document.querySelector(".main-hd").textContent,t)}else if("material-icons-outlined delete"===e.target.className){const t=e.target.parentElement.parentElement.childNodes[0].textContent;!function(e,t){const n=d(o,e),c=l(o[n].desc,t);o[n].desc.splice(c,1),i(o[n].desc)}(document.querySelector(".main-hd").textContent,t)}}))})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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N0UsU0FBb0JmLEVBQWNpQixHQUM5QixNQUFNaEIsRUFBUUcsRUFBVUcsRUFBU1AsR0FDM0I2RixFQUFZN0UsRUFBY1QsRUFBUU4sR0FBT1MsS0FBTU8sR0FDckRWLEVBQVFOLEdBQU9TLEtBQUtzRSxPQUFPYSxFQUFXLEdBQ3RDcEYsRUFBWUYsRUFBUU4sR0FBT1MsS0FDL0IsQ0VMUXNGLENBRHFCcEYsU0FBU0MsY0FBYyxZQUFZRSxZQUMvQkUsRUFDN0IsSSIsInNvdXJjZXMiOlsid2VicGFjazovL3RvLWRvLy4vc3JjL3Byb2plY3QuanMiLCJ3ZWJwYWNrOi8vdG8tZG8vLi9zcmMvdGFzay5qcyIsIndlYnBhY2s6Ly90by1kby8uL3NyYy9VSS5qcyIsIndlYnBhY2s6Ly90by1kby8uL3NyYy9pbmRleC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBpbXBvcnQgeyBhZGRUb1Byb2plY3RMaXN0LCBkaXNwbGF5UHJvamVjdCB9IGZyb20gXCIuL1VJXCI7XG4vLyBpbXBvcnQgeyB1cGRhdGVUYXNrIH0gZnJvbSBcIi4vdGFza1wiO1xuXG4vLyBsZXQgcHJvamVjdEFyciA9IFtdO1xuXG4vLyBmdW5jdGlvbiBwcm9qZWN0TW9kYWwoKSB7XG4vLyAgICAgY29uc3QgcHJvamVjdE1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9qZWN0LW1vZGFsXCIpO1xuLy8gICAgIHByb2plY3RNb2RhbC5zaG93TW9kYWwoKTtcbi8vICAgICBjb25zdCBjbG9zZUJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvamVjdC1jbG9zZVwiKTtcbi8vICAgICBjbG9zZUJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuLy8gICAgICAgICBwcm9qZWN0TW9kYWwuY2xvc2UoKTtcbi8vICAgICB9KTtcbi8vICAgICByZXR1cm4gcHJvamVjdE1vZGFsO1xuLy8gfVxuXG4vLyBmdW5jdGlvbiBwcm9qZWN0Rm9ybSgpIHtcbi8vICAgICBjb25zdCBmb3JtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9qZWN0LWZvcm1cIik7XG4vLyAgICAgY29uc3QgcHJvamVjdE1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9qZWN0LW1vZGFsXCIpO1xuLy8gICAgIGZvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZSkgPT4ge1xuLy8gICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4vLyAgICAgICAgIGNvbnN0IHRpdGxlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJ0aXRsZVwiKTtcbi8vICAgICAgICAgY29uc3QgZGVzY3JpcHRpb24gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImRlc2NyaXB0aW9uXCIpO1xuLy8gICAgICAgICBjb25zdCBkdWVEYXRlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJkdWUtZGF0ZVwiKTtcbi8vICAgICAgICAgbGV0IHByaW9yaXR5ID0gXCJMb3dcIjtcbi8vICAgICAgICAgaWYoZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9qZWN0LW1vZGFsICNtZWRpdW1cIikuY2hlY2tlZCkgcHJpb3JpdHkgPSBcIk1lZGl1bVwiO1xuLy8gICAgICAgICBlbHNlIGlmKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvamVjdC1tb2RhbCAjaGlnaFwiKS5jaGVja2VkKSBwcmlvcml0eSA9IFwiSGlnaFwiO1xuLy8gICAgICAgICBlbHNlIHByaW9yaXR5O1xuLy8gICAgICAgICBjb25zdCBuZXdQcm9qZWN0ID0gdXNlclByb2plY3QodGl0bGUudmFsdWUsIGRlc2NyaXB0aW9uLnZhbHVlLCBkdWVEYXRlLnZhbHVlLCBwcmlvcml0eSk7XG4vLyAgICAgICAgIHByb2plY3RBcnIucHVzaChuZXdQcm9qZWN0KTtcbi8vICAgICAgICAgYWRkVG9Qcm9qZWN0TGlzdChwcm9qZWN0QXJyKTtcbi8vICAgICAgICAgZGlzcGxheVByb2plY3QobmV3UHJvamVjdCk7XG4vLyAgICAgICAgIHByb2plY3RNb2RhbC5jbG9zZSgpO1xuLy8gICAgICAgICBmb3JtLnJlc2V0KCk7XG4vLyAgICAgICAgIC8vIGNvbnNvbGUubG9nKHByb2plY3RBcnIpO1xuLy8gICAgICAgICByZXR1cm4gcHJvamVjdEFycjtcbi8vICAgICB9KTtcbi8vIH1cblxuLy8gZnVuY3Rpb24gZWRpdE1vZGFsKCkge1xuLy8gICAgIGNvbnN0IGVkaXRNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZWRpdC1tb2RhbFwiKTtcbi8vICAgICBlZGl0TW9kYWwuc2hvd01vZGFsKCk7XG4vLyAgICAgY29uc3QgY2xvc2VCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmVkaXQtY2xvc2VcIik7XG4vLyAgICAgY2xvc2VCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbi8vICAgICAgICAgZWRpdE1vZGFsLmNsb3NlKCk7XG4vLyAgICAgfSk7XG4vLyAgICAgcmV0dXJuIGVkaXRNb2RhbDtcbi8vIH1cblxuLy8gZnVuY3Rpb24gZWRpdEZvcm0ocHJvamVjdEluZGV4KSB7XG4vLyAgICAgY29uc3QgZm9ybSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZWRpdC1mb3JtXCIpO1xuLy8gICAgIGNvbnN0IHByb2plY3RNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZWRpdC1tb2RhbFwiKTtcbi8vICAgICBmb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGUpID0+IHtcbi8vICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuLy8gICAgICAgICBjb25zdCB0aXRsZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiZWRpdC10aXRsZVwiKTtcbi8vICAgICAgICAgcHJvamVjdEFycltwcm9qZWN0SW5kZXhdLnRpdGxlID0gdGl0bGUudmFsdWU7XG4vLyAgICAgICAgIGNvbnN0IGRlc2NyaXB0aW9uID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJlZGl0LWRlc2NyaXB0aW9uXCIpO1xuLy8gICAgICAgICBwcm9qZWN0QXJyW3Byb2plY3RJbmRleF0uZGVzY3JpcHRpb24gPSBkZXNjcmlwdGlvbi52YWx1ZTtcbi8vICAgICAgICAgY29uc3QgZHVlRGF0ZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiZWRpdC1kdWUtZGF0ZVwiKTtcbi8vICAgICAgICAgcHJvamVjdEFycltwcm9qZWN0SW5kZXhdLmR1ZURhdGUgPSBkdWVEYXRlLnZhbHVlO1xuLy8gICAgICAgICBsZXQgcHJpb3JpdHkgPSBcIkxvd1wiO1xuLy8gICAgICAgICBpZihkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmVkaXQtbW9kYWwgI21lZGl1bVwiKS5jaGVja2VkKSBwcmlvcml0eSA9IFwiTWVkaXVtXCI7XG4vLyAgICAgICAgIGVsc2UgaWYoZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5lZGl0LW1vZGFsICNoaWdoXCIpLmNoZWNrZWQpIHByaW9yaXR5ID0gXCJIaWdoXCI7XG4vLyAgICAgICAgIGVsc2UgcHJpb3JpdHk7XG4vLyAgICAgICAgIHByb2plY3RBcnJbcHJvamVjdEluZGV4XS5wcmlvcml0eSA9IHByaW9yaXR5O1xuLy8gICAgICAgICBjb25zb2xlLmxvZyhcInByb2plY3QtbW9kdWxlXCIpO1xuLy8gICAgICAgICBjb25zb2xlLmxvZyhwcm9qZWN0QXJyKTtcbi8vICAgICAgICAgYWRkVG9Qcm9qZWN0TGlzdChwcm9qZWN0QXJyKTtcbi8vICAgICAgICAgZGlzcGxheVByb2plY3QocHJvamVjdEFycltwcm9qZWN0SW5kZXhdKTtcbi8vICAgICAgICAgdXBkYXRlVGFzayhwcm9qZWN0SW5kZXgsIHByb2plY3RBcnJbcHJvamVjdEluZGV4XS50aXRsZSk7XG4vLyAgICAgICAgIHByb2plY3RNb2RhbC5jbG9zZSgpO1xuLy8gICAgICAgICBmb3JtLnJlc2V0KCk7XG4vLyAgICAgICAgIHJldHVybiBwcm9qZWN0QXJyO1xuLy8gICAgIH0sIHtvbmNlOiB0cnVlfSk7IC8vcHJldmVudCBmb3JtIGZyb20gc3VibWl0dGluZyB0d2ljZSB3aGVuIGVkaXRpbmcgbW9yZSB0aGFuIG9uY2Vcbi8vIH1cblxuLy8gZnVuY3Rpb24gZGVsZXRlUHJvamVjdChwcm9qZWN0SW5kZXgpIHtcbi8vICAgICByZXR1cm4gcHJvamVjdEFyci5zcGxpY2UocHJvamVjdEluZGV4LCAxKTtcbi8vIH1cblxuLy8gY29uc3QgdXNlclByb2plY3QgPSAodGl0bGUsIGRlc2NyaXB0aW9uLCBkdWVEYXRlLCBwcmlvcml0eSkgPT4ge1xuLy8gICAgIHJldHVybiB7dGl0bGUsIGRlc2NyaXB0aW9uLCBkdWVEYXRlLCBwcmlvcml0eX07XG4vLyB9IFxuXG5cbi8vIGV4cG9ydCB7cHJvamVjdE1vZGFsLCBwcm9qZWN0Rm9ybSwgcHJvamVjdEFyciwgZWRpdE1vZGFsLCBlZGl0Rm9ybSwgZGVsZXRlUHJvamVjdH07XG5cbmltcG9ydCB7IGRpc3BsYXlQcm9qZWN0LCBkaXNwbGF5TWFpbiwgZGlzcGxheURlbGV0ZU1haW4gfSBmcm9tIFwiLi9VSVwiO1xuXG5sZXQgcHJvamVjdEFyciA9IFtdO1xuXG5jb25zdCB1c2VyUHJvamVjdCA9ICh0aXRsZSwgZGVzYywgZHVlRGF0ZSwgcHJpb3JpdHkpID0+IHtcbiAgICByZXR1cm4ge3RpdGxlLCBkZXNjLCBkdWVEYXRlLCBwcmlvcml0eX07XG59XG5cbmZ1bmN0aW9uIHByb2plY3RGb3JtKCkge1xuICAgIGNvbnN0IHByb2plY3RNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvamVjdC1tb2RhbFwiKTtcbiAgICBjb25zdCBmb3JtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9qZWN0LWZvcm1cIik7XG4gICAgZm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChlKSA9PiB7XG4gICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgY29uc3QgdGl0bGUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInRpdGxlXCIpO1xuICAgICAgICBjb25zdCBkZXNjcmlwdGlvbiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiZGVzY3JpcHRpb25cIik7XG4gICAgICAgIGNvbnN0IGR1ZURhdGUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImR1ZS1kYXRlXCIpO1xuICAgICAgICBsZXQgcHJpb3JpdHkgPSBcIkxvd1wiO1xuICAgICAgICBpZihkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2plY3QtbW9kYWwgI21lZGl1bVwiKS5jaGVja2VkKSBwcmlvcml0eSA9IFwiTWVkaXVtXCI7XG4gICAgICAgIGVsc2UgaWYoZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9qZWN0LW1vZGFsICNoaWdoXCIpLmNoZWNrZWQpIHByaW9yaXR5ID0gXCJIaWdoXCI7XG4gICAgICAgIGVsc2UgcHJpb3JpdHk7XG4gICAgICAgIGNvbnN0IG5ld1Byb2plY3QgPSB1c2VyUHJvamVjdCh0aXRsZS52YWx1ZSwgZGVzY3JpcHRpb24udmFsdWUsIGR1ZURhdGUudmFsdWUsIHByaW9yaXR5KTtcbiAgICAgICAgcHJvamVjdEFyci5wdXNoKG5ld1Byb2plY3QpO1xuICAgICAgICBkaXNwbGF5UHJvamVjdChwcm9qZWN0QXJyKTtcbiAgICAgICAgZGlzcGxheU1haW4obmV3UHJvamVjdCk7XG4gICAgICAgIHByb2plY3RNb2RhbC5jbG9zZSgpO1xuICAgICAgICBIVE1MRm9ybUVsZW1lbnQucHJvdG90eXBlLnJlc2V0LmNhbGwoZm9ybSk7XG4gICAgfSwge29uY2U6IHRydWV9KTtcbn1cblxuZnVuY3Rpb24gZWRpdFByb2plY3RGb3JtKHByb2plY3RUaXRsZSkge1xuICAgIGNvbnN0IGVkaXRNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZWRpdC1tb2RhbFwiKTtcbiAgICBjb25zdCBlZGl0Rm9ybSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZWRpdC1mb3JtXCIpO1xuICAgIGVkaXRGb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGUpID0+IHtcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICBjb25zdCB0aXRsZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiZWRpdC10aXRsZVwiKTtcbiAgICAgICAgY29uc3QgZGVzY3JpcHRpb24gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImVkaXQtZGVzY3JpcHRpb25cIik7XG4gICAgICAgIGNvbnN0IGR1ZURhdGUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImVkaXQtZHVlLWRhdGVcIik7XG4gICAgICAgIGxldCBwcmlvcml0eSA9IFwiTG93XCI7XG4gICAgICAgIGlmKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZWRpdC1mb3JtICNtZWRpdW1cIikuY2hlY2tlZCkgcHJpb3JpdHkgPSBcIk1lZGl1bVwiO1xuICAgICAgICBlbHNlIGlmKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZWRpdC1mb3JtICNoaWdoXCIpLmNoZWNrZWQpIHByaW9yaXR5ID0gXCJIaWdoXCI7XG4gICAgICAgIGVsc2UgcHJpb3JpdHk7XG4gICAgICAgIGNvbnN0IGluZGV4ID0gZmluZFByb2plY3QocHJvamVjdFRpdGxlKTtcbiAgICAgICAgcHJvamVjdEFycltpbmRleF0udGl0bGUgPSB0aXRsZS52YWx1ZTtcbiAgICAgICAgcHJvamVjdEFycltpbmRleF0uZGVzYyA9IGRlc2NyaXB0aW9uLnZhbHVlO1xuICAgICAgICBwcm9qZWN0QXJyW2luZGV4XS5kdWVEYXRlID0gZHVlRGF0ZS52YWx1ZTtcbiAgICAgICAgcHJvamVjdEFycltpbmRleF0ucHJpb3JpdHkgPSBwcmlvcml0eTtcbiAgICAgICAgZGlzcGxheVByb2plY3QocHJvamVjdEFycik7XG4gICAgICAgIGRpc3BsYXlNYWluKHByb2plY3RBcnJbaW5kZXhdKTtcbiAgICAgICAgZWRpdE1vZGFsLmNsb3NlKCk7XG4gICAgICAgIGNvbnNvbGUubG9nKHByb2plY3RBcnIpO1xuICAgICAgICBIVE1MRm9ybUVsZW1lbnQucHJvdG90eXBlLnJlc2V0LmNhbGwoZWRpdEZvcm0pXG4gICAgfSwge29uY2U6IHRydWV9KTtcbn1cblxuZnVuY3Rpb24gZGVsZXRlUHJvamVjdChwcm9qZWN0VGl0bGUpIHtcbiAgICBjb25zdCBpbmRleCA9IGZpbmRQcm9qZWN0KHByb2plY3RUaXRsZSk7XG4gICAgcHJvamVjdEFyci5zcGxpY2UoaW5kZXgsIDEpO1xuICAgIGNvbnNvbGUubG9nKHByb2plY3RBcnIpO1xuICAgIGRpc3BsYXlQcm9qZWN0KHByb2plY3RBcnIpO1xuICAgIGRpc3BsYXlEZWxldGVNYWluKHByb2plY3RBcnIpO1xufVxuXG5mdW5jdGlvbiBzZWxlY3RlZFByb2plY3QocHJvamVjdFRpdGxlKSB7XG4gICAgY29uc3QgaW5kZXggPSBmaW5kUHJvamVjdChwcm9qZWN0VGl0bGUpO1xuICAgIGRpc3BsYXlNYWluKHByb2plY3RBcnJbaW5kZXhdKTtcbn1cblxuZnVuY3Rpb24gZmluZFByb2plY3QocHJvamVjdFRpdGxlKSB7XG4gICAgcmV0dXJuIHByb2plY3RBcnIuZmluZEluZGV4KHByb2plY3QgPT4gcHJvamVjdC50aXRsZSA9PT0gcHJvamVjdFRpdGxlKTtcbn1cblxuXG5leHBvcnQge3Byb2plY3RGb3JtLCBlZGl0UHJvamVjdEZvcm0sIGRlbGV0ZVByb2plY3QsIHNlbGVjdGVkUHJvamVjdH07IiwiLy8gaW1wb3J0IHsgYWRkVG9UYXNrTGlzdCwgZGlzcGxheVRhc2sgfSBmcm9tIFwiLi9VSVwiO1xuXG4vLyBsZXQgdGFza0FyciA9IFtdO1xuXG4vLyBmdW5jdGlvbiB0YXNrTW9kYWwoKSB7XG4vLyAgICAgY29uc3QgdGFza01vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi50YXNrLW1vZGFsXCIpO1xuLy8gICAgIHRhc2tNb2RhbC5zaG93TW9kYWwoKTtcbi8vICAgICBjb25zdCBjbG9zZUJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIudGFzay1jbG9zZVwiKTtcbi8vICAgICBjbG9zZUJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGUpID0+IHtcbi8vICAgICAgICAgdGFza01vZGFsLmNsb3NlKCk7XG4vLyAgICAgfSk7XG4vLyAgICAgcmV0dXJuIHRhc2tNb2RhbDtcbi8vIH1cblxuLy8gZnVuY3Rpb24gdGFza0Zvcm0oKSB7XG4vLyAgICAgY29uc3QgZm9ybSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIudGFzay1mb3JtXCIpO1xuLy8gICAgIGNvbnN0IHRhc2tNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIudGFzay1tb2RhbFwiKTtcbi8vICAgICBjb25zdCB0aXRsZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubWFpbi1oZFwiKTtcbi8vICAgICBmb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGUpID0+IHtcbi8vICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuLy8gICAgICAgICBjb25zdCBkZXNjcmlwdGlvbiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwidGFzay1kZXNjcmlwdGlvblwiKTtcbi8vICAgICAgICAgaWYoIWNoZWNrVGFza0FycmF5KHRpdGxlLnRleHRDb250ZW50KSkge1xuLy8gICAgICAgICAgICAgY29uc3QgbmV3VGFzayA9IHVzZXJUYXNrKHRpdGxlLnRleHRDb250ZW50LCBbZGVzY3JpcHRpb24udmFsdWVdKTtcbi8vICAgICAgICAgICAgIHRhc2tBcnIucHVzaChuZXdUYXNrKTtcbi8vICAgICAgICAgICAgIGNvbnN0IHByb2plY3RJbmRleCA9IHRhc2tBcnIuZmluZEluZGV4KHRhc2sgPT4gdGFzay5wcm9qZWN0ID09PSB0aXRsZS50ZXh0Q29udGVudCk7XG4vLyAgICAgICAgICAgICBkaXNwbGF5VGFzayh0YXNrQXJyW3Byb2plY3RJbmRleF0uZGVzY3JpcHRpb24pO1xuLy8gICAgICAgICB9ZWxzZSB7XG4vLyAgICAgICAgICAgICBjb25zdCBwcm9qZWN0SW5kZXggPSB0YXNrQXJyLmZpbmRJbmRleCh0YXNrID0+IHRhc2sucHJvamVjdCA9PT0gdGl0bGUudGV4dENvbnRlbnQpO1xuLy8gICAgICAgICAgICAgdGFza0Fycltwcm9qZWN0SW5kZXhdLmRlc2NyaXB0aW9uLnB1c2goZGVzY3JpcHRpb24udmFsdWUpOyBcbi8vICAgICAgICAgICAgIGRpc3BsYXlUYXNrKHRhc2tBcnJbcHJvamVjdEluZGV4XS5kZXNjcmlwdGlvbik7XG4vLyAgICAgICAgIH1cbi8vICAgICAgICAgLy8gYWRkVG9UYXNrTGlzdCh0YXNrQXJyKTtcbi8vICAgICAgICAgdGFza01vZGFsLmNsb3NlKCk7XG4vLyAgICAgICAgIGZvcm0ucmVzZXQoKTtcbi8vICAgICAgICAgLy8gY29uc29sZS5sb2codGFza0Fycik7XG4vLyAgICAgICAgIC8vIGNvbnNvbGUubG9nKHRhc2tBcnJbMF0uZGVzY3JpcHRpb24pO1xuLy8gICAgICAgICByZXR1cm4gdGFza0Fycjtcbi8vICAgICB9KVxuLy8gfVxuXG4vLyBmdW5jdGlvbiBlZGl0VGFza01vZGFsKCkge1xuLy8gICAgIGNvbnN0IHRhc2tNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZWRpdC10YXNrLW1vZGFsXCIpO1xuLy8gICAgIHRhc2tNb2RhbC5zaG93TW9kYWwoKTtcbi8vICAgICBjb25zdCBjbG9zZUJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZWRpdC10YXNrLWNsb3NlXCIpO1xuLy8gICAgIGNsb3NlQnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZSkgPT4ge1xuLy8gICAgICAgICB0YXNrTW9kYWwuY2xvc2UoKTtcbi8vICAgICB9KTtcbi8vICAgICByZXR1cm4gdGFza01vZGFsO1xuLy8gfVxuXG4vLyBmdW5jdGlvbiBlZGl0VGFza0Zvcm0odGFza0luZGV4LCB0YXNrRGVzYykge1xuLy8gICAgIGNvbnN0IGZvcm0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmVkaXQtdGFzay1mb3JtXCIpO1xuLy8gICAgIGNvbnN0IHRhc2tNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZWRpdC10YXNrLW1vZGFsXCIpO1xuLy8gICAgIGZvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZSkgPT4ge1xuLy8gICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4vLyAgICAgICAgIGNvbnN0IGRlc2NyaXB0aW9uID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJlZGl0LXRhc2stZGVzY3JpcHRpb25cIik7XG4vLyAgICAgICAgIHRhc2tBcnJbdGFza0luZGV4XS5kZXNjcmlwdGlvblt0YXNrRGVzY10gPSBkZXNjcmlwdGlvbi52YWx1ZTtcbi8vICAgICAgICAgZGlzcGxheVRhc2sodGFza0Fyclt0YXNrSW5kZXhdLmRlc2NyaXB0aW9uKTtcbi8vICAgICAgICAgdGFza01vZGFsLmNsb3NlKCk7XG4vLyAgICAgICAgIGZvcm0ucmVzZXQoKTtcbi8vICAgICAgICAgcmV0dXJuIHRhc2tBcnI7XG4vLyAgICAgfSwge29uY2U6IHRydWV9KTtcbi8vIH1cblxuLy8gZnVuY3Rpb24gZGVsZXRlVGFzayh0YXNrSW5kZXgsIGRlc2NJbmRleCkge1xuLy8gICAgIHJldHVybiB0YXNrQXJyW3Rhc2tJbmRleF0uZGVzY3JpcHRpb24uc3BsaWNlKGRlc2NJbmRleCwgMSk7XG4vLyB9XG5cbi8vIGZ1bmN0aW9uIHVwZGF0ZVRhc2soaW5kZXgsIG5ld1RpdGxlKSB7XG4vLyAgICAgdGFza0FycltpbmRleF0ucHJvamVjdCA9IG5ld1RpdGxlO1xuLy8gICAgIGRpc3BsYXlUYXNrKHRhc2tBcnJbaW5kZXhdLmRlc2NyaXB0aW9uKTtcbi8vICAgICBjb25zb2xlLmxvZyh0YXNrQXJyW2luZGV4XSk7XG4vLyAgICAgcmV0dXJuIHRhc2tBcnI7XG4vLyB9XG5cbi8vIGZ1bmN0aW9uIGNoZWNrVGFza0FycmF5KHRpdGxlKSB7XG4vLyAgICAgaWYodGFza0Fyci5sZW5ndGggPT09IDApIHJldHVybiBmYWxzZTtcbi8vICAgICBmb3IobGV0IHggPSAwOyB4IDwgdGFza0Fyci5sZW5ndGg7IHgrKykge1xuLy8gICAgICAgICBpZih0YXNrQXJyW3hdLnByb2plY3QgPT09IHRpdGxlKSByZXR1cm4gdHJ1ZTtcbi8vICAgICB9XG4vLyB9XG5cbi8vIGZ1bmN0aW9uIHN0cmlrZVRocm91Z2goY2hlY2tib3gsIGVsKSB7XG4vLyAgICAgaWYoIWNoZWNrYm94LmNsYXNzTGlzdC5jb250YWlucyhcImFjdGl2ZVwiKSkge1xuLy8gICAgICAgICBjaGVja2JveC5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSBcIiNGRkI2NDdcIjtcbi8vICAgICAgICAgZWwuc3R5bGUudGV4dERlY29yYXRpb24gPSBcImxpbmUtdGhyb3VnaFwiO1xuLy8gICAgICAgICBjaGVja2JveC5jbGFzc0xpc3QuYWRkKFwiYWN0aXZlXCIpO1xuLy8gICAgIH1lbHNlIHtcbi8vICAgICAgICAgY2hlY2tib3guc3R5bGUuYmFja2dyb3VuZCA9IFwibm9uZVwiO1xuLy8gICAgICAgICBlbC5zdHlsZS50ZXh0RGVjb3JhdGlvbiA9IFwibm9uZVwiO1xuLy8gICAgICAgICBjaGVja2JveC5jbGFzc0xpc3QucmVtb3ZlKFwiYWN0aXZlXCIpO1xuLy8gICAgIH1cbi8vIH1cblxuLy8gY29uc3QgdXNlclRhc2sgPSAocHJvamVjdCwgZGVzY3JpcHRpb24pID0+IHtcbi8vICAgICByZXR1cm4ge3Byb2plY3QsIGRlc2NyaXB0aW9ufTtcbi8vIH0gXG5cbi8vIGV4cG9ydCB7dGFza01vZGFsLCB0YXNrRm9ybSwgdGFza0FyciwgdXBkYXRlVGFzaywgZWRpdFRhc2tNb2RhbCwgZWRpdFRhc2tGb3JtLCBkZWxldGVUYXNrLCBzdHJpa2VUaHJvdWdofTtcblxuaW1wb3J0IHsgZGlzcGxheVRhc2sgfSBmcm9tIFwiLi9VSVwiO1xuXG5sZXQgdGFza0FyciA9IFtdO1xuXG5jb25zdCB1c2VyVGFzayA9ICh0aXRsZSwgZGVzYykgPT4ge1xuICAgIHJldHVybiB7dGl0bGUsIGRlc2N9O1xufVxuXG5mdW5jdGlvbiB0YXNrRm9ybSgpIHtcbiAgICBjb25zdCB0YXNrTW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnRhc2stbW9kYWxcIik7XG4gICAgY29uc3QgZm9ybSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIudGFzay1mb3JtXCIpO1xuICAgIGZvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZSkgPT4ge1xuICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIGNvbnN0IHRpdGxlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tYWluLWhkXCIpO1xuICAgICAgICBjb25zdCBkZXNjcmlwdGlvbiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwidGFzay1kZXNjcmlwdGlvblwiKTtcbiAgICAgICAgaWYoIXRhc2tUaXRsZU1hdGNoKHRpdGxlLnRleHRDb250ZW50KSkge1xuICAgICAgICAgICAgY29uc3QgbmV3VGFzayA9IHVzZXJUYXNrKHRpdGxlLnRleHRDb250ZW50LCBbZGVzY3JpcHRpb24udmFsdWVdKTtcbiAgICAgICAgICAgIHRhc2tBcnIucHVzaChuZXdUYXNrKTtcbiAgICAgICAgfWVsc2Uge1xuICAgICAgICAgICAgY29uc3QgaW5kZXggPSBmaW5kSW5kZXgodGFza0Fycik7XG4gICAgICAgICAgICB0YXNrQXJyW2luZGV4XS5kZXNjLnB1c2goZGVzY3JpcHRpb24udmFsdWUpO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGluZGV4ID0gZmluZEluZGV4KHRhc2tBcnIpO1xuICAgICAgICBkaXNwbGF5VGFzayh0YXNrQXJyW2luZGV4XS5kZXNjKTtcbiAgICAgICAgdGFza01vZGFsLmNsb3NlKCk7XG4gICAgICAgIEhUTUxGb3JtRWxlbWVudC5wcm90b3R5cGUucmVzZXQuY2FsbChmb3JtKVxuICAgIH0sIHtvbmNlOiB0cnVlfSk7XG59XG5cbmZ1bmN0aW9uIGVkaXRUYXNrRm9ybShwcm9qZWN0VGl0bGUsIHRhc2tUaXRsZSkge1xuICAgIGNvbnN0IGVkaXRUYXNrTW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmVkaXQtdGFzay1tb2RhbFwiKTtcbiAgICBjb25zdCBmb3JtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5lZGl0LXRhc2stZm9ybVwiKTtcbiAgICBmb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGUpID0+IHtcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICBjb25zdCB0aXRsZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubWFpbi1oZFwiKTtcbiAgICAgICAgY29uc3QgZGVzY3JpcHRpb24gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImVkaXQtdGFzay1kZXNjcmlwdGlvblwiKTtcbiAgICAgICAgY29uc3QgaW5kZXggPSBmaW5kSW5kZXgodGFza0FyciwgcHJvamVjdFRpdGxlKTtcbiAgICAgICAgY29uc3QgdGFza0luZGV4ID0gZmluZFRhc2tJbmRleCh0YXNrQXJyW2luZGV4XS5kZXNjLCB0YXNrVGl0bGUpO1xuICAgICAgICBjb25zb2xlLmxvZyh0YXNrSW5kZXgpO1xuICAgICAgICB0YXNrQXJyW2luZGV4XS5kZXNjW3Rhc2tJbmRleF0gPSBkZXNjcmlwdGlvbi52YWx1ZTtcbiAgICAgICAgZGlzcGxheVRhc2sodGFza0FycltpbmRleF0uZGVzYyk7XG4gICAgICAgIGVkaXRUYXNrTW9kYWwuY2xvc2UoKTtcbiAgICAgICAgSFRNTEZvcm1FbGVtZW50LnByb3RvdHlwZS5yZXNldC5jYWxsKGZvcm0pXG4gICAgfSwge29uY2U6IHRydWV9KTtcbn1cblxuZnVuY3Rpb24gZGVsZXRlVGFzayhwcm9qZWN0VGl0bGUsIHRhc2tUaXRsZSkge1xuICAgIGNvbnN0IGluZGV4ID0gZmluZEluZGV4KHRhc2tBcnIsIHByb2plY3RUaXRsZSk7XG4gICAgY29uc3QgdGFza0luZGV4ID0gZmluZFRhc2tJbmRleCh0YXNrQXJyW2luZGV4XS5kZXNjLCB0YXNrVGl0bGUpO1xuICAgIHRhc2tBcnJbaW5kZXhdLmRlc2Muc3BsaWNlKHRhc2tJbmRleCwgMSk7XG4gICAgZGlzcGxheVRhc2sodGFza0FycltpbmRleF0uZGVzYyk7XG59XG5cbmZ1bmN0aW9uIGRlbGV0ZUVudGlyZVRhc2socHJvamVjdFRpdGxlKSB7XG4gICAgY29uc3QgaW5kZXggPSBmaW5kSW5kZXgodGFza0FyciwgcHJvamVjdFRpdGxlKTtcbiAgICB0YXNrQXJyLnNwbGljZShpbmRleCwgMSk7XG4gICAgZGlzcGxheVRhc2sodGFza0FycltpbmRleF0pO1xuICAgIGlmKHRhc2tBcnIubGVuZ3RoICE9PSAwKSBkaXNwbGF5VGFzayh0YXNrQXJyWzBdLmRlc2MpO1xufVxuXG5mdW5jdGlvbiBzZWxlY3RlZFRhc2soKSB7XG4gICAgY29uc3QgaW5kZXggPSBmaW5kSW5kZXgodGFza0Fycik7XG4gICAgaWYoaW5kZXggIT0gLTEpIGRpc3BsYXlUYXNrKHRhc2tBcnJbaW5kZXhdLmRlc2MpO1xufVxuXG5mdW5jdGlvbiBmaW5kSW5kZXgoYXJyLCBwcm9qZWN0VGl0bGUpIHtcbiAgICBjb25zdCB0aXRsZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubWFpbi1oZFwiKTtcbiAgICBpZih0eXBlb2YgcHJvamVjdFRpdGxlID09PSBcInVuZGVmaW5lZFwiKSByZXR1cm4gYXJyLmZpbmRJbmRleCh0YXNrID0+IHRhc2sudGl0bGUgPT09IHRpdGxlLnRleHRDb250ZW50KTtcbiAgICBlbHNlIHJldHVybiBhcnIuZmluZEluZGV4KHRhc2sgPT4gdGFzay50aXRsZSA9PT0gcHJvamVjdFRpdGxlKTtcbn1cblxuZnVuY3Rpb24gZmluZFRhc2tJbmRleChhcnIsIHRhc2tUaXRsZSkge1xuICAgIGNvbnN0IHRpdGxlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tYWluLWhkXCIpO1xuICAgIHJldHVybiBhcnIuZmluZEluZGV4KGluZGV4ID0+IGluZGV4ID09PSB0YXNrVGl0bGUpO1xufVxuXG5mdW5jdGlvbiB0YXNrVGl0bGVNYXRjaCh0aXRsZSkge1xuICAgIGlmKHRhc2tBcnIubGVuZ3RoID09PSAwKSByZXR1cm4gZmFsc2U7XG4gICAgZm9yKGxldCBpID0gMDsgaSA8IHRhc2tBcnIubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgaWYodGFza0FycltpXS50aXRsZSA9PT0gdGl0bGUpIHJldHVybiB0cnVlO1xuICAgIH1cbiAgICByZXR1cm4gZmFsc2U7XG59XG5cbmV4cG9ydCB7dGFza0Zvcm0sIHNlbGVjdGVkVGFzaywgZGVsZXRlRW50aXJlVGFzaywgZWRpdFRhc2tGb3JtLCBkZWxldGVUYXNrfTsiLCIvLyBpbXBvcnQgeyBwcm9qZWN0QXJyIH0gZnJvbSBcIi4vcHJvamVjdFwiO1xuXG4vLyBmdW5jdGlvbiBkaXNwbGF5Q29tcGxldGVkTGlzdChpbm5lclRleHQpIHtcbi8vICAgICBjb25zdCBjb21wbGV0ZWRMaXN0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5jb21wbGV0ZWQtbGlzdFwiKTtcbi8vICAgICBpZihpbm5lclRleHQgPT09IFwiQ29tcGxldGVkXFxuZXhwYW5kX21vcmVcIiB8fCBpbm5lclRleHQgPT09IFwiZXhwYW5kX21vcmVcIikge1xuLy8gICAgICAgICBjb25zdCBwcm9qZWN0SG92ZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLnVzZXItcHJvamVjdFwiKTtcbi8vICAgICAgICAgcHJvamVjdEhvdmVyLmZvckVhY2goKHByb2plY3QpID0+IHtcbi8vICAgICAgICAgICAgIHByb2plY3QuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlb3ZlclwiLCAoKSA9PiB7XG4vLyAgICAgICAgICAgICAgICAgcHJvamVjdC5zZXRBdHRyaWJ1dGUoXCJzdHlsZVwiLCBcImJhY2tncm91bmQtY29sb3I6IHJnYmEoMjU1LCAyNTUsIDI1NSwgMC4yOTYpOyBib3JkZXItcmFkaXVzOiA1cHg7XCIpO1xuLy8gICAgICAgICAgICAgfSk7XG4vLyAgICAgICAgICAgICBwcm9qZWN0LmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZW91dFwiLCAoKSA9PiB7XG4vLyAgICAgICAgICAgICAgICAgcHJvamVjdC5zdHlsZS5iYWNrZ3JvdW5kID0gXCJub25lXCI7XG4vLyAgICAgICAgICAgICB9KTtcbi8vICAgICAgICAgfSlcbi8vICAgICAgICAgcmV0dXJuIGNvbXBsZXRlZExpc3QuY2xhc3NMaXN0LnJlbW92ZShcImhpZGRlblwiKTtcbi8vICAgICB9ZWxzZSByZXR1cm4gY29tcGxldGVkTGlzdC5jbGFzc0xpc3QuYWRkKFwiaGlkZGVuXCIpO1xuLy8gfVxuXG4vLyBmdW5jdGlvbiBjaGFuZ2VBcnJvdyhhcnJvd0RpcmVjdGlvbikge1xuLy8gICAgIGNvbnN0IGFycm93SWNvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY29tcGxldGVkLXRhYiAubWF0ZXJpYWwtaWNvbnMtb3V0bGluZWRcIik7XG4vLyAgICAgaWYoYXJyb3dEaXJlY3Rpb24gPT09IFwiQ29tcGxldGVkXFxuZXhwYW5kX21vcmVcIiB8fCBhcnJvd0RpcmVjdGlvbiA9PT0gXCJleHBhbmRfbW9yZVwiKSByZXR1cm4gYXJyb3dJY29uLmlubmVyVGV4dCA9IFwiZXhwYW5kX2xlc3NcIlxuLy8gICAgIGVsc2UgcmV0dXJuIGFycm93SWNvbi5pbm5lclRleHQgPSBcImV4cGFuZF9tb3JlXCI7XG4vLyB9XG5cbi8vIGZ1bmN0aW9uIGFkZFRvUHJvamVjdExpc3QoYXJyKSB7XG4vLyAgICAgY29uc3QgY29tcGxldGVkTGlzdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvamVjdC1saXN0XCIpO1xuLy8gICAgIGNvbXBsZXRlZExpc3QudGV4dENvbnRlbnQgPSBcIlwiO1xuLy8gICAgIGFyci5mb3JFYWNoKChwcm9qZWN0KSA9PiB7XG4vLyAgICAgICAgIGNvbnN0IG5ld1Byb2plY3RDb250YWluZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuLy8gICAgICAgICBuZXdQcm9qZWN0Q29udGFpbmVyLmNsYXNzTGlzdC5hZGQoXCJuZXctcHJvamVjdC1jb25cIik7XG4vLyAgICAgICAgIGNvbnN0IHByb2plY3RUaXRsZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJwXCIpO1xuLy8gICAgICAgICBwcm9qZWN0VGl0bGUuY2xhc3NMaXN0LmFkZChcInByb2plY3QtdGl0bGVcIik7XG4vLyAgICAgICAgIHByb2plY3RUaXRsZS50ZXh0Q29udGVudCA9IHByb2plY3QudGl0bGU7XG4vLyAgICAgICAgIG5ld1Byb2plY3RDb250YWluZXIuYXBwZW5kQ2hpbGQocHJvamVjdFRpdGxlKTtcbi8vICAgICAgICAgbmV3UHJvamVjdENvbnRhaW5lci5hcHBlbmRDaGlsZChjcmVhdGVQcm9qZWN0QnV0dG9ucygpKTtcbi8vICAgICAgICAgY29tcGxldGVkTGlzdC5hcHBlbmRDaGlsZChuZXdQcm9qZWN0Q29udGFpbmVyKTtcbi8vICAgICB9KVxuLy8gICAgIHJldHVybiBjb21wbGV0ZWRMaXN0O1xuLy8gfVxuXG4vLyBmdW5jdGlvbiBkaXNwbGF5VGFzayhhcnIpIHtcbi8vICAgICBjb25zdCB0YXNrTGlzdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvamVjdC10YXNrLWxpc3RcIik7XG4vLyAgICAgY2xlYXJUYXNrTGlzdCgpO1xuLy8gICAgIGFyci5mb3JFYWNoKHRhc2sgPT4ge1xuLy8gICAgICAgICBjb25zdCBwcm9qZWN0VGFzayA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4vLyAgICAgICAgIHByb2plY3RUYXNrLmNsYXNzTGlzdC5hZGQoJ3Byb2plY3QtdGFzaycpO1xuLy8gICAgICAgICBjb25zdCBwcm9qZWN0VGFza0xlZnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuLy8gICAgICAgICBwcm9qZWN0VGFza0xlZnQuY2xhc3NMaXN0LmFkZChcInByb2plY3QtdGFzay1sZWZ0XCIpO1xuLy8gICAgICAgICBjb25zdCBjaGVja0JveCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4vLyAgICAgICAgIGNoZWNrQm94LmNsYXNzTGlzdC5hZGQoJ2NoZWNrYm94Jyk7XG4vLyAgICAgICAgIGNvbnN0IHRhc2tEZXNjcmlwdGlvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJwXCIpO1xuLy8gICAgICAgICB0YXNrRGVzY3JpcHRpb24uY2xhc3NMaXN0LmFkZChcInByb2plY3QtdGFzay1kZXNjXCIpO1xuLy8gICAgICAgICB0YXNrRGVzY3JpcHRpb24udGV4dENvbnRlbnQgPSB0YXNrO1xuLy8gICAgICAgICBwcm9qZWN0VGFza0xlZnQuYXBwZW5kQ2hpbGQoY2hlY2tCb3gpO1xuLy8gICAgICAgICBwcm9qZWN0VGFza0xlZnQuYXBwZW5kQ2hpbGQodGFza0Rlc2NyaXB0aW9uKTtcbi8vICAgICAgICAgcHJvamVjdFRhc2suYXBwZW5kQ2hpbGQocHJvamVjdFRhc2tMZWZ0KTtcbi8vICAgICAgICAgcHJvamVjdFRhc2suYXBwZW5kQ2hpbGQoY3JlYXRlUHJvamVjdEJ1dHRvbnMoKSk7XG4vLyAgICAgICAgIGNvbnN0IGFkZFRhc2tCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmFkZC10YXNrXCIpO1xuLy8gICAgICAgICByZXR1cm4gdGFza0xpc3QuaW5zZXJ0QmVmb3JlKHByb2plY3RUYXNrLCBhZGRUYXNrQnRuKTtcbi8vICAgICB9KTtcbi8vIH1cblxuLy8gZnVuY3Rpb24gZGlzcGxheVByb2plY3QocHJvamVjdE9iaikge1xuLy8gICAgIGNsZWFyVGFza0xpc3QoKTtcbi8vICAgICBjb25zdCBoZWFkZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLm1haW4taGRcIik7XG4vLyAgICAgaGVhZGVyLnRleHRDb250ZW50ID0gcHJvamVjdE9iai50aXRsZTtcbi8vICAgICBjb25zdCBkZXNjcmlwdGlvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubWFpbi1oZC1kZXNjXCIpO1xuLy8gICAgIGRlc2NyaXB0aW9uLnRleHRDb250ZW50ID0gcHJvamVjdE9iai5kZXNjcmlwdGlvbjtcbi8vICAgICBjb25zdCBkYXRlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tYWluLWhkLWRhdGUtdXNlclwiKTtcbi8vICAgICBkYXRlLnRleHRDb250ZW50ID0gcHJvamVjdE9iai5kdWVEYXRlO1xuLy8gICAgIGNvbnN0IHByaW9yaXR5ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tYWluLWhkLXByaW9yaXR5LXVzZXJcIik7XG4vLyAgICAgcHJpb3JpdHkudGV4dENvbnRlbnQgPSBwcm9qZWN0T2JqLnByaW9yaXR5O1xuLy8gICAgIHByaW9yaXR5LnN0eWxlLmNvbG9yID0gY2hhbmdlUHJpb3JpdHlDb2xvcihwcm9qZWN0T2JqLnByaW9yaXR5KTtcblxuLy8gICAgIC8vaXRlcmF0ZSB0aHJvdWdoIHByb2plY3QgdGl0bGUgZWxlbWVudCB0aGF0IGNvbnRhaW5zIHByb2plY3QgdGl0bGVcbi8vICAgICBmb3IgKGNvbnN0IGEgb2YgZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5wcm9qZWN0LXRpdGxlXCIpKSB7XG4vLyAgICAgICAgIGlmKGEudGV4dENvbnRlbnQuaW5jbHVkZXMocHJvamVjdE9iai50aXRsZSkpIHtcbi8vICAgICAgICAgICAgIGEuc2V0QXR0cmlidXRlKFwic3R5bGVcIiwgXCJjb2xvcjogd2hpdGU7IG9wYWNpdHk6IDE7XCIpO1xuLy8gICAgICAgICAgICAgYS5wYXJlbnRFbGVtZW50LnN0eWxlLmJhY2tncm91bmRDb2xvciA9IFwicmdiYSgyNTUsIDI1NSwgMjU1LCAwLjI5NilcIjtcbi8vICAgICAgICAgfWVsc2Uge1xuLy8gICAgICAgICAgICAgYS5zZXRBdHRyaWJ1dGUoXCJzdHlsZVwiLCBcImNvbG9yOiAjRUJFQkVCOyBvcGFjaXR5OiAuNTtcIik7XG4vLyAgICAgICAgICAgICBhLnBhcmVudEVsZW1lbnQuc3R5bGUuYmFja2dyb3VuZCA9IFwibm9uZVwiO1xuLy8gICAgICAgICB9XG4vLyAgICAgfVxuLy8gfVxuXG4vLyBmdW5jdGlvbiByZW1vdmVQcm9qZWN0KCkge1xuLy8gICAgIGlmKHByb2plY3RBcnIubGVuZ3RoID09PSAwKSB7XG4vLyAgICAgICAgIGNvbnN0IGhlYWRlckNvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubWFpbi1oZC1jb25cIik7XG4vLyAgICAgICAgIGhlYWRlckNvbnRhaW5lci50ZXh0Q29udGVudCA9IFwiXCI7XG4vLyAgICAgICAgIGhlYWRlckNvbnRhaW5lci5zdHlsZS5wYWRkaW5nQm90dG9tID0gXCI2LjE1cmVtXCI7XG4vLyAgICAgICAgIHJldHVybiBoZWFkZXJDb250YWluZXI7XG4vLyAgICAgfWVsc2Uge1xuLy8gICAgICAgICBjb25zdCBoZWFkZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLm1haW4taGRcIik7XG4vLyAgICAgICAgIGhlYWRlci50ZXh0Q29udGVudCA9IHByb2plY3RBcnJbMF0udGl0bGU7XG4vLyAgICAgICAgIGNvbnN0IGRlc2NyaXB0aW9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tYWluLWhkLWRlc2NcIik7XG4vLyAgICAgICAgIGRlc2NyaXB0aW9uLnRleHRDb250ZW50ID0gcHJvamVjdEFyclswXS5kZXNjcmlwdGlvbjtcbi8vICAgICAgICAgY29uc3QgZGF0ZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubWFpbi1oZC1kYXRlLXVzZXJcIik7XG4vLyAgICAgICAgIGRhdGUudGV4dENvbnRlbnQgPSBwcm9qZWN0QXJyWzBdLmR1ZURhdGU7XG4vLyAgICAgICAgIGNvbnN0IHByaW9yaXR5ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tYWluLWhkLXByaW9yaXR5LXVzZXJcIik7XG4vLyAgICAgICAgIHByaW9yaXR5LnRleHRDb250ZW50ID0gcHJvamVjdEFyclswXS5wcmlvcml0eTtcbi8vICAgICAgICAgcHJpb3JpdHkuc3R5bGUuY29sb3IgPSBjaGFuZ2VQcmlvcml0eUNvbG9yKHByb2plY3RBcnJbMF0ucHJpb3JpdHkpO1xuLy8gICAgICAgICBjb25zdCBzZWxlY3RlZCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvamVjdC10aXRsZVwiKTtcbi8vICAgICAgICAgc2VsZWN0ZWQuc2V0QXR0cmlidXRlKFwic3R5bGVcIiwgXCJjb2xvcjogd2hpdGU7IG9wYWNpdHk6IDE7XCIpO1xuLy8gICAgICAgICBzZWxlY3RlZC5wYXJlbnRFbGVtZW50LnN0eWxlLmJhY2tncm91bmRDb2xvciA9IFwicmdiYSgyNTUsIDI1NSwgMjU1LCAwLjI5NilcIjtcbi8vICAgICB9XG4vLyB9XG5cbi8vIGZ1bmN0aW9uIGNoYW5nZVByaW9yaXR5Q29sb3IocHJpb3JpdHkpIHtcbi8vICAgICBpZihwcmlvcml0eSA9PT0gXCJMb3dcIikgcmV0dXJuIFwiZ3JlZW5cIjtcbi8vICAgICBlbHNlIGlmKHByaW9yaXR5ID09PSBcIk1lZGl1bVwiKSByZXR1cm4gXCJ5ZWxsb3dcIjtcbi8vICAgICBlbHNlIHJldHVybiBcInJlZFwiO1xuLy8gfVxuXG4vLyBmdW5jdGlvbiBjcmVhdGVQcm9qZWN0QnV0dG9ucygpIHtcbi8vICAgICBjb25zdCBwcm9qZWN0QnRuID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcbi8vICAgICBwcm9qZWN0QnRuLmNsYXNzTGlzdC5hZGQoXCJwcm9qZWN0LWJ0blwiKTtcbi8vICAgICBjb25zdCBlZGl0QnRuID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInNwYW5cIik7XG4vLyAgICAgY29uc3QgZGVsZXRlQnRuID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInNwYW5cIik7XG4vLyAgICAgZWRpdEJ0bi5jbGFzc0xpc3QuYWRkKFwibWF0ZXJpYWwtaWNvbnMtb3V0bGluZWRcIik7XG4vLyAgICAgZWRpdEJ0bi5jbGFzc0xpc3QuYWRkKFwiZWRpdFwiKTtcbi8vICAgICBkZWxldGVCdG4uY2xhc3NMaXN0LmFkZChcIm1hdGVyaWFsLWljb25zLW91dGxpbmVkXCIpO1xuLy8gICAgIGRlbGV0ZUJ0bi5jbGFzc0xpc3QuYWRkKFwiZGVsZXRlXCIpO1xuLy8gICAgIGVkaXRCdG4udGV4dENvbnRlbnQgPSBcImVkaXRcIjtcbi8vICAgICBkZWxldGVCdG4udGV4dENvbnRlbnQgPSBcImRlbGV0ZVwiO1xuLy8gICAgIHByb2plY3RCdG4uYXBwZW5kQ2hpbGQoZWRpdEJ0bik7XG4vLyAgICAgcHJvamVjdEJ0bi5hcHBlbmRDaGlsZChkZWxldGVCdG4pO1xuLy8gICAgIHJldHVybiBwcm9qZWN0QnRuO1xuLy8gfVxuXG4vLyBmdW5jdGlvbiBjbGVhclRhc2tMaXN0KCkge1xuLy8gICAgIGNvbnN0IHRhc2tMaXN0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9qZWN0LXRhc2stbGlzdFwiKTtcbi8vICAgICBjb25zdCBwcm9qZWN0VGFzayA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIucHJvamVjdC10YXNrXCIpO1xuLy8gICAgIGZvcihsZXQgaSA9IDA7IGkgPCBwcm9qZWN0VGFzay5sZW5ndGg7IGkrKykge1xuLy8gICAgICAgICB0YXNrTGlzdC5yZW1vdmVDaGlsZChkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2plY3QtdGFza1wiKSk7XG4vLyAgICAgfVxuLy8gICAgIHJldHVybiB0YXNrTGlzdDtcbi8vIH1cblxuLy8gZXhwb3J0IHtkaXNwbGF5Q29tcGxldGVkTGlzdCwgY2hhbmdlQXJyb3csIGFkZFRvUHJvamVjdExpc3QsIGRpc3BsYXlQcm9qZWN0LCBkaXNwbGF5VGFzaywgcmVtb3ZlUHJvamVjdH07XG5cblxuaW1wb3J0IHsgcHJvamVjdEZvcm0sIGVkaXRQcm9qZWN0Rm9ybX0gZnJvbSBcIi4vcHJvamVjdFwiO1xuaW1wb3J0IHsgdGFza0Zvcm0sIGVkaXRUYXNrRm9ybSB9IGZyb20gXCIuL3Rhc2tcIjtcblxuXG5mdW5jdGlvbiBkaXNwbGF5UHJvamVjdE1vZGFsKCkge1xuICAgIGNvbnN0IGZvcm0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2plY3QtZm9ybVwiKTtcbiAgICBjb25zdCBwcm9qZWN0TW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2plY3QtbW9kYWxcIik7XG4gICAgcHJvamVjdE1vZGFsLnNob3dNb2RhbCgpO1xuICAgIHByb2plY3RGb3JtKCk7XG5cbiAgICBjb25zdCBjbG9zZUJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvamVjdC1jbG9zZVwiKTtcbiAgICBjbG9zZUJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgICAgICBwcm9qZWN0TW9kYWwuY2xvc2UoKTtcbiAgICAgICAgSFRNTEZvcm1FbGVtZW50LnByb3RvdHlwZS5yZXNldC5jYWxsKGZvcm0pXG4gICAgfSk7XG59XG5cbmZ1bmN0aW9uIGRpc3BsYXlFZGl0UHJvamVjdE1vZGFsKHByb2plY3RUaXRsZSkge1xuICAgIGNvbnN0IGZvcm0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmVkaXQtZm9ybVwiKTtcbiAgICBjb25zdCBwcm9qZWN0TW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmVkaXQtbW9kYWxcIik7XG4gICAgcHJvamVjdE1vZGFsLnNob3dNb2RhbCgpO1xuICAgIGVkaXRQcm9qZWN0Rm9ybShwcm9qZWN0VGl0bGUpO1xuXG4gICAgY29uc3QgY2xvc2VCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmVkaXQtY2xvc2VcIik7XG4gICAgY2xvc2VCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICAgICAgcHJvamVjdE1vZGFsLmNsb3NlKCk7XG4gICAgICAgIEhUTUxGb3JtRWxlbWVudC5wcm90b3R5cGUucmVzZXQuY2FsbChmb3JtKVxuICAgIH0pO1xufVxuXG4vKiBkaXNwbGF5aW5nIHByb2plY3QgbGlzdCBvbiBsZWZ0IHNpZGUgb2Ygc2NyZWVuICovXG5mdW5jdGlvbiBkaXNwbGF5UHJvamVjdChhcnIpIHtcbiAgICBjb25zdCBoZWFkZXJDb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLm1haW4taGQtY29uXCIpO1xuICAgIGhlYWRlckNvbnRhaW5lci5zdHlsZS5wYWRkaW5nQm90dG9tID0gXCIxcmVtXCI7XG4gICAgY29uc3QgcHJvamVjdExpc3QgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2plY3QtbGlzdFwiKTtcbiAgICBwcm9qZWN0TGlzdC50ZXh0Q29udGVudCA9IFwiXCI7XG4gICAgZm9yKGxldCBwcm9qZWN0ID0gMDsgcHJvamVjdCA8IGFyci5sZW5ndGg7IHByb2plY3QrKykge1xuICAgICAgICBwcm9qZWN0TGlzdC5hcHBlbmRDaGlsZChjcmVhdGVQcm9qZWN0RWwoYXJyW3Byb2plY3RdKSk7XG4gICAgfVxufVxuXG5mdW5jdGlvbiBjcmVhdGVQcm9qZWN0RWwoYXJyKSB7XG4gICAgY29uc3QgcHJvamVjdENvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4gICAgcHJvamVjdENvbi5jbGFzc0xpc3QuYWRkKFwibmV3LXByb2plY3QtY29uXCIpO1xuXG4gICAgY29uc3QgcHJvamVjdFRpdGxlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInBcIik7XG4gICAgcHJvamVjdFRpdGxlLmNsYXNzTGlzdC5hZGQoXCJwcm9qZWN0LXRpdGxlXCIpO1xuICAgIHByb2plY3RUaXRsZS50ZXh0Q29udGVudCA9IGFyci50aXRsZTtcbiAgICBwcm9qZWN0Q29uLmFwcGVuZENoaWxkKHByb2plY3RUaXRsZSk7XG4gICAgcHJvamVjdENvbi5hcHBlbmRDaGlsZChjcmVhdGVCdXR0b25zKCkpO1xuICAgIHJldHVybiBwcm9qZWN0Q29uO1xufVxuXG5mdW5jdGlvbiBjcmVhdGVCdXR0b25zKCkge1xuICAgIGNvbnN0IHByb2plY3RCdG4gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICAgIHByb2plY3RCdG4uY2xhc3NMaXN0LmFkZChcInByb2plY3QtYnRuXCIpO1xuXG4gICAgY29uc3QgZWRpdEJ0biA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJzcGFuXCIpO1xuICAgIGVkaXRCdG4uY2xhc3NMaXN0LmFkZChcIm1hdGVyaWFsLWljb25zLW91dGxpbmVkXCIpO1xuICAgIGVkaXRCdG4uY2xhc3NMaXN0LmFkZChcImVkaXRcIik7XG4gICAgZWRpdEJ0bi50ZXh0Q29udGVudCA9IFwiZWRpdFwiO1xuICAgIHByb2plY3RCdG4uYXBwZW5kQ2hpbGQoZWRpdEJ0bik7XG5cbiAgICBjb25zdCBkZWxldGVCdG4gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwic3BhblwiKTtcbiAgICBkZWxldGVCdG4uY2xhc3NMaXN0LmFkZChcIm1hdGVyaWFsLWljb25zLW91dGxpbmVkXCIpO1xuICAgIGRlbGV0ZUJ0bi5jbGFzc0xpc3QuYWRkKFwiZGVsZXRlXCIpO1xuICAgIGRlbGV0ZUJ0bi50ZXh0Q29udGVudCA9IFwiZGVsZXRlXCI7XG4gICAgcHJvamVjdEJ0bi5hcHBlbmRDaGlsZChkZWxldGVCdG4pO1xuICAgIHJldHVybiBwcm9qZWN0QnRuO1xufVxuXG5mdW5jdGlvbiBkaXNwbGF5VGFza01vZGFsKCkge1xuICAgIGNvbnN0IGZvcm0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnRhc2stZm9ybVwiKTtcbiAgICBjb25zdCB0YXNrTW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnRhc2stbW9kYWxcIik7XG4gICAgdGFza01vZGFsLnNob3dNb2RhbCgpO1xuICAgIHRhc2tGb3JtKCk7XG5cbiAgICBjb25zdCBjbG9zZUJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIudGFzay1jbG9zZVwiKTtcbiAgICBjbG9zZUJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgICAgICB0YXNrTW9kYWwuY2xvc2UoKTtcbiAgICAgICAgSFRNTEZvcm1FbGVtZW50LnByb3RvdHlwZS5yZXNldC5jYWxsKGZvcm0pO1xuICAgIH0pO1xufVxuXG5mdW5jdGlvbiBkaXNwbGF5RWRpdFRhc2tNb2RhbChwcm9qZWN0VGl0bGUsdGFza1RpdGxlKSB7XG4gICAgY29uc3QgZm9ybSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZWRpdC10YXNrLWZvcm1cIik7XG4gICAgY29uc3QgZWRpdFRhc2tNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZWRpdC10YXNrLW1vZGFsXCIpO1xuICAgIGVkaXRUYXNrTW9kYWwuc2hvd01vZGFsKCk7XG4gICAgZWRpdFRhc2tGb3JtKHByb2plY3RUaXRsZSwgdGFza1RpdGxlKTtcblxuICAgIGNvbnN0IGNsb3NlQnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5lZGl0LXRhc2stY2xvc2VcIik7XG4gICAgY2xvc2VCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICAgICAgZWRpdFRhc2tNb2RhbC5jbG9zZSgpO1xuICAgICAgICBIVE1MRm9ybUVsZW1lbnQucHJvdG90eXBlLnJlc2V0LmNhbGwoZm9ybSk7XG4gICAgfSlcbn1cblxuZnVuY3Rpb24gZGlzcGxheVRhc2soYXJyKSB7XG4gICAgY29uc3QgdGFza0xpc3QgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2plY3QtdGFzay1saXN0XCIpO1xuICAgIGlmKHR5cGVvZiBhcnIgPT09IFwidW5kZWZpbmVkXCIpIHtcbiAgICAgICAgdGFza0xpc3QudGV4dENvbnRlbnQgPSBcIlwiO1xuICAgIH1lbHNlIHtcbiAgICAgICAgdGFza0xpc3QudGV4dENvbnRlbnQgPSBcIlwiO1xuICAgICAgICBmb3IobGV0IGkgPSAwOyBpIDwgYXJyLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhhcnJbaV0pO1xuICAgICAgICAgICAgdGFza0xpc3QuYXBwZW5kQ2hpbGQoY3JlYXRlVGFza0VsKGFycltpXSkpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHRhc2tMaXN0LmFwcGVuZENoaWxkKGNyZWF0ZUFkZFRhc2tCdG4oKSk7XG59XG5cbmZ1bmN0aW9uIGNyZWF0ZVRhc2tFbChkZXNjKSB7XG4gICAgY29uc3QgcHJvamVjdFRhc2sgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICAgIHByb2plY3RUYXNrLmNsYXNzTGlzdC5hZGQoXCJwcm9qZWN0LXRhc2tcIik7XG5cbiAgICBjb25zdCB0YXNrTGVmdCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4gICAgdGFza0xlZnQuY2xhc3NMaXN0LmFkZChcInByb2plY3QtdGFzay1sZWZ0XCIpO1xuICAgIHByb2plY3RUYXNrLmFwcGVuZENoaWxkKHRhc2tMZWZ0KTtcblxuICAgIGNvbnN0IGNoZWNrYm94ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcbiAgICBjaGVja2JveC5jbGFzc0xpc3QuYWRkKFwiY2hlY2tib3hcIik7XG4gICAgdGFza0xlZnQuYXBwZW5kQ2hpbGQoY2hlY2tib3gpO1xuXG4gICAgY29uc3QgdGFza0Rlc2MgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwicFwiKTtcbiAgICB0YXNrRGVzYy5jbGFzc0xpc3QuYWRkKFwicHJvamVjdC10YXNrLWRlc2NcIik7XG4gICAgdGFza0Rlc2MudGV4dENvbnRlbnQgPSBkZXNjO1xuICAgIHRhc2tMZWZ0LmFwcGVuZENoaWxkKHRhc2tEZXNjKTtcblxuICAgIHByb2plY3RUYXNrLmFwcGVuZENoaWxkKGNyZWF0ZVRhc2tCdXR0b25zKCkpO1xuXG4gICAgcmV0dXJuIHByb2plY3RUYXNrO1xufVxuXG5mdW5jdGlvbiBjcmVhdGVUYXNrQnV0dG9ucygpIHtcbiAgICBjb25zdCBwcm9qZWN0QnRuID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcbiAgICBwcm9qZWN0QnRuLmNsYXNzTGlzdC5hZGQoXCJwcm9qZWN0LXRhc2stYnRuXCIpO1xuXG4gICAgY29uc3QgZWRpdEJ0biA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJzcGFuXCIpO1xuICAgIGVkaXRCdG4uY2xhc3NMaXN0LmFkZChcIm1hdGVyaWFsLWljb25zLW91dGxpbmVkXCIpO1xuICAgIGVkaXRCdG4uY2xhc3NMaXN0LmFkZChcImVkaXRcIik7XG4gICAgZWRpdEJ0bi50ZXh0Q29udGVudCA9IFwiZWRpdFwiO1xuICAgIHByb2plY3RCdG4uYXBwZW5kQ2hpbGQoZWRpdEJ0bik7XG5cbiAgICBjb25zdCBkZWxldGVCdG4gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwic3BhblwiKTtcbiAgICBkZWxldGVCdG4uY2xhc3NMaXN0LmFkZChcIm1hdGVyaWFsLWljb25zLW91dGxpbmVkXCIpO1xuICAgIGRlbGV0ZUJ0bi5jbGFzc0xpc3QuYWRkKFwiZGVsZXRlXCIpO1xuICAgIGRlbGV0ZUJ0bi50ZXh0Q29udGVudCA9IFwiZGVsZXRlXCI7XG4gICAgcHJvamVjdEJ0bi5hcHBlbmRDaGlsZChkZWxldGVCdG4pO1xuICAgIHJldHVybiBwcm9qZWN0QnRuO1xufVxuXG5mdW5jdGlvbiBjcmVhdGVBZGRUYXNrQnRuKCkge1xuICAgIGNvbnN0IGFkZFRhc2tCdG4gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiYnV0dG9uXCIpO1xuICAgIGFkZFRhc2tCdG4uY2xhc3NMaXN0LmFkZChcImFkZC10YXNrXCIpO1xuXG4gICAgY29uc3QgYWRkSWNvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJzcGFuXCIpO1xuICAgIGFkZEljb24uY2xhc3NMaXN0LmFkZChcIm1hdGVyaWFsLWljb25zLW91dGxpbmVkXCIpO1xuICAgIGFkZEljb24uY2xhc3NMaXN0LmFkZChcImFkZC1pY29uXCIpO1xuICAgIGFkZEljb24udGV4dENvbnRlbnQgPSBcImFkZFwiO1xuICAgIGFkZFRhc2tCdG4ucHJlcGVuZChhZGRJY29uLCBcIkFkZCBUYXNrXCIpO1xuICAgIHJldHVybiBhZGRUYXNrQnRuO1xufVxuXG5mdW5jdGlvbiBkaXNwbGF5TWFpbihwcm9qZWN0KSB7XG4gICAgY29uc3QgaGVhZGVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tYWluLWhkXCIpO1xuICAgIGhlYWRlci50ZXh0Q29udGVudCA9IHByb2plY3QudGl0bGU7XG5cbiAgICBjb25zdCBkZXNjID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tYWluLWhkLWRlc2NcIik7XG4gICAgZGVzYy50ZXh0Q29udGVudCA9IHByb2plY3QuZGVzYztcblxuICAgIGNvbnN0IGR1ZURhdGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLm1haW4taGQtZGF0ZS11c2VyXCIpO1xuICAgIGR1ZURhdGUudGV4dENvbnRlbnQgPSBwcm9qZWN0LmR1ZURhdGU7XG5cbiAgICBjb25zdCBwcmlvcml0eSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubWFpbi1oZC1wcmlvcml0eS11c2VyXCIpO1xuICAgIHByaW9yaXR5LnRleHRDb250ZW50ID0gcHJvamVjdC5wcmlvcml0eTtcbiAgICBwcmlvcml0eS5zdHlsZS5jb2xvciA9IHByaW9yaXR5Q29sb3IocHJvamVjdC5wcmlvcml0eSk7XG5cbiAgICBjb25zdCB0YXNrTGlzdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvamVjdC10YXNrLWxpc3RcIik7XG4gICAgdGFza0xpc3QudGV4dENvbnRlbnQgPSBcIlwiO1xuICAgIHRhc2tMaXN0LmFwcGVuZENoaWxkKGNyZWF0ZUFkZFRhc2tCdG4oKSk7XG59XG5cbmZ1bmN0aW9uIGRpc3BsYXlEZWxldGVNYWluKGFycikge1xuICAgIGNvbnN0IGhlYWRlckNvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubWFpbi1oZC1jb25cIik7XG5cbiAgICBjb25zdCBoZWFkZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLm1haW4taGRcIik7XG5cbiAgICBjb25zdCBkZXNjID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tYWluLWhkLWRlc2NcIik7XG5cbiAgICBjb25zdCBkdWVEYXRlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tYWluLWhkLWRhdGUtdXNlclwiKTtcblxuICAgIGNvbnN0IHByaW9yaXR5ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tYWluLWhkLXByaW9yaXR5LXVzZXJcIik7XG5cbiAgICBpZihhcnIubGVuZ3RoID09PSAwKSB7XG4gICAgICAgIGhlYWRlci50ZXh0Q29udGVudCA9IFwiXCI7XG4gICAgICAgIGRlc2MudGV4dENvbnRlbnQgPSBcIlwiO1xuICAgICAgICBkdWVEYXRlLnRleHRDb250ZW50ID0gXCJcIjtcbiAgICAgICAgcHJpb3JpdHkudGV4dENvbnRlbnQgPSBcIlwiO1xuICAgICAgICBoZWFkZXJDb250YWluZXIuc3R5bGUucGFkZGluZ0JvdHRvbSA9IFwiNC45cmVtXCI7XG4gICAgfWVsc2Uge1xuICAgICAgICBoZWFkZXIudGV4dENvbnRlbnQgPSBhcnJbMF0udGl0bGU7XG4gICAgICAgIGRlc2MudGV4dENvbnRlbnQgPSBhcnJbMF0uZGVzYztcbiAgICAgICAgZHVlRGF0ZS50ZXh0Q29udGVudCA9IGFyclswXS5kdWVEYXRlO1xuICAgICAgICBwcmlvcml0eS50ZXh0Q29udGVudCA9IGFyclswXS5wcmlvcml0eTtcbiAgICB9XG5cbn1cblxuZnVuY3Rpb24gcHJpb3JpdHlDb2xvcihsZXZlbCkge1xuICAgIGlmKGxldmVsID09PSBcIkxvd1wiKSByZXR1cm4gXCJncmVlblwiO1xuICAgIGVsc2UgaWYobGV2ZWwgPT09IFwiTWVkaXVtXCIpIHJldHVybiBcInllbGxvd1wiO1xuICAgIGVsc2UgcmV0dXJuIFwicmVkXCI7XG59XG5cbmV4cG9ydCB7ZGlzcGxheVByb2plY3QsIGRpc3BsYXlQcm9qZWN0TW9kYWwsIGRpc3BsYXlFZGl0UHJvamVjdE1vZGFsLCBkaXNwbGF5TWFpbiwgZGlzcGxheURlbGV0ZU1haW4sIGRpc3BsYXlUYXNrTW9kYWwsIGRpc3BsYXlUYXNrLCBkaXNwbGF5RWRpdFRhc2tNb2RhbH07IiwiLy8gaW1wb3J0IHsgcHJvamVjdE1vZGFsLCBwcm9qZWN0Rm9ybSwgcHJvamVjdEFyciwgZWRpdE1vZGFsLCBlZGl0Rm9ybSwgZGVsZXRlUHJvamVjdH0gZnJvbSBcIi4vcHJvamVjdFwiO1xuLy8gaW1wb3J0IHsgdGFza01vZGFsLCB0YXNrRm9ybSwgdGFza0FyciwgdXBkYXRlVGFzaywgZWRpdFRhc2tNb2RhbCwgZWRpdFRhc2tGb3JtLCBkZWxldGVUYXNrLCBzdHJpa2VUaHJvdWdoIH0gZnJvbSBcIi4vdGFza1wiO1xuLy8gaW1wb3J0IHsgZGlzcGxheUNvbXBsZXRlZExpc3QsIGNoYW5nZUFycm93LCBkaXNwbGF5UHJvamVjdCwgZGlzcGxheVRhc2ssIHJlbW92ZVByb2plY3R9IGZyb20gXCIuL1VJXCI7XG5cbi8vIGNvbnN0IGFkZFByb2plY3RCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmFkZC1wcm9qZWN0XCIpO1xuLy8gYWRkUHJvamVjdEJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuLy8gICAgIHByb2plY3RNb2RhbCgpO1xuLy8gfSk7XG5cbi8vIHByb2plY3RGb3JtKCk7XG4vLyB0YXNrRm9ybSgpO1xuXG4vLyBjb25zdCBwcm9qZWN0TGlzdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIucHJvamVjdC1saXN0XCIpO1xuLy8gcHJvamVjdExpc3QuZm9yRWFjaCgocHJvamVjdCkgPT4ge1xuLy8gICAgIHByb2plY3QuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChlKSA9PiB7XG4vLyAgICAgICAgIC8vIGNvbnNvbGUubG9nKHByb2plY3RBcnIpO1xuLy8gICAgICAgICBsZXQgcHJvamVjdFRpdGxlID0gXCJcIjtcbi8vICAgICAgICAgaWYoZS50YXJnZXQuY2xhc3NMaXN0LnZhbHVlID09PSBcInByb2plY3QtdGl0bGVcIikge1xuLy8gICAgICAgICAgICAgcHJvamVjdFRpdGxlID0gZS50YXJnZXQuY2hpbGROb2Rlc1swXS50ZXh0Q29udGVudDtcbi8vICAgICAgICAgfWVsc2UgaWYoZS50YXJnZXQuY2xhc3NMaXN0LnZhbHVlID09PSBcIm5ldy1wcm9qZWN0LWNvblwiKSB7XG4vLyAgICAgICAgICAgICBwcm9qZWN0VGl0bGUgPSBlLnRhcmdldC5jaGlsZE5vZGVzWzBdLnRleHRDb250ZW50O1xuLy8gICAgICAgICB9ZWxzZSB7XG4vLyAgICAgICAgICAgICBwcm9qZWN0VGl0bGUgPSBlLnRhcmdldC5wYXJlbnRFbGVtZW50LnBhcmVudEVsZW1lbnQuY2hpbGROb2Rlc1swXS50ZXh0Q29udGVudDtcbi8vICAgICAgICAgfVxuLy8gICAgICAgICBjb25zdCBwcm9qZWN0SW5kZXggPSBwcm9qZWN0QXJyLmZpbmRJbmRleChwcm9qZWN0ID0+IHByb2plY3QudGl0bGUgPT09IHByb2plY3RUaXRsZSk7XG4vLyAgICAgICAgIGRpc3BsYXlQcm9qZWN0KHByb2plY3RBcnJbcHJvamVjdEluZGV4XSk7XG4vLyAgICAgICAgIGNvbnN0IHRhc2tJbmRleCA9IHRhc2tBcnIuZmluZEluZGV4KHRhc2sgPT4gdGFzay5wcm9qZWN0ID09PSBwcm9qZWN0VGl0bGUpO1xuLy8gICAgICAgICBpZih0YXNrSW5kZXggIT09IC0xKSBkaXNwbGF5VGFzayh0YXNrQXJyW3Rhc2tJbmRleF0uZGVzY3JpcHRpb24pO1xuLy8gICAgIH0pXG4vLyB9KVxuXG4vLyBjb25zdCBwcm9qZWN0QnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5wcm9qZWN0LWxpc3RcIik7XG4vLyBwcm9qZWN0QnRuLmZvckVhY2goYnRuID0+IHtcbi8vICAgICBidG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChlKSA9PiB7XG4vLyAgICAgICAgIGlmKGUudGFyZ2V0LmNsYXNzTGlzdC52YWx1ZSA9PT0gXCJtYXRlcmlhbC1pY29ucy1vdXRsaW5lZCBlZGl0XCIpIHtcbi8vICAgICAgICAgICAgIGNvbnN0IHRpdGxlID0gZS50YXJnZXQucGFyZW50RWxlbWVudC5wYXJlbnRFbGVtZW50LmNoaWxkTm9kZXNbMF0udGV4dENvbnRlbnQ7XG4vLyAgICAgICAgICAgICBjb25zdCBwcm9qZWN0SW5kZXggPSBwcm9qZWN0QXJyLmZpbmRJbmRleChwcm9qZWN0ID0+IHByb2plY3QudGl0bGUgPT09IHRpdGxlKTtcbi8vICAgICAgICAgICAgIGNvbnN0IHRhc2tJbmRleCA9IHRhc2tBcnIuZmluZEluZGV4KHRhc2sgPT4gdGFzay5wcm9qZWN0ID09PSB0aXRsZSk7XG4vLyAgICAgICAgICAgICBlZGl0TW9kYWwoKTtcbi8vICAgICAgICAgICAgIGVkaXRGb3JtKHByb2plY3RJbmRleCk7XG4vLyAgICAgICAgICAgICAvLyB1cGRhdGVUYXNrKHRhc2tJbmRleCwgdGl0bGUpO1xuLy8gICAgICAgICAgICAgLy8gY29uc29sZS5sb2coXCJpbmRleCBtb2R1bGVcIik7XG4vLyAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhwcm9qZWN0QXJyKTtcbi8vICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKHByb2plY3RBcnJbcHJvamVjdEluZGV4XSk7XG4vLyAgICAgICAgIH1cbi8vICAgICAgICAgaWYoZS50YXJnZXQuY2xhc3NMaXN0LnZhbHVlID09PSBcIm1hdGVyaWFsLWljb25zLW91dGxpbmVkIGRlbGV0ZVwiKSB7XG4vLyAgICAgICAgICAgICBjb25zdCB0aXRsZSA9IGUudGFyZ2V0LnBhcmVudEVsZW1lbnQucGFyZW50RWxlbWVudC5jaGlsZE5vZGVzWzBdLnRleHRDb250ZW50O1xuLy8gICAgICAgICAgICAgY29uc3QgcHJvamVjdEluZGV4ID0gcHJvamVjdEFyci5maW5kSW5kZXgocHJvamVjdCA9PiBwcm9qZWN0LnRpdGxlID09PSB0aXRsZSk7XG4vLyAgICAgICAgICAgICBkZWxldGVQcm9qZWN0KHByb2plY3RJbmRleCk7XG4vLyAgICAgICAgICAgICBjb25zdCBwcm9qZWN0TGlzdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvamVjdC1saXN0XCIpO1xuLy8gICAgICAgICAgICAgcHJvamVjdExpc3QucmVtb3ZlQ2hpbGQoZS50YXJnZXQucGFyZW50RWxlbWVudC5wYXJlbnRFbGVtZW50KTtcbi8vICAgICAgICAgICAgIHJlbW92ZVByb2plY3QocHJvamVjdEFycik7XG4vLyAgICAgICAgIH1cbi8vICAgICB9KVxuLy8gfSlcblxuLy8gY29uc3QgdGFza0J0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIucHJvamVjdC10YXNrLWxpc3RcIik7XG4vLyB0YXNrQnRuLmZvckVhY2godGFzayA9PiB7XG4vLyAgICAgdGFzay5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGUpID0+IHtcbi8vICAgICAgICAgaWYoZS50YXJnZXQuY2xhc3NMaXN0LnZhbHVlID09PSBcIm1hdGVyaWFsLWljb25zLW91dGxpbmVkIGVkaXRcIikge1xuLy8gICAgICAgICAgICAgY29uc3QgdGFza0Rlc2MgPSBlLnRhcmdldC5wYXJlbnRFbGVtZW50LnBhcmVudEVsZW1lbnQuY2hpbGROb2Rlc1swXS5jaGlsZE5vZGVzWzFdLnRleHRDb250ZW50O1xuLy8gICAgICAgICAgICAgY29uc3QgaGVhZGVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tYWluLWhkXCIpLnRleHRDb250ZW50O1xuLy8gICAgICAgICAgICAgY29uc3QgdGFza0luZGV4ID0gdGFza0Fyci5maW5kSW5kZXgodGFzayA9PiB0YXNrLnByb2plY3QgPT09IGhlYWRlcik7XG4vLyAgICAgICAgICAgICBjb25zdCBkZXNjSW5kZXggPSB0YXNrQXJyW3Rhc2tJbmRleF0uZGVzY3JpcHRpb24uZmluZEluZGV4KGRlc2MgPT4gZGVzYyA9PT0gdGFza0Rlc2MpO1xuLy8gICAgICAgICAgICAgY29uc29sZS5sb2coZGVzY0luZGV4KTtcbi8vICAgICAgICAgICAgIGVkaXRUYXNrTW9kYWwoKTtcbi8vICAgICAgICAgICAgIGVkaXRUYXNrRm9ybSh0YXNrSW5kZXgsIGRlc2NJbmRleCk7XG4vLyAgICAgICAgIH1cbi8vICAgICAgICAgaWYoZS50YXJnZXQuY2xhc3NMaXN0LnZhbHVlID09PSBcIm1hdGVyaWFsLWljb25zLW91dGxpbmVkIGRlbGV0ZVwiKSB7XG4vLyAgICAgICAgICAgICBjb25zdCB0YXNrRGVzYyA9IGUudGFyZ2V0LnBhcmVudEVsZW1lbnQucGFyZW50RWxlbWVudC5jaGlsZE5vZGVzWzBdLmNoaWxkTm9kZXNbMV0udGV4dENvbnRlbnQ7XG4vLyAgICAgICAgICAgICBjb25zdCBoZWFkZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLm1haW4taGRcIikudGV4dENvbnRlbnQ7XG4vLyAgICAgICAgICAgICBjb25zdCB0YXNrSW5kZXggPSB0YXNrQXJyLmZpbmRJbmRleCh0YXNrID0+IHRhc2sucHJvamVjdCA9PT0gaGVhZGVyKTtcbi8vICAgICAgICAgICAgIGNvbnN0IGRlc2NJbmRleCA9IHRhc2tBcnJbdGFza0luZGV4XS5kZXNjcmlwdGlvbi5maW5kSW5kZXgoZGVzYyA9PiBkZXNjID09PSB0YXNrRGVzYyk7XG4vLyAgICAgICAgICAgICBkZWxldGVUYXNrKHRhc2tJbmRleCwgZGVzY0luZGV4KTtcbi8vICAgICAgICAgICAgIGNvbnN0IHByb2plY3RUYXNrTGlzdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvamVjdC10YXNrLWxpc3RcIik7XG4vLyAgICAgICAgICAgICBwcm9qZWN0VGFza0xpc3QucmVtb3ZlQ2hpbGQoZS50YXJnZXQucGFyZW50RWxlbWVudC5wYXJlbnRFbGVtZW50KTtcbi8vICAgICAgICAgfVxuLy8gICAgICAgICBpZihlLnRhcmdldC5jbGFzc0xpc3QudmFsdWUgPT09IFwiY2hlY2tib3hcIiB8fCBlLnRhcmdldC5jbGFzc0xpc3QudmFsdWUgPT09IFwiY2hlY2tib3ggYWN0aXZlXCIpIHtcbi8vICAgICAgICAgICAgIGNvbnN0IGRlc2MgPSBlLnRhcmdldC5wYXJlbnRFbGVtZW50LmNoaWxkTm9kZXNbMV07XG4vLyAgICAgICAgICAgICBjb25zdCBjaGVja2JveCA9IGUudGFyZ2V0O1xuLy8gICAgICAgICAgICAgc3RyaWtlVGhyb3VnaChjaGVja2JveCwgZGVzYyk7XG4vLyAgICAgICAgIH1cbi8vICAgICB9KVxuLy8gfSlcblxuLy8gY29uc3QgYWRkVGFza2J0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuYWRkLXRhc2tcIik7XG4vLyBhZGRUYXNrYnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4vLyAgICAgdGFza01vZGFsKCk7XG4vLyB9KTtcblxuLy8gY29uc3QgY29tcGxldGVkVGFiID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5jb21wbGV0ZWQtdGFiXCIpO1xuLy8gY29tcGxldGVkVGFiLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZSkgPT4ge1xuLy8gICAgIGNvbnN0IGlubmVyVGV4dCA9IGUudGFyZ2V0LmlubmVyVGV4dDtcbi8vICAgICBpZihpbm5lclRleHQgPT09IFwiQ29tcGxldGVkXFxuZXhwYW5kX21vcmVcIiB8fCBpbm5lclRleHQgPT09IFwiZXhwYW5kX21vcmVcIikge1xuLy8gICAgICAgICBjaGFuZ2VBcnJvdyhpbm5lclRleHQpO1xuLy8gICAgICAgICBkaXNwbGF5Q29tcGxldGVkTGlzdChpbm5lclRleHQpO1xuLy8gICAgIH1lbHNlIHtcbi8vICAgICAgICAgY2hhbmdlQXJyb3coaW5uZXJUZXh0KTtcbi8vICAgICAgICAgZGlzcGxheUNvbXBsZXRlZExpc3QoaW5uZXJUZXh0KTtcbi8vICAgICB9XG4vLyB9KTtcblxuaW1wb3J0IHsgZGlzcGxheVByb2plY3RNb2RhbCwgZGlzcGxheUVkaXRQcm9qZWN0TW9kYWwsIGRpc3BsYXlUYXNrTW9kYWwsIGRpc3BsYXlFZGl0VGFza01vZGFsfSBmcm9tIFwiLi9VSVwiO1xuaW1wb3J0IHsgZGVsZXRlUHJvamVjdCwgc2VsZWN0ZWRQcm9qZWN0IH0gZnJvbSBcIi4vcHJvamVjdFwiO1xuaW1wb3J0IHsgc2VsZWN0ZWRUYXNrLCBkZWxldGVFbnRpcmVUYXNrLCBkZWxldGVUYXNrIH0gZnJvbSBcIi4vdGFza1wiO1xuXG5jb25zdCBhZGRQcm9qZWN0QnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5hZGQtcHJvamVjdFwiKTtcbmFkZFByb2plY3RCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICBkaXNwbGF5UHJvamVjdE1vZGFsKCk7XG59KTtcblxuY29uc3QgZWRpdFByb2plY3RCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2plY3QtbGlzdFwiKTtcbmVkaXRQcm9qZWN0QnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZSkgPT4ge1xuICAgIGlmKGUudGFyZ2V0LmNsYXNzTmFtZSA9PT0gXCJtYXRlcmlhbC1pY29ucy1vdXRsaW5lZCBlZGl0XCIpIHtcbiAgICAgICAgY29uc3QgcHJvamVjdFRpdGxlID0gZS50YXJnZXQucGFyZW50RWxlbWVudC5wYXJlbnRFbGVtZW50LmNoaWxkTm9kZXNbMF0udGV4dENvbnRlbnQ7XG4gICAgICAgIGRpc3BsYXlFZGl0UHJvamVjdE1vZGFsKHByb2plY3RUaXRsZSk7XG4gICAgfWVsc2UgaWYoZS50YXJnZXQuY2xhc3NOYW1lID09PSBcIm1hdGVyaWFsLWljb25zLW91dGxpbmVkIGRlbGV0ZVwiKSB7XG4gICAgICAgIGNvbnN0IHByb2plY3RUaXRsZSA9IGUudGFyZ2V0LnBhcmVudEVsZW1lbnQucGFyZW50RWxlbWVudC5jaGlsZE5vZGVzWzBdLnRleHRDb250ZW50O1xuICAgICAgICBkZWxldGVQcm9qZWN0KHByb2plY3RUaXRsZSk7XG4gICAgICAgIGRlbGV0ZUVudGlyZVRhc2socHJvamVjdFRpdGxlKTtcbiAgICB9ZWxzZSB7XG4gICAgICAgIGlmKGUudGFyZ2V0LmNsYXNzTmFtZSA9PT0gXCJwcm9qZWN0LXRpdGxlXCIpIHtcbiAgICAgICAgICAgIGNvbnN0IHByb2plY3RUaXRsZSA9IGUudGFyZ2V0LmNsYXNzTmFtZTtcbiAgICAgICAgICAgIGNvbnN0IHByb2plY3RDb24gPSBlLnRhcmdldC5wYXJlbnRFbGVtZW50LnBhcmVudEVsZW1lbnQ7XG4gICAgICAgICAgICBzZWxlY3RlZFByb2plY3QocHJvamVjdFRpdGxlKTtcbiAgICAgICAgICAgIHNlbGVjdGVkVGFzaygpO1xuICAgICAgICB9ZWxzZSB7XG4gICAgICAgICAgICBjb25zdCBwcm9qZWN0VGl0bGUgPSBlLnRhcmdldC5jaGlsZE5vZGVzWzBdLnRleHRDb250ZW50O1xuICAgICAgICAgICAgY29uc3QgcHJvamVjdENvbiA9IGUudGFyZ2V0LnBhcmVudEVsZW1lbnQ7XG4gICAgICAgICAgICBzZWxlY3RlZFByb2plY3QocHJvamVjdFRpdGxlKTtcbiAgICAgICAgICAgIHNlbGVjdGVkVGFzaygpO1xuICAgICAgICB9XG4gICAgfVxufSk7XG5cbmNvbnN0IHRhc2tMaXN0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9qZWN0LXRhc2stbGlzdFwiKTtcbnRhc2tMaXN0LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZSkgPT4ge1xuICAgIGlmKGUudGFyZ2V0LmNsYXNzTmFtZSA9PT0gXCJhZGQtdGFza1wiKSB7XG4gICAgICAgIGRpc3BsYXlUYXNrTW9kYWwoKTtcbiAgICB9ZWxzZSBpZihlLnRhcmdldC5jbGFzc05hbWUgPT09IFwibWF0ZXJpYWwtaWNvbnMtb3V0bGluZWQgZWRpdFwiKSB7XG4gICAgICAgIGNvbnN0IHRhc2tUaXRsZSA9IGUudGFyZ2V0LnBhcmVudEVsZW1lbnQucGFyZW50RWxlbWVudC5jaGlsZE5vZGVzWzBdLnRleHRDb250ZW50O1xuICAgICAgICBjb25zdCBwcm9qZWN0VGl0bGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLm1haW4taGRcIikudGV4dENvbnRlbnQ7XG4gICAgICAgIGRpc3BsYXlFZGl0VGFza01vZGFsKHByb2plY3RUaXRsZSwgdGFza1RpdGxlKTtcbiAgICB9ZWxzZSBpZihlLnRhcmdldC5jbGFzc05hbWUgPT09IFwibWF0ZXJpYWwtaWNvbnMtb3V0bGluZWQgZGVsZXRlXCIpIHtcbiAgICAgICAgY29uc3QgdGFza1RpdGxlID0gZS50YXJnZXQucGFyZW50RWxlbWVudC5wYXJlbnRFbGVtZW50LmNoaWxkTm9kZXNbMF0udGV4dENvbnRlbnQ7XG4gICAgICAgIGNvbnN0IHByb2plY3RUaXRsZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubWFpbi1oZFwiKS50ZXh0Q29udGVudDtcbiAgICAgICAgZGVsZXRlVGFzayhwcm9qZWN0VGl0bGUsIHRhc2tUaXRsZSk7XG4gICAgfVxufSkiXSwibmFtZXMiOlsicHJvamVjdEFyciIsInNlbGVjdGVkUHJvamVjdCIsInByb2plY3RUaXRsZSIsImluZGV4IiwiZmluZFByb2plY3QiLCJkaXNwbGF5TWFpbiIsImZpbmRJbmRleCIsInByb2plY3QiLCJ0aXRsZSIsInRhc2tBcnIiLCJzZWxlY3RlZFRhc2siLCJkaXNwbGF5VGFzayIsImRlc2MiLCJhcnIiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJ0YXNrIiwidGV4dENvbnRlbnQiLCJmaW5kVGFza0luZGV4IiwidGFza1RpdGxlIiwiZGlzcGxheVByb2plY3QiLCJzdHlsZSIsInBhZGRpbmdCb3R0b20iLCJwcm9qZWN0TGlzdCIsImxlbmd0aCIsImFwcGVuZENoaWxkIiwiY3JlYXRlUHJvamVjdEVsIiwicHJvamVjdENvbiIsImNyZWF0ZUVsZW1lbnQiLCJjbGFzc0xpc3QiLCJhZGQiLCJwcm9qZWN0QnRuIiwiZWRpdEJ0biIsImRlbGV0ZUJ0biIsImNyZWF0ZUJ1dHRvbnMiLCJ0YXNrTGlzdCIsImkiLCJjb25zb2xlIiwibG9nIiwiY3JlYXRlVGFza0VsIiwiY3JlYXRlQWRkVGFza0J0biIsInByb2plY3RUYXNrIiwidGFza0xlZnQiLCJjaGVja2JveCIsInRhc2tEZXNjIiwiY3JlYXRlVGFza0J1dHRvbnMiLCJhZGRUYXNrQnRuIiwiYWRkSWNvbiIsInByZXBlbmQiLCJkdWVEYXRlIiwicHJpb3JpdHkiLCJsZXZlbCIsImNvbG9yIiwiYWRkRXZlbnRMaXN0ZW5lciIsImZvcm0iLCJwcm9qZWN0TW9kYWwiLCJzaG93TW9kYWwiLCJlIiwicHJldmVudERlZmF1bHQiLCJnZXRFbGVtZW50QnlJZCIsImRlc2NyaXB0aW9uIiwiY2hlY2tlZCIsIm5ld1Byb2plY3QiLCJ1c2VyUHJvamVjdCIsInZhbHVlIiwicHVzaCIsImNsb3NlIiwiSFRNTEZvcm1FbGVtZW50IiwicHJvdG90eXBlIiwicmVzZXQiLCJjYWxsIiwib25jZSIsInByb2plY3RGb3JtIiwiZGlzcGxheVByb2plY3RNb2RhbCIsInRhcmdldCIsImNsYXNzTmFtZSIsImVkaXRNb2RhbCIsImVkaXRGb3JtIiwiZWRpdFByb2plY3RGb3JtIiwiZGlzcGxheUVkaXRQcm9qZWN0TW9kYWwiLCJwYXJlbnRFbGVtZW50IiwiY2hpbGROb2RlcyIsInNwbGljZSIsImhlYWRlckNvbnRhaW5lciIsImhlYWRlciIsImRpc3BsYXlEZWxldGVNYWluIiwiZGVsZXRlUHJvamVjdCIsImRlbGV0ZUVudGlyZVRhc2siLCJ0YXNrTW9kYWwiLCJ0YXNrVGl0bGVNYXRjaCIsIm5ld1Rhc2siLCJ1c2VyVGFzayIsInRhc2tGb3JtIiwiZGlzcGxheVRhc2tNb2RhbCIsImVkaXRUYXNrTW9kYWwiLCJ0YXNrSW5kZXgiLCJlZGl0VGFza0Zvcm0iLCJkaXNwbGF5RWRpdFRhc2tNb2RhbCIsImRlbGV0ZVRhc2siXSwic291cmNlUm9vdCI6IiJ9