(()=>{"use strict";function e(e){const t=document.querySelector(".project-list");return t.textContent="",e.forEach((e=>{const n=document.createElement("div");n.classList.add("new-project-con");const o=document.createElement("p");o.classList.add("project-title"),o.textContent=e.title,n.appendChild(o),n.appendChild(c()),t.appendChild(n)})),t}function t(e){const t=document.querySelector(".project-task-list");r(),e.forEach((e=>{const n=document.createElement("div");n.classList.add("project-task");const o=document.createElement("div");o.classList.add("project-task-left");const r=document.createElement("div");r.classList.add("checkbox");const d=document.createElement("p");d.classList.add("project-task-desc"),d.textContent=e,o.appendChild(r),o.appendChild(d),n.appendChild(o),n.appendChild(c());const l=document.querySelector(".add-task");return t.insertBefore(n,l)}))}function n(e){r(),document.querySelector(".main-hd").textContent=e.title,document.querySelector(".main-hd-desc").textContent=e.description,document.querySelector(".main-hd-date-user").textContent=e.dueDate;const t=document.querySelector(".main-hd-priority-user");t.textContent=e.priority,t.style.color=o(e.priority);for(const t of document.querySelectorAll(".project-title"))t.textContent.includes(e.title)?(t.setAttribute("style","color: white; opacity: 1;"),t.parentElement.style.backgroundColor="rgba(255, 255, 255, 0.296)"):(t.setAttribute("style","color: #EBEBEB; opacity: .5;"),t.parentElement.style.background="none")}function o(e){return"Low"===e?"green":"Medium"===e?"yellow":"red"}function c(){const e=document.createElement("div");e.classList.add("project-btn");const t=document.createElement("span"),n=document.createElement("span");return t.classList.add("material-icons-outlined"),t.classList.add("edit"),n.classList.add("material-icons-outlined"),n.classList.add("delete"),t.textContent="edit",n.textContent="delete",e.appendChild(t),e.appendChild(n),e}function r(){const e=document.querySelector(".project-task-list"),t=document.querySelectorAll(".project-task");for(let n=0;n<t.length;n++)e.removeChild(document.querySelector(".project-task"));return e}let d=[];let l=[];document.querySelector(".add-project").addEventListener("click",(()=>{!function(){const e=document.querySelector(".project-modal");e.showModal(),document.querySelector(".project-close").addEventListener("click",(()=>{e.close()}))}()})),function(){const t=document.querySelector(".project-form"),o=document.querySelector(".project-modal");t.addEventListener("submit",(c=>{c.preventDefault();const r=document.getElementById("title"),l=document.getElementById("description"),i=document.getElementById("due-date");let s="Low";document.querySelector(".project-modal #medium").checked?s="Medium":document.querySelector(".project-modal #high").checked&&(s="High");const u=((e,t,n,o)=>({title:e,description:t,dueDate:n,priority:o}))(r.value,l.value,i.value,s);return d.push(u),e(d),n(u),o.close(),t.reset(),d}))}(),function(){const e=document.querySelector(".task-form"),n=document.querySelector(".task-modal"),o=document.querySelector(".main-hd");e.addEventListener("submit",(c=>{c.preventDefault();const r=document.getElementById("task-description");if(function(e){if(0===l.length)return!1;for(let t=0;t<l.length;t++)if(l[t].project===e)return!0}(o.textContent)){const e=l.findIndex((e=>e.project===o.textContent));l[e].description.push(r.value),t(l[e].description)}else{const e=((e,t)=>({project:e,description:t}))(o.textContent,[r.value]);l.push(e);const n=l.findIndex((e=>e.project===o.textContent));t(l[n].description)}return n.close(),e.reset(),l}))}(),document.querySelectorAll(".project-list").forEach((e=>{e.addEventListener("click",(e=>{let o="";o="project-title"===e.target.classList.value||"new-project-con"===e.target.classList.value?e.target.childNodes[0].textContent:e.target.parentElement.parentElement.childNodes[0].textContent;const c=d.findIndex((e=>e.title===o));n(d[c]);const r=l.findIndex((e=>e.project===o));-1!==r&&t(l[r].description)}))})),document.querySelectorAll(".project-list").forEach((t=>{t.addEventListener("click",(t=>{if("material-icons-outlined edit"===t.target.classList.value){const o=t.target.parentElement.parentElement.childNodes[0].textContent,c=d.findIndex((e=>e.title===o));!function(){const e=document.querySelector(".edit-modal");e.showModal(),document.querySelector(".edit-close").addEventListener("click",(()=>{e.close()}))}(),function(t){const o=document.querySelector(".edit-form"),c=document.querySelector(".edit-modal");o.addEventListener("submit",(r=>{r.preventDefault();const l=document.getElementById("edit-title");d[t].title=l.value;const i=document.getElementById("edit-description");d[t].description=i.value;const s=document.getElementById("edit-due-date");d[t].dueDate=s.value;let u="Low";return document.querySelector(".edit-modal #medium").checked?u="Medium":document.querySelector(".edit-modal #high").checked&&(u="High"),d[t].priority=u,console.log("project-module"),console.log(d),e(d),n(d[t]),c.close(),o.reset(),d}),{once:!0})}(c)}if("material-icons-outlined delete"===t.target.classList.value){const e=t.target.parentElement.parentElement.childNodes[0].textContent;c=d.findIndex((t=>t.title===e)),d.splice(c,1),document.querySelector(".project-list").removeChild(t.target.parentElement.parentElement),function(){if(0===d.length){const e=document.querySelector(".main-hd-con");return e.textContent="",e.style.paddingBottom="6.15rem",e}{document.querySelector(".main-hd").textContent=d[0].title,document.querySelector(".main-hd-desc").textContent=d[0].description,document.querySelector(".main-hd-date-user").textContent=d[0].dueDate;const e=document.querySelector(".main-hd-priority-user");e.textContent=d[0].priority,e.style.color=o(d[0].priority)}}()}var c}))})),document.querySelector(".add-task").addEventListener("click",(()=>{!function(){const e=document.querySelector(".task-modal");e.showModal(),document.querySelector(".task-close").addEventListener("click",(t=>{e.close()}))}()})),document.querySelector(".completed-tab").addEventListener("click",(e=>{const t=e.target.innerText;var n;n=t,document.querySelector(".completed-tab .material-icons-outlined").innerText="Completed\nexpand_more"===n||"expand_more"===n?"expand_less":"expand_more",function(e){const t=document.querySelector(".completed-list");"Completed\nexpand_more"===e||"expand_more"===e?(document.querySelectorAll(".user-project").forEach((e=>{e.addEventListener("mouseover",(()=>{e.setAttribute("style","background-color: rgba(255, 255, 255, 0.296); border-radius: 5px;")})),e.addEventListener("mouseout",(()=>{e.style.background="none"}))})),t.classList.remove("hidden")):t.classList.add("hidden")}(t)}))})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWFpbi5qcyIsIm1hcHBpbmdzIjoibUJBd0JBLFNBQVNBLEVBQWlCQyxHQUN0QixNQUFNQyxFQUFnQkMsU0FBU0MsY0FBYyxpQkFZN0MsT0FYQUYsRUFBY0csWUFBYyxHQUM1QkosRUFBSUssU0FBU0MsSUFDVCxNQUFNQyxFQUFzQkwsU0FBU00sY0FBYyxPQUNuREQsRUFBb0JFLFVBQVVDLElBQUksbUJBQ2xDLE1BQU1DLEVBQWVULFNBQVNNLGNBQWMsS0FDNUNHLEVBQWFGLFVBQVVDLElBQUksaUJBQzNCQyxFQUFhUCxZQUFjRSxFQUFRTSxNQUNuQ0wsRUFBb0JNLFlBQVlGLEdBQ2hDSixFQUFvQk0sWUFBWUMsS0FDaENiLEVBQWNZLFlBQVlOLEVBQW9CLElBRTNDTixDQUNYLENBRUEsU0FBU2MsRUFBWWYsR0FDakIsTUFBTWdCLEVBQVdkLFNBQVNDLGNBQWMsc0JBQ3hDYyxJQUNBakIsRUFBSUssU0FBUWEsSUFDUixNQUFNQyxFQUFjakIsU0FBU00sY0FBYyxPQUMzQ1csRUFBWVYsVUFBVUMsSUFBSSxnQkFDMUIsTUFBTVUsRUFBa0JsQixTQUFTTSxjQUFjLE9BQy9DWSxFQUFnQlgsVUFBVUMsSUFBSSxxQkFDOUIsTUFBTVcsRUFBV25CLFNBQVNNLGNBQWMsT0FDeENhLEVBQVNaLFVBQVVDLElBQUksWUFDdkIsTUFBTVksRUFBa0JwQixTQUFTTSxjQUFjLEtBQy9DYyxFQUFnQmIsVUFBVUMsSUFBSSxxQkFDOUJZLEVBQWdCbEIsWUFBY2MsRUFDOUJFLEVBQWdCUCxZQUFZUSxHQUM1QkQsRUFBZ0JQLFlBQVlTLEdBQzVCSCxFQUFZTixZQUFZTyxHQUN4QkQsRUFBWU4sWUFBWUMsS0FDeEIsTUFBTVMsRUFBYXJCLFNBQVNDLGNBQWMsYUFDMUMsT0FBT2EsRUFBU1EsYUFBYUwsRUFBYUksRUFBVyxHQUU3RCxDQUVBLFNBQVNFLEVBQWVDLEdBQ3BCVCxJQUNlZixTQUFTQyxjQUFjLFlBQy9CQyxZQUFjc0IsRUFBV2QsTUFDWlYsU0FBU0MsY0FBYyxpQkFDL0JDLFlBQWNzQixFQUFXQyxZQUN4QnpCLFNBQVNDLGNBQWMsc0JBQy9CQyxZQUFjc0IsRUFBV0UsUUFDOUIsTUFBTUMsRUFBVzNCLFNBQVNDLGNBQWMsMEJBQ3hDMEIsRUFBU3pCLFlBQWNzQixFQUFXRyxTQUNsQ0EsRUFBU0MsTUFBTUMsTUFBUUMsRUFBb0JOLEVBQVdHLFVBR3RELElBQUssTUFBTUksS0FBSy9CLFNBQVNnQyxpQkFBaUIsa0JBQ25DRCxFQUFFN0IsWUFBWStCLFNBQVNULEVBQVdkLFFBQ2pDcUIsRUFBRUcsYUFBYSxRQUFTLDZCQUN4QkgsRUFBRUksY0FBY1AsTUFBTVEsZ0JBQWtCLCtCQUV4Q0wsRUFBRUcsYUFBYSxRQUFTLGdDQUN4QkgsRUFBRUksY0FBY1AsTUFBTVMsV0FBYSxPQUcvQyxDQXFCQSxTQUFTUCxFQUFvQkgsR0FDekIsTUFBZ0IsUUFBYkEsRUFBMkIsUUFDVCxXQUFiQSxFQUE4QixTQUMxQixLQUNoQixDQUVBLFNBQVNmLElBQ0wsTUFBTTBCLEVBQWF0QyxTQUFTTSxjQUFjLE9BQzFDZ0MsRUFBVy9CLFVBQVVDLElBQUksZUFDekIsTUFBTStCLEVBQVV2QyxTQUFTTSxjQUFjLFFBQ2pDa0MsRUFBWXhDLFNBQVNNLGNBQWMsUUFTekMsT0FSQWlDLEVBQVFoQyxVQUFVQyxJQUFJLDJCQUN0QitCLEVBQVFoQyxVQUFVQyxJQUFJLFFBQ3RCZ0MsRUFBVWpDLFVBQVVDLElBQUksMkJBQ3hCZ0MsRUFBVWpDLFVBQVVDLElBQUksVUFDeEIrQixFQUFRckMsWUFBYyxPQUN0QnNDLEVBQVV0QyxZQUFjLFNBQ3hCb0MsRUFBVzNCLFlBQVk0QixHQUN2QkQsRUFBVzNCLFlBQVk2QixHQUNoQkYsQ0FDWCxDQUVBLFNBQVN2QixJQUNMLE1BQU1ELEVBQVdkLFNBQVNDLGNBQWMsc0JBQ2xDZ0IsRUFBY2pCLFNBQVNnQyxpQkFBaUIsaUJBQzlDLElBQUksSUFBSVMsRUFBSSxFQUFHQSxFQUFJeEIsRUFBWXlCLE9BQVFELElBQ25DM0IsRUFBUzZCLFlBQVkzQyxTQUFTQyxjQUFjLGtCQUVoRCxPQUFPYSxDQUNYLENDcElBLElBQUk4QixFQUFhLEdDQWpCLElBQUlDLEVBQVUsR0NFUTdDLFNBQVNDLGNBQWMsZ0JBQy9CNkMsaUJBQWlCLFNBQVMsTUZEeEMsV0FDSSxNQUFNQyxFQUFlL0MsU0FBU0MsY0FBYyxrQkFDNUM4QyxFQUFhQyxZQUNJaEQsU0FBU0MsY0FBYyxrQkFDL0I2QyxpQkFBaUIsU0FBUyxLQUMvQkMsRUFBYUUsT0FBTyxHQUc1QixDRU5JRixFQUFjLElGUWxCLFdBQ0ksTUFBTUcsRUFBT2xELFNBQVNDLGNBQWMsaUJBQzlCOEMsRUFBZS9DLFNBQVNDLGNBQWMsa0JBQzVDaUQsRUFBS0osaUJBQWlCLFVBQVdLLElBQzdCQSxFQUFFQyxpQkFDRixNQUFNMUMsRUFBUVYsU0FBU3FELGVBQWUsU0FDaEM1QixFQUFjekIsU0FBU3FELGVBQWUsZUFDdEMzQixFQUFVMUIsU0FBU3FELGVBQWUsWUFDeEMsSUFBSTFCLEVBQVcsTUFDWjNCLFNBQVNDLGNBQWMsMEJBQTBCcUQsUUFBUzNCLEVBQVcsU0FDaEUzQixTQUFTQyxjQUFjLHdCQUF3QnFELFVBQVMzQixFQUFXLFFBRTNFLE1BQU00QixFQW1ETSxFQUFDN0MsRUFBT2UsRUFBYUMsRUFBU0MsS0FDdkMsQ0FBQ2pCLFFBQU9lLGNBQWFDLFVBQVNDLGFBcERkNkIsQ0FBWTlDLEVBQU0rQyxNQUFPaEMsRUFBWWdDLE1BQU8vQixFQUFRK0IsTUFBTzlCLEdBTzlFLE9BTkFpQixFQUFXYyxLQUFLSCxHQUNoQjFELEVBQWlCK0MsR0FDakJyQixFQUFlZ0MsR0FDZlIsRUFBYUUsUUFDYkMsRUFBS1MsUUFFRWYsQ0FBVSxHQUV6QixDRTFCQWdCLEdES0EsV0FDSSxNQUFNVixFQUFPbEQsU0FBU0MsY0FBYyxjQUM5QjRELEVBQVk3RCxTQUFTQyxjQUFjLGVBQ25DUyxFQUFRVixTQUFTQyxjQUFjLFlBQ3JDaUQsRUFBS0osaUJBQWlCLFVBQVdLLElBQzdCQSxFQUFFQyxpQkFDRixNQUFNM0IsRUFBY3pCLFNBQVNxRCxlQUFlLG9CQUM1QyxHQW1CUixTQUF3QjNDLEdBQ3BCLEdBQXNCLElBQW5CbUMsRUFBUUgsT0FBYyxPQUFPLEVBQ2hDLElBQUksSUFBSW9CLEVBQUksRUFBR0EsRUFBSWpCLEVBQVFILE9BQVFvQixJQUMvQixHQUFHakIsRUFBUWlCLEdBQUcxRCxVQUFZTSxFQUFPLE9BQU8sQ0FFaEQsQ0F4QllxRCxDQUFlckQsRUFBTVIsYUFLbkIsQ0FDRixNQUFNOEQsRUFBZW5CLEVBQVFvQixXQUFVakQsR0FBUUEsRUFBS1osVUFBWU0sRUFBTVIsY0FDdEUyQyxFQUFRbUIsR0FBY3ZDLFlBQVlpQyxLQUFLakMsRUFBWWdDLE9BQ25ENUMsRUFBWWdDLEVBQVFtQixHQUFjdkMsWUFDdEMsS0FUdUMsQ0FDbkMsTUFBTXlDLEVBeUJELEVBQUM5RCxFQUFTcUIsS0FDaEIsQ0FBQ3JCLFVBQVNxQixnQkExQk8wQyxDQUFTekQsRUFBTVIsWUFBYSxDQUFDdUIsRUFBWWdDLFFBQ3pEWixFQUFRYSxLQUFLUSxHQUNiLE1BQU1GLEVBQWVuQixFQUFRb0IsV0FBVWpELEdBQVFBLEVBQUtaLFVBQVlNLEVBQU1SLGNBQ3RFVyxFQUFZZ0MsRUFBUW1CLEdBQWN2QyxZQUN0QyxDQVVBLE9BSkFvQyxFQUFVWixRQUNWQyxFQUFLUyxRQUdFZCxDQUFPLEdBRXRCLENDNUJBdUIsR0FFb0JwRSxTQUFTZ0MsaUJBQWlCLGlCQUNsQzdCLFNBQVNDLElBQ2pCQSxFQUFRMEMsaUJBQWlCLFNBQVVLLElBRS9CLElBQUkxQyxFQUFlLEdBRWZBLEVBRDRCLGtCQUE3QjBDLEVBQUVrQixPQUFPOUQsVUFBVWtELE9BRWdCLG9CQUE3Qk4sRUFBRWtCLE9BQU85RCxVQUFVa0QsTUFEVE4sRUFBRWtCLE9BQU9DLFdBQVcsR0FBR3BFLFlBSXZCaUQsRUFBRWtCLE9BQU9sQyxjQUFjQSxjQUFjbUMsV0FBVyxHQUFHcEUsWUFFdEUsTUFBTThELEVBQWVwQixFQUFXcUIsV0FBVTdELEdBQVdBLEVBQVFNLFFBQVVELElBQ3ZFYyxFQUFlcUIsRUFBV29CLElBQzFCLE1BQU1PLEVBQVkxQixFQUFRb0IsV0FBVWpELEdBQVFBLEVBQUtaLFVBQVlLLEtBQzNDLElBQWY4RCxHQUFrQjFELEVBQVlnQyxFQUFRMEIsR0FBVzlDLFlBQVksR0FDbkUsSUFHY3pCLFNBQVNnQyxpQkFBaUIsaUJBQ2xDN0IsU0FBUXFFLElBQ2ZBLEVBQUkxQixpQkFBaUIsU0FBVUssSUFDM0IsR0FBZ0MsaUNBQTdCQSxFQUFFa0IsT0FBTzlELFVBQVVrRCxNQUEwQyxDQUM1RCxNQUFNL0MsRUFBUXlDLEVBQUVrQixPQUFPbEMsY0FBY0EsY0FBY21DLFdBQVcsR0FBR3BFLFlBQzNEOEQsRUFBZXBCLEVBQVdxQixXQUFVN0QsR0FBV0EsRUFBUU0sUUFBVUEsS0ZDbkYsV0FDSSxNQUFNK0QsRUFBWXpFLFNBQVNDLGNBQWMsZUFDekN3RSxFQUFVekIsWUFDT2hELFNBQVNDLGNBQWMsZUFDL0I2QyxpQkFBaUIsU0FBUyxLQUMvQjJCLEVBQVV4QixPQUFPLEdBR3pCLENFUll3QixHRlVaLFNBQWtCVCxHQUNkLE1BQU1kLEVBQU9sRCxTQUFTQyxjQUFjLGNBQzlCOEMsRUFBZS9DLFNBQVNDLGNBQWMsZUFDNUNpRCxFQUFLSixpQkFBaUIsVUFBV0ssSUFDN0JBLEVBQUVDLGlCQUNGLE1BQU0xQyxFQUFRVixTQUFTcUQsZUFBZSxjQUN0Q1QsRUFBV29CLEdBQWN0RCxNQUFRQSxFQUFNK0MsTUFDdkMsTUFBTWhDLEVBQWN6QixTQUFTcUQsZUFBZSxvQkFDNUNULEVBQVdvQixHQUFjdkMsWUFBY0EsRUFBWWdDLE1BQ25ELE1BQU0vQixFQUFVMUIsU0FBU3FELGVBQWUsaUJBQ3hDVCxFQUFXb0IsR0FBY3RDLFFBQVVBLEVBQVErQixNQUMzQyxJQUFJOUIsRUFBVyxNQVdmLE9BVkczQixTQUFTQyxjQUFjLHVCQUF1QnFELFFBQVMzQixFQUFXLFNBQzdEM0IsU0FBU0MsY0FBYyxxQkFBcUJxRCxVQUFTM0IsRUFBVyxRQUV4RWlCLEVBQVdvQixHQUFjckMsU0FBV0EsRUFDcEMrQyxRQUFRQyxJQUFJLGtCQUNaRCxRQUFRQyxJQUFJL0IsR0FDWi9DLEVBQWlCK0MsR0FDakJyQixFQUFlcUIsRUFBV29CLElBQzFCakIsRUFBYUUsUUFDYkMsRUFBS1MsUUFDRWYsQ0FBVSxHQUNsQixDQUFDZ0MsTUFBTSxHQUNkLENFakNZQyxDQUFTYixFQUliLENBQ0EsR0FBZ0MsbUNBQTdCYixFQUFFa0IsT0FBTzlELFVBQVVrRCxNQUE0QyxDQUM5RCxNQUFNL0MsRUFBUXlDLEVBQUVrQixPQUFPbEMsY0FBY0EsY0FBY21DLFdBQVcsR0FBR3BFLFlGNkJ0RDhELEVFNUJVcEIsRUFBV3FCLFdBQVU3RCxHQUFXQSxFQUFRTSxRQUFVQSxJRjZCeEVrQyxFQUFXa0MsT0FBT2QsRUFBYyxHRTNCWGhFLFNBQVNDLGNBQWMsaUJBQy9CMEMsWUFBWVEsRUFBRWtCLE9BQU9sQyxjQUFjQSxlSHNDM0QsV0FDSSxHQUF5QixJQUF0QlMsRUFBV0YsT0FBYyxDQUN4QixNQUFNcUMsRUFBa0IvRSxTQUFTQyxjQUFjLGdCQUcvQyxPQUZBOEUsRUFBZ0I3RSxZQUFjLEdBQzlCNkUsRUFBZ0JuRCxNQUFNb0QsY0FBZ0IsVUFDL0JELENBQ1gsQ0FBTSxDQUNhL0UsU0FBU0MsY0FBYyxZQUMvQkMsWUFBYzBDLEVBQVcsR0FBR2xDLE1BQ2ZWLFNBQVNDLGNBQWMsaUJBQy9CQyxZQUFjMEMsRUFBVyxHQUFHbkIsWUFDM0J6QixTQUFTQyxjQUFjLHNCQUMvQkMsWUFBYzBDLEVBQVcsR0FBR2xCLFFBQ2pDLE1BQU1DLEVBQVczQixTQUFTQyxjQUFjLDBCQUN4QzBCLEVBQVN6QixZQUFjMEMsRUFBVyxHQUFHakIsU0FDckNBLEVBQVNDLE1BQU1DLE1BQVFDLEVBQW9CYyxFQUFXLEdBQUdqQixTQUM3RCxDQUNKLENHdERZc0QsRUFDSixDRnVCUixJQUF1QmpCLENFdkJmLEdBQ0gsSUFHY2hFLFNBQVNDLGNBQWMsYUFDL0I2QyxpQkFBaUIsU0FBUyxNRG5EckMsV0FDSSxNQUFNZSxFQUFZN0QsU0FBU0MsY0FBYyxlQUN6QzRELEVBQVViLFlBQ09oRCxTQUFTQyxjQUFjLGVBQy9CNkMsaUJBQWlCLFNBQVVLLElBQ2hDVSxFQUFVWixPQUFPLEdBR3pCLENDNENJWSxFQUFXLElBR003RCxTQUFTQyxjQUFjLGtCQUMvQjZDLGlCQUFpQixTQUFVSyxJQUNwQyxNQUFNK0IsRUFBWS9CLEVBQUVrQixPQUFPYSxVSDNDL0IsSUFBcUJDLElHNkNERCxFSDVDRWxGLFNBQVNDLGNBQWMsMkNBQzREaUYsVUFBL0UsMkJBQW5CQyxHQUFrRSxnQkFBbkJBLEVBQStELGNBQy9FLGNBbkJ0QyxTQUE4QkQsR0FDMUIsTUFBTW5GLEVBQWdCQyxTQUFTQyxjQUFjLG1CQUM1QiwyQkFBZGlGLEdBQXdELGdCQUFkQSxHQUNwQmxGLFNBQVNnQyxpQkFBaUIsaUJBQ2xDN0IsU0FBU0MsSUFDbEJBLEVBQVEwQyxpQkFBaUIsYUFBYSxLQUNsQzFDLEVBQVE4QixhQUFhLFFBQVMsb0VBQW9FLElBRXRHOUIsRUFBUTBDLGlCQUFpQixZQUFZLEtBQ2pDMUMsRUFBUXdCLE1BQU1TLFdBQWEsTUFBTSxHQUNuQyxJQUVDdEMsRUFBY1EsVUFBVTZFLE9BQU8sV0FDN0JyRixFQUFjUSxVQUFVQyxJQUFJLFNBQzdDLENHZ0RRNkUsQ0FBcUJILEVBSXpCLEciLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly90by1kby8uL3NyYy9VSS5qcyIsIndlYnBhY2s6Ly90by1kby8uL3NyYy9wcm9qZWN0LmpzIiwid2VicGFjazovL3RvLWRvLy4vc3JjL3Rhc2suanMiLCJ3ZWJwYWNrOi8vdG8tZG8vLi9zcmMvaW5kZXguanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgcHJvamVjdEFyciB9IGZyb20gXCIuL3Byb2plY3RcIjtcblxuZnVuY3Rpb24gZGlzcGxheUNvbXBsZXRlZExpc3QoaW5uZXJUZXh0KSB7XG4gICAgY29uc3QgY29tcGxldGVkTGlzdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY29tcGxldGVkLWxpc3RcIik7XG4gICAgaWYoaW5uZXJUZXh0ID09PSBcIkNvbXBsZXRlZFxcbmV4cGFuZF9tb3JlXCIgfHwgaW5uZXJUZXh0ID09PSBcImV4cGFuZF9tb3JlXCIpIHtcbiAgICAgICAgY29uc3QgcHJvamVjdEhvdmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi51c2VyLXByb2plY3RcIik7XG4gICAgICAgIHByb2plY3RIb3Zlci5mb3JFYWNoKChwcm9qZWN0KSA9PiB7XG4gICAgICAgICAgICBwcm9qZWN0LmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZW92ZXJcIiwgKCkgPT4ge1xuICAgICAgICAgICAgICAgIHByb2plY3Quc2V0QXR0cmlidXRlKFwic3R5bGVcIiwgXCJiYWNrZ3JvdW5kLWNvbG9yOiByZ2JhKDI1NSwgMjU1LCAyNTUsIDAuMjk2KTsgYm9yZGVyLXJhZGl1czogNXB4O1wiKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcHJvamVjdC5hZGRFdmVudExpc3RlbmVyKFwibW91c2VvdXRcIiwgKCkgPT4ge1xuICAgICAgICAgICAgICAgIHByb2plY3Quc3R5bGUuYmFja2dyb3VuZCA9IFwibm9uZVwiO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pXG4gICAgICAgIHJldHVybiBjb21wbGV0ZWRMaXN0LmNsYXNzTGlzdC5yZW1vdmUoXCJoaWRkZW5cIik7XG4gICAgfWVsc2UgcmV0dXJuIGNvbXBsZXRlZExpc3QuY2xhc3NMaXN0LmFkZChcImhpZGRlblwiKTtcbn1cblxuZnVuY3Rpb24gY2hhbmdlQXJyb3coYXJyb3dEaXJlY3Rpb24pIHtcbiAgICBjb25zdCBhcnJvd0ljb24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmNvbXBsZXRlZC10YWIgLm1hdGVyaWFsLWljb25zLW91dGxpbmVkXCIpO1xuICAgIGlmKGFycm93RGlyZWN0aW9uID09PSBcIkNvbXBsZXRlZFxcbmV4cGFuZF9tb3JlXCIgfHwgYXJyb3dEaXJlY3Rpb24gPT09IFwiZXhwYW5kX21vcmVcIikgcmV0dXJuIGFycm93SWNvbi5pbm5lclRleHQgPSBcImV4cGFuZF9sZXNzXCJcbiAgICBlbHNlIHJldHVybiBhcnJvd0ljb24uaW5uZXJUZXh0ID0gXCJleHBhbmRfbW9yZVwiO1xufVxuXG5mdW5jdGlvbiBhZGRUb1Byb2plY3RMaXN0KGFycikge1xuICAgIGNvbnN0IGNvbXBsZXRlZExpc3QgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2plY3QtbGlzdFwiKTtcbiAgICBjb21wbGV0ZWRMaXN0LnRleHRDb250ZW50ID0gXCJcIjtcbiAgICBhcnIuZm9yRWFjaCgocHJvamVjdCkgPT4ge1xuICAgICAgICBjb25zdCBuZXdQcm9qZWN0Q29udGFpbmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcbiAgICAgICAgbmV3UHJvamVjdENvbnRhaW5lci5jbGFzc0xpc3QuYWRkKFwibmV3LXByb2plY3QtY29uXCIpO1xuICAgICAgICBjb25zdCBwcm9qZWN0VGl0bGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwicFwiKTtcbiAgICAgICAgcHJvamVjdFRpdGxlLmNsYXNzTGlzdC5hZGQoXCJwcm9qZWN0LXRpdGxlXCIpO1xuICAgICAgICBwcm9qZWN0VGl0bGUudGV4dENvbnRlbnQgPSBwcm9qZWN0LnRpdGxlO1xuICAgICAgICBuZXdQcm9qZWN0Q29udGFpbmVyLmFwcGVuZENoaWxkKHByb2plY3RUaXRsZSk7XG4gICAgICAgIG5ld1Byb2plY3RDb250YWluZXIuYXBwZW5kQ2hpbGQoY3JlYXRlUHJvamVjdEJ1dHRvbnMoKSk7XG4gICAgICAgIGNvbXBsZXRlZExpc3QuYXBwZW5kQ2hpbGQobmV3UHJvamVjdENvbnRhaW5lcik7XG4gICAgfSlcbiAgICByZXR1cm4gY29tcGxldGVkTGlzdDtcbn1cblxuZnVuY3Rpb24gZGlzcGxheVRhc2soYXJyKSB7XG4gICAgY29uc3QgdGFza0xpc3QgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2plY3QtdGFzay1saXN0XCIpO1xuICAgIGNsZWFyVGFza0xpc3QoKTtcbiAgICBhcnIuZm9yRWFjaCh0YXNrID0+IHtcbiAgICAgICAgY29uc3QgcHJvamVjdFRhc2sgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICAgICAgICBwcm9qZWN0VGFzay5jbGFzc0xpc3QuYWRkKCdwcm9qZWN0LXRhc2snKTtcbiAgICAgICAgY29uc3QgcHJvamVjdFRhc2tMZWZ0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcbiAgICAgICAgcHJvamVjdFRhc2tMZWZ0LmNsYXNzTGlzdC5hZGQoXCJwcm9qZWN0LXRhc2stbGVmdFwiKTtcbiAgICAgICAgY29uc3QgY2hlY2tCb3ggPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICAgICAgICBjaGVja0JveC5jbGFzc0xpc3QuYWRkKCdjaGVja2JveCcpO1xuICAgICAgICBjb25zdCB0YXNrRGVzY3JpcHRpb24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwicFwiKTtcbiAgICAgICAgdGFza0Rlc2NyaXB0aW9uLmNsYXNzTGlzdC5hZGQoXCJwcm9qZWN0LXRhc2stZGVzY1wiKTtcbiAgICAgICAgdGFza0Rlc2NyaXB0aW9uLnRleHRDb250ZW50ID0gdGFzaztcbiAgICAgICAgcHJvamVjdFRhc2tMZWZ0LmFwcGVuZENoaWxkKGNoZWNrQm94KTtcbiAgICAgICAgcHJvamVjdFRhc2tMZWZ0LmFwcGVuZENoaWxkKHRhc2tEZXNjcmlwdGlvbik7XG4gICAgICAgIHByb2plY3RUYXNrLmFwcGVuZENoaWxkKHByb2plY3RUYXNrTGVmdCk7XG4gICAgICAgIHByb2plY3RUYXNrLmFwcGVuZENoaWxkKGNyZWF0ZVByb2plY3RCdXR0b25zKCkpO1xuICAgICAgICBjb25zdCBhZGRUYXNrQnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5hZGQtdGFza1wiKTtcbiAgICAgICAgcmV0dXJuIHRhc2tMaXN0Lmluc2VydEJlZm9yZShwcm9qZWN0VGFzaywgYWRkVGFza0J0bik7XG4gICAgfSk7XG59XG5cbmZ1bmN0aW9uIGRpc3BsYXlQcm9qZWN0KHByb2plY3RPYmopIHtcbiAgICBjbGVhclRhc2tMaXN0KCk7XG4gICAgY29uc3QgaGVhZGVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tYWluLWhkXCIpO1xuICAgIGhlYWRlci50ZXh0Q29udGVudCA9IHByb2plY3RPYmoudGl0bGU7XG4gICAgY29uc3QgZGVzY3JpcHRpb24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLm1haW4taGQtZGVzY1wiKTtcbiAgICBkZXNjcmlwdGlvbi50ZXh0Q29udGVudCA9IHByb2plY3RPYmouZGVzY3JpcHRpb247XG4gICAgY29uc3QgZGF0ZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubWFpbi1oZC1kYXRlLXVzZXJcIik7XG4gICAgZGF0ZS50ZXh0Q29udGVudCA9IHByb2plY3RPYmouZHVlRGF0ZTtcbiAgICBjb25zdCBwcmlvcml0eSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubWFpbi1oZC1wcmlvcml0eS11c2VyXCIpO1xuICAgIHByaW9yaXR5LnRleHRDb250ZW50ID0gcHJvamVjdE9iai5wcmlvcml0eTtcbiAgICBwcmlvcml0eS5zdHlsZS5jb2xvciA9IGNoYW5nZVByaW9yaXR5Q29sb3IocHJvamVjdE9iai5wcmlvcml0eSk7XG5cbiAgICAvL2l0ZXJhdGUgdGhyb3VnaCBwcm9qZWN0IHRpdGxlIGVsZW1lbnQgdGhhdCBjb250YWlucyBwcm9qZWN0IHRpdGxlXG4gICAgZm9yIChjb25zdCBhIG9mIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIucHJvamVjdC10aXRsZVwiKSkge1xuICAgICAgICBpZihhLnRleHRDb250ZW50LmluY2x1ZGVzKHByb2plY3RPYmoudGl0bGUpKSB7XG4gICAgICAgICAgICBhLnNldEF0dHJpYnV0ZShcInN0eWxlXCIsIFwiY29sb3I6IHdoaXRlOyBvcGFjaXR5OiAxO1wiKTtcbiAgICAgICAgICAgIGEucGFyZW50RWxlbWVudC5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSBcInJnYmEoMjU1LCAyNTUsIDI1NSwgMC4yOTYpXCI7XG4gICAgICAgIH1lbHNlIHtcbiAgICAgICAgICAgIGEuc2V0QXR0cmlidXRlKFwic3R5bGVcIiwgXCJjb2xvcjogI0VCRUJFQjsgb3BhY2l0eTogLjU7XCIpO1xuICAgICAgICAgICAgYS5wYXJlbnRFbGVtZW50LnN0eWxlLmJhY2tncm91bmQgPSBcIm5vbmVcIjtcbiAgICAgICAgfVxuICAgIH1cbn1cblxuZnVuY3Rpb24gcmVtb3ZlUHJvamVjdCgpIHtcbiAgICBpZihwcm9qZWN0QXJyLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICBjb25zdCBoZWFkZXJDb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLm1haW4taGQtY29uXCIpO1xuICAgICAgICBoZWFkZXJDb250YWluZXIudGV4dENvbnRlbnQgPSBcIlwiO1xuICAgICAgICBoZWFkZXJDb250YWluZXIuc3R5bGUucGFkZGluZ0JvdHRvbSA9IFwiNi4xNXJlbVwiO1xuICAgICAgICByZXR1cm4gaGVhZGVyQ29udGFpbmVyO1xuICAgIH1lbHNlIHtcbiAgICAgICAgY29uc3QgaGVhZGVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tYWluLWhkXCIpO1xuICAgICAgICBoZWFkZXIudGV4dENvbnRlbnQgPSBwcm9qZWN0QXJyWzBdLnRpdGxlO1xuICAgICAgICBjb25zdCBkZXNjcmlwdGlvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubWFpbi1oZC1kZXNjXCIpO1xuICAgICAgICBkZXNjcmlwdGlvbi50ZXh0Q29udGVudCA9IHByb2plY3RBcnJbMF0uZGVzY3JpcHRpb247XG4gICAgICAgIGNvbnN0IGRhdGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLm1haW4taGQtZGF0ZS11c2VyXCIpO1xuICAgICAgICBkYXRlLnRleHRDb250ZW50ID0gcHJvamVjdEFyclswXS5kdWVEYXRlO1xuICAgICAgICBjb25zdCBwcmlvcml0eSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubWFpbi1oZC1wcmlvcml0eS11c2VyXCIpO1xuICAgICAgICBwcmlvcml0eS50ZXh0Q29udGVudCA9IHByb2plY3RBcnJbMF0ucHJpb3JpdHk7XG4gICAgICAgIHByaW9yaXR5LnN0eWxlLmNvbG9yID0gY2hhbmdlUHJpb3JpdHlDb2xvcihwcm9qZWN0QXJyWzBdLnByaW9yaXR5KTtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIGNoYW5nZVByaW9yaXR5Q29sb3IocHJpb3JpdHkpIHtcbiAgICBpZihwcmlvcml0eSA9PT0gXCJMb3dcIikgcmV0dXJuIFwiZ3JlZW5cIjtcbiAgICBlbHNlIGlmKHByaW9yaXR5ID09PSBcIk1lZGl1bVwiKSByZXR1cm4gXCJ5ZWxsb3dcIjtcbiAgICBlbHNlIHJldHVybiBcInJlZFwiO1xufVxuXG5mdW5jdGlvbiBjcmVhdGVQcm9qZWN0QnV0dG9ucygpIHtcbiAgICBjb25zdCBwcm9qZWN0QnRuID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcbiAgICBwcm9qZWN0QnRuLmNsYXNzTGlzdC5hZGQoXCJwcm9qZWN0LWJ0blwiKTtcbiAgICBjb25zdCBlZGl0QnRuID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInNwYW5cIik7XG4gICAgY29uc3QgZGVsZXRlQnRuID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInNwYW5cIik7XG4gICAgZWRpdEJ0bi5jbGFzc0xpc3QuYWRkKFwibWF0ZXJpYWwtaWNvbnMtb3V0bGluZWRcIik7XG4gICAgZWRpdEJ0bi5jbGFzc0xpc3QuYWRkKFwiZWRpdFwiKTtcbiAgICBkZWxldGVCdG4uY2xhc3NMaXN0LmFkZChcIm1hdGVyaWFsLWljb25zLW91dGxpbmVkXCIpO1xuICAgIGRlbGV0ZUJ0bi5jbGFzc0xpc3QuYWRkKFwiZGVsZXRlXCIpO1xuICAgIGVkaXRCdG4udGV4dENvbnRlbnQgPSBcImVkaXRcIjtcbiAgICBkZWxldGVCdG4udGV4dENvbnRlbnQgPSBcImRlbGV0ZVwiO1xuICAgIHByb2plY3RCdG4uYXBwZW5kQ2hpbGQoZWRpdEJ0bik7XG4gICAgcHJvamVjdEJ0bi5hcHBlbmRDaGlsZChkZWxldGVCdG4pO1xuICAgIHJldHVybiBwcm9qZWN0QnRuO1xufVxuXG5mdW5jdGlvbiBjbGVhclRhc2tMaXN0KCkge1xuICAgIGNvbnN0IHRhc2tMaXN0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9qZWN0LXRhc2stbGlzdFwiKTtcbiAgICBjb25zdCBwcm9qZWN0VGFzayA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIucHJvamVjdC10YXNrXCIpO1xuICAgIGZvcihsZXQgaSA9IDA7IGkgPCBwcm9qZWN0VGFzay5sZW5ndGg7IGkrKykge1xuICAgICAgICB0YXNrTGlzdC5yZW1vdmVDaGlsZChkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2plY3QtdGFza1wiKSk7XG4gICAgfVxuICAgIHJldHVybiB0YXNrTGlzdDtcbn1cblxuZXhwb3J0IHtkaXNwbGF5Q29tcGxldGVkTGlzdCwgY2hhbmdlQXJyb3csIGFkZFRvUHJvamVjdExpc3QsIGRpc3BsYXlQcm9qZWN0LCBkaXNwbGF5VGFzaywgcmVtb3ZlUHJvamVjdH07IiwiaW1wb3J0IHsgYWRkVG9Qcm9qZWN0TGlzdCwgZGlzcGxheVByb2plY3QgfSBmcm9tIFwiLi9VSVwiO1xuXG5sZXQgcHJvamVjdEFyciA9IFtdO1xuXG5mdW5jdGlvbiBwcm9qZWN0TW9kYWwoKSB7XG4gICAgY29uc3QgcHJvamVjdE1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9qZWN0LW1vZGFsXCIpO1xuICAgIHByb2plY3RNb2RhbC5zaG93TW9kYWwoKTtcbiAgICBjb25zdCBjbG9zZUJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvamVjdC1jbG9zZVwiKTtcbiAgICBjbG9zZUJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgICAgICBwcm9qZWN0TW9kYWwuY2xvc2UoKTtcbiAgICB9KTtcbiAgICByZXR1cm4gcHJvamVjdE1vZGFsO1xufVxuXG5mdW5jdGlvbiBwcm9qZWN0Rm9ybSgpIHtcbiAgICBjb25zdCBmb3JtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9qZWN0LWZvcm1cIik7XG4gICAgY29uc3QgcHJvamVjdE1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9qZWN0LW1vZGFsXCIpO1xuICAgIGZvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZSkgPT4ge1xuICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIGNvbnN0IHRpdGxlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJ0aXRsZVwiKTtcbiAgICAgICAgY29uc3QgZGVzY3JpcHRpb24gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImRlc2NyaXB0aW9uXCIpO1xuICAgICAgICBjb25zdCBkdWVEYXRlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJkdWUtZGF0ZVwiKTtcbiAgICAgICAgbGV0IHByaW9yaXR5ID0gXCJMb3dcIjtcbiAgICAgICAgaWYoZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9qZWN0LW1vZGFsICNtZWRpdW1cIikuY2hlY2tlZCkgcHJpb3JpdHkgPSBcIk1lZGl1bVwiO1xuICAgICAgICBlbHNlIGlmKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvamVjdC1tb2RhbCAjaGlnaFwiKS5jaGVja2VkKSBwcmlvcml0eSA9IFwiSGlnaFwiO1xuICAgICAgICBlbHNlIHByaW9yaXR5O1xuICAgICAgICBjb25zdCBuZXdQcm9qZWN0ID0gdXNlclByb2plY3QodGl0bGUudmFsdWUsIGRlc2NyaXB0aW9uLnZhbHVlLCBkdWVEYXRlLnZhbHVlLCBwcmlvcml0eSk7XG4gICAgICAgIHByb2plY3RBcnIucHVzaChuZXdQcm9qZWN0KTtcbiAgICAgICAgYWRkVG9Qcm9qZWN0TGlzdChwcm9qZWN0QXJyKTtcbiAgICAgICAgZGlzcGxheVByb2plY3QobmV3UHJvamVjdCk7XG4gICAgICAgIHByb2plY3RNb2RhbC5jbG9zZSgpO1xuICAgICAgICBmb3JtLnJlc2V0KCk7XG4gICAgICAgIC8vIGNvbnNvbGUubG9nKHByb2plY3RBcnIpO1xuICAgICAgICByZXR1cm4gcHJvamVjdEFycjtcbiAgICB9KTtcbn1cblxuZnVuY3Rpb24gZWRpdE1vZGFsKCkge1xuICAgIGNvbnN0IGVkaXRNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZWRpdC1tb2RhbFwiKTtcbiAgICBlZGl0TW9kYWwuc2hvd01vZGFsKCk7XG4gICAgY29uc3QgY2xvc2VCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmVkaXQtY2xvc2VcIik7XG4gICAgY2xvc2VCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICAgICAgZWRpdE1vZGFsLmNsb3NlKCk7XG4gICAgfSk7XG4gICAgcmV0dXJuIGVkaXRNb2RhbDtcbn1cblxuZnVuY3Rpb24gZWRpdEZvcm0ocHJvamVjdEluZGV4KSB7XG4gICAgY29uc3QgZm9ybSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZWRpdC1mb3JtXCIpO1xuICAgIGNvbnN0IHByb2plY3RNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZWRpdC1tb2RhbFwiKTtcbiAgICBmb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGUpID0+IHtcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICBjb25zdCB0aXRsZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiZWRpdC10aXRsZVwiKTtcbiAgICAgICAgcHJvamVjdEFycltwcm9qZWN0SW5kZXhdLnRpdGxlID0gdGl0bGUudmFsdWU7XG4gICAgICAgIGNvbnN0IGRlc2NyaXB0aW9uID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJlZGl0LWRlc2NyaXB0aW9uXCIpO1xuICAgICAgICBwcm9qZWN0QXJyW3Byb2plY3RJbmRleF0uZGVzY3JpcHRpb24gPSBkZXNjcmlwdGlvbi52YWx1ZTtcbiAgICAgICAgY29uc3QgZHVlRGF0ZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiZWRpdC1kdWUtZGF0ZVwiKTtcbiAgICAgICAgcHJvamVjdEFycltwcm9qZWN0SW5kZXhdLmR1ZURhdGUgPSBkdWVEYXRlLnZhbHVlO1xuICAgICAgICBsZXQgcHJpb3JpdHkgPSBcIkxvd1wiO1xuICAgICAgICBpZihkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmVkaXQtbW9kYWwgI21lZGl1bVwiKS5jaGVja2VkKSBwcmlvcml0eSA9IFwiTWVkaXVtXCI7XG4gICAgICAgIGVsc2UgaWYoZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5lZGl0LW1vZGFsICNoaWdoXCIpLmNoZWNrZWQpIHByaW9yaXR5ID0gXCJIaWdoXCI7XG4gICAgICAgIGVsc2UgcHJpb3JpdHk7XG4gICAgICAgIHByb2plY3RBcnJbcHJvamVjdEluZGV4XS5wcmlvcml0eSA9IHByaW9yaXR5O1xuICAgICAgICBjb25zb2xlLmxvZyhcInByb2plY3QtbW9kdWxlXCIpO1xuICAgICAgICBjb25zb2xlLmxvZyhwcm9qZWN0QXJyKTtcbiAgICAgICAgYWRkVG9Qcm9qZWN0TGlzdChwcm9qZWN0QXJyKTtcbiAgICAgICAgZGlzcGxheVByb2plY3QocHJvamVjdEFycltwcm9qZWN0SW5kZXhdKTtcbiAgICAgICAgcHJvamVjdE1vZGFsLmNsb3NlKCk7XG4gICAgICAgIGZvcm0ucmVzZXQoKTtcbiAgICAgICAgcmV0dXJuIHByb2plY3RBcnI7XG4gICAgfSwge29uY2U6IHRydWV9KTsgLy9wcmV2ZW50IGZvcm0gZnJvbSBzdWJtaXR0aW5nIHR3aWNlIHdoZW4gZWRpdGluZyBtb3JlIHRoYW4gb25jZVxufVxuXG5mdW5jdGlvbiBkZWxldGVQcm9qZWN0KHByb2plY3RJbmRleCkge1xuICAgIHJldHVybiBwcm9qZWN0QXJyLnNwbGljZShwcm9qZWN0SW5kZXgsIDEpO1xufVxuXG5jb25zdCB1c2VyUHJvamVjdCA9ICh0aXRsZSwgZGVzY3JpcHRpb24sIGR1ZURhdGUsIHByaW9yaXR5KSA9PiB7XG4gICAgcmV0dXJuIHt0aXRsZSwgZGVzY3JpcHRpb24sIGR1ZURhdGUsIHByaW9yaXR5fTtcbn0gXG5cblxuZXhwb3J0IHtwcm9qZWN0TW9kYWwsIHByb2plY3RGb3JtLCBwcm9qZWN0QXJyLCBlZGl0TW9kYWwsIGVkaXRGb3JtLCBkZWxldGVQcm9qZWN0fTsiLCJpbXBvcnQgeyBhZGRUb1Rhc2tMaXN0LCBkaXNwbGF5VGFzayB9IGZyb20gXCIuL1VJXCI7XG5cbmxldCB0YXNrQXJyID0gW107XG5cbmZ1bmN0aW9uIHRhc2tNb2RhbCgpIHtcbiAgICBjb25zdCB0YXNrTW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnRhc2stbW9kYWxcIik7XG4gICAgdGFza01vZGFsLnNob3dNb2RhbCgpO1xuICAgIGNvbnN0IGNsb3NlQnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi50YXNrLWNsb3NlXCIpO1xuICAgIGNsb3NlQnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZSkgPT4ge1xuICAgICAgICB0YXNrTW9kYWwuY2xvc2UoKTtcbiAgICB9KTtcbiAgICByZXR1cm4gdGFza01vZGFsO1xufVxuXG5mdW5jdGlvbiB0YXNrRm9ybSgpIHtcbiAgICBjb25zdCBmb3JtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi50YXNrLWZvcm1cIik7XG4gICAgY29uc3QgdGFza01vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi50YXNrLW1vZGFsXCIpO1xuICAgIGNvbnN0IHRpdGxlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tYWluLWhkXCIpO1xuICAgIGZvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZSkgPT4ge1xuICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIGNvbnN0IGRlc2NyaXB0aW9uID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJ0YXNrLWRlc2NyaXB0aW9uXCIpO1xuICAgICAgICBpZighY2hlY2tUYXNrQXJyYXkodGl0bGUudGV4dENvbnRlbnQpKSB7XG4gICAgICAgICAgICBjb25zdCBuZXdUYXNrID0gdXNlclRhc2sodGl0bGUudGV4dENvbnRlbnQsIFtkZXNjcmlwdGlvbi52YWx1ZV0pO1xuICAgICAgICAgICAgdGFza0Fyci5wdXNoKG5ld1Rhc2spO1xuICAgICAgICAgICAgY29uc3QgcHJvamVjdEluZGV4ID0gdGFza0Fyci5maW5kSW5kZXgodGFzayA9PiB0YXNrLnByb2plY3QgPT09IHRpdGxlLnRleHRDb250ZW50KTtcbiAgICAgICAgICAgIGRpc3BsYXlUYXNrKHRhc2tBcnJbcHJvamVjdEluZGV4XS5kZXNjcmlwdGlvbik7XG4gICAgICAgIH1lbHNlIHtcbiAgICAgICAgICAgIGNvbnN0IHByb2plY3RJbmRleCA9IHRhc2tBcnIuZmluZEluZGV4KHRhc2sgPT4gdGFzay5wcm9qZWN0ID09PSB0aXRsZS50ZXh0Q29udGVudCk7XG4gICAgICAgICAgICB0YXNrQXJyW3Byb2plY3RJbmRleF0uZGVzY3JpcHRpb24ucHVzaChkZXNjcmlwdGlvbi52YWx1ZSk7IFxuICAgICAgICAgICAgZGlzcGxheVRhc2sodGFza0Fycltwcm9qZWN0SW5kZXhdLmRlc2NyaXB0aW9uKTtcbiAgICAgICAgfVxuICAgICAgICAvLyBhZGRUb1Rhc2tMaXN0KHRhc2tBcnIpO1xuICAgICAgICB0YXNrTW9kYWwuY2xvc2UoKTtcbiAgICAgICAgZm9ybS5yZXNldCgpO1xuICAgICAgICAvLyBjb25zb2xlLmxvZyh0YXNrQXJyKTtcbiAgICAgICAgLy8gY29uc29sZS5sb2codGFza0FyclswXS5kZXNjcmlwdGlvbik7XG4gICAgICAgIHJldHVybiB0YXNrQXJyO1xuICAgIH0pXG59XG5cbmZ1bmN0aW9uIGNoZWNrVGFza0FycmF5KHRpdGxlKSB7XG4gICAgaWYodGFza0Fyci5sZW5ndGggPT09IDApIHJldHVybiBmYWxzZTtcbiAgICBmb3IobGV0IHggPSAwOyB4IDwgdGFza0Fyci5sZW5ndGg7IHgrKykge1xuICAgICAgICBpZih0YXNrQXJyW3hdLnByb2plY3QgPT09IHRpdGxlKSByZXR1cm4gdHJ1ZTtcbiAgICB9XG59XG5cbmNvbnN0IHVzZXJUYXNrID0gKHByb2plY3QsIGRlc2NyaXB0aW9uKSA9PiB7XG4gICAgcmV0dXJuIHtwcm9qZWN0LCBkZXNjcmlwdGlvbn07XG59IFxuXG5leHBvcnQge3Rhc2tNb2RhbCwgdGFza0Zvcm0sIHRhc2tBcnJ9OyIsImltcG9ydCB7IHByb2plY3RNb2RhbCwgcHJvamVjdEZvcm0sIHByb2plY3RBcnIsIGVkaXRNb2RhbCwgZWRpdEZvcm0sIGRlbGV0ZVByb2plY3R9IGZyb20gXCIuL3Byb2plY3RcIjtcbmltcG9ydCB7IHRhc2tNb2RhbCwgdGFza0Zvcm0sIHRhc2tBcnIgfSBmcm9tIFwiLi90YXNrXCI7XG5pbXBvcnQgeyBkaXNwbGF5Q29tcGxldGVkTGlzdCwgY2hhbmdlQXJyb3csIGRpc3BsYXlQcm9qZWN0LCBkaXNwbGF5VGFzaywgcmVtb3ZlUHJvamVjdH0gZnJvbSBcIi4vVUlcIjtcblxuY29uc3QgYWRkUHJvamVjdEJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuYWRkLXByb2plY3RcIik7XG5hZGRQcm9qZWN0QnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgcHJvamVjdE1vZGFsKCk7XG59KTtcblxucHJvamVjdEZvcm0oKTtcbnRhc2tGb3JtKCk7XG5cbmNvbnN0IHByb2plY3RMaXN0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5wcm9qZWN0LWxpc3RcIik7XG5wcm9qZWN0TGlzdC5mb3JFYWNoKChwcm9qZWN0KSA9PiB7XG4gICAgcHJvamVjdC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGUpID0+IHtcbiAgICAgICAgLy8gY29uc29sZS5sb2cocHJvamVjdEFycik7XG4gICAgICAgIGxldCBwcm9qZWN0VGl0bGUgPSBcIlwiO1xuICAgICAgICBpZihlLnRhcmdldC5jbGFzc0xpc3QudmFsdWUgPT09IFwicHJvamVjdC10aXRsZVwiKSB7XG4gICAgICAgICAgICBwcm9qZWN0VGl0bGUgPSBlLnRhcmdldC5jaGlsZE5vZGVzWzBdLnRleHRDb250ZW50O1xuICAgICAgICB9ZWxzZSBpZihlLnRhcmdldC5jbGFzc0xpc3QudmFsdWUgPT09IFwibmV3LXByb2plY3QtY29uXCIpIHtcbiAgICAgICAgICAgIHByb2plY3RUaXRsZSA9IGUudGFyZ2V0LmNoaWxkTm9kZXNbMF0udGV4dENvbnRlbnQ7XG4gICAgICAgIH1lbHNlIHtcbiAgICAgICAgICAgIHByb2plY3RUaXRsZSA9IGUudGFyZ2V0LnBhcmVudEVsZW1lbnQucGFyZW50RWxlbWVudC5jaGlsZE5vZGVzWzBdLnRleHRDb250ZW50O1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IHByb2plY3RJbmRleCA9IHByb2plY3RBcnIuZmluZEluZGV4KHByb2plY3QgPT4gcHJvamVjdC50aXRsZSA9PT0gcHJvamVjdFRpdGxlKTtcbiAgICAgICAgZGlzcGxheVByb2plY3QocHJvamVjdEFycltwcm9qZWN0SW5kZXhdKTtcbiAgICAgICAgY29uc3QgdGFza0luZGV4ID0gdGFza0Fyci5maW5kSW5kZXgodGFzayA9PiB0YXNrLnByb2plY3QgPT09IHByb2plY3RUaXRsZSk7XG4gICAgICAgIGlmKHRhc2tJbmRleCAhPT0gLTEpIGRpc3BsYXlUYXNrKHRhc2tBcnJbdGFza0luZGV4XS5kZXNjcmlwdGlvbik7XG4gICAgfSlcbn0pXG5cbmNvbnN0IHByb2plY3RCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLnByb2plY3QtbGlzdFwiKTtcbnByb2plY3RCdG4uZm9yRWFjaChidG4gPT4ge1xuICAgIGJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGUpID0+IHtcbiAgICAgICAgaWYoZS50YXJnZXQuY2xhc3NMaXN0LnZhbHVlID09PSBcIm1hdGVyaWFsLWljb25zLW91dGxpbmVkIGVkaXRcIikge1xuICAgICAgICAgICAgY29uc3QgdGl0bGUgPSBlLnRhcmdldC5wYXJlbnRFbGVtZW50LnBhcmVudEVsZW1lbnQuY2hpbGROb2Rlc1swXS50ZXh0Q29udGVudDtcbiAgICAgICAgICAgIGNvbnN0IHByb2plY3RJbmRleCA9IHByb2plY3RBcnIuZmluZEluZGV4KHByb2plY3QgPT4gcHJvamVjdC50aXRsZSA9PT0gdGl0bGUpO1xuICAgICAgICAgICAgZWRpdE1vZGFsKCk7XG4gICAgICAgICAgICBlZGl0Rm9ybShwcm9qZWN0SW5kZXgpO1xuICAgICAgICAgICAgLy8gY29uc29sZS5sb2coXCJpbmRleCBtb2R1bGVcIik7XG4gICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhwcm9qZWN0QXJyKTtcbiAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKHByb2plY3RBcnJbcHJvamVjdEluZGV4XSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYoZS50YXJnZXQuY2xhc3NMaXN0LnZhbHVlID09PSBcIm1hdGVyaWFsLWljb25zLW91dGxpbmVkIGRlbGV0ZVwiKSB7XG4gICAgICAgICAgICBjb25zdCB0aXRsZSA9IGUudGFyZ2V0LnBhcmVudEVsZW1lbnQucGFyZW50RWxlbWVudC5jaGlsZE5vZGVzWzBdLnRleHRDb250ZW50O1xuICAgICAgICAgICAgY29uc3QgcHJvamVjdEluZGV4ID0gcHJvamVjdEFyci5maW5kSW5kZXgocHJvamVjdCA9PiBwcm9qZWN0LnRpdGxlID09PSB0aXRsZSk7XG4gICAgICAgICAgICBkZWxldGVQcm9qZWN0KHByb2plY3RJbmRleCk7XG4gICAgICAgICAgICBjb25zdCBwcm9qZWN0TGlzdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvamVjdC1saXN0XCIpO1xuICAgICAgICAgICAgcHJvamVjdExpc3QucmVtb3ZlQ2hpbGQoZS50YXJnZXQucGFyZW50RWxlbWVudC5wYXJlbnRFbGVtZW50KTtcbiAgICAgICAgICAgIHJlbW92ZVByb2plY3QocHJvamVjdEFycik7XG4gICAgICAgIH1cbiAgICB9KVxufSlcblxuY29uc3QgYWRkVGFza2J0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuYWRkLXRhc2tcIik7XG5hZGRUYXNrYnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgdGFza01vZGFsKCk7XG59KTtcblxuY29uc3QgY29tcGxldGVkVGFiID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5jb21wbGV0ZWQtdGFiXCIpO1xuY29tcGxldGVkVGFiLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZSkgPT4ge1xuICAgIGNvbnN0IGlubmVyVGV4dCA9IGUudGFyZ2V0LmlubmVyVGV4dDtcbiAgICBpZihpbm5lclRleHQgPT09IFwiQ29tcGxldGVkXFxuZXhwYW5kX21vcmVcIiB8fCBpbm5lclRleHQgPT09IFwiZXhwYW5kX21vcmVcIikge1xuICAgICAgICBjaGFuZ2VBcnJvdyhpbm5lclRleHQpO1xuICAgICAgICBkaXNwbGF5Q29tcGxldGVkTGlzdChpbm5lclRleHQpO1xuICAgIH1lbHNlIHtcbiAgICAgICAgY2hhbmdlQXJyb3coaW5uZXJUZXh0KTtcbiAgICAgICAgZGlzcGxheUNvbXBsZXRlZExpc3QoaW5uZXJUZXh0KTtcbiAgICB9XG59KTtcbiJdLCJuYW1lcyI6WyJhZGRUb1Byb2plY3RMaXN0IiwiYXJyIiwiY29tcGxldGVkTGlzdCIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvciIsInRleHRDb250ZW50IiwiZm9yRWFjaCIsInByb2plY3QiLCJuZXdQcm9qZWN0Q29udGFpbmVyIiwiY3JlYXRlRWxlbWVudCIsImNsYXNzTGlzdCIsImFkZCIsInByb2plY3RUaXRsZSIsInRpdGxlIiwiYXBwZW5kQ2hpbGQiLCJjcmVhdGVQcm9qZWN0QnV0dG9ucyIsImRpc3BsYXlUYXNrIiwidGFza0xpc3QiLCJjbGVhclRhc2tMaXN0IiwidGFzayIsInByb2plY3RUYXNrIiwicHJvamVjdFRhc2tMZWZ0IiwiY2hlY2tCb3giLCJ0YXNrRGVzY3JpcHRpb24iLCJhZGRUYXNrQnRuIiwiaW5zZXJ0QmVmb3JlIiwiZGlzcGxheVByb2plY3QiLCJwcm9qZWN0T2JqIiwiZGVzY3JpcHRpb24iLCJkdWVEYXRlIiwicHJpb3JpdHkiLCJzdHlsZSIsImNvbG9yIiwiY2hhbmdlUHJpb3JpdHlDb2xvciIsImEiLCJxdWVyeVNlbGVjdG9yQWxsIiwiaW5jbHVkZXMiLCJzZXRBdHRyaWJ1dGUiLCJwYXJlbnRFbGVtZW50IiwiYmFja2dyb3VuZENvbG9yIiwiYmFja2dyb3VuZCIsInByb2plY3RCdG4iLCJlZGl0QnRuIiwiZGVsZXRlQnRuIiwiaSIsImxlbmd0aCIsInJlbW92ZUNoaWxkIiwicHJvamVjdEFyciIsInRhc2tBcnIiLCJhZGRFdmVudExpc3RlbmVyIiwicHJvamVjdE1vZGFsIiwic2hvd01vZGFsIiwiY2xvc2UiLCJmb3JtIiwiZSIsInByZXZlbnREZWZhdWx0IiwiZ2V0RWxlbWVudEJ5SWQiLCJjaGVja2VkIiwibmV3UHJvamVjdCIsInVzZXJQcm9qZWN0IiwidmFsdWUiLCJwdXNoIiwicmVzZXQiLCJwcm9qZWN0Rm9ybSIsInRhc2tNb2RhbCIsIngiLCJjaGVja1Rhc2tBcnJheSIsInByb2plY3RJbmRleCIsImZpbmRJbmRleCIsIm5ld1Rhc2siLCJ1c2VyVGFzayIsInRhc2tGb3JtIiwidGFyZ2V0IiwiY2hpbGROb2RlcyIsInRhc2tJbmRleCIsImJ0biIsImVkaXRNb2RhbCIsImNvbnNvbGUiLCJsb2ciLCJvbmNlIiwiZWRpdEZvcm0iLCJzcGxpY2UiLCJoZWFkZXJDb250YWluZXIiLCJwYWRkaW5nQm90dG9tIiwicmVtb3ZlUHJvamVjdCIsImlubmVyVGV4dCIsImFycm93RGlyZWN0aW9uIiwicmVtb3ZlIiwiZGlzcGxheUNvbXBsZXRlZExpc3QiXSwic291cmNlUm9vdCI6IiJ9