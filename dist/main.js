(()=>{"use strict";let e=[];function t(){const t=n(e);-1!=t&&i(e[t].desc)}function n(e,t){const n=document.querySelector(".main-hd");return void 0===t?e.findIndex((e=>e.title===n.textContent)):e.findIndex((e=>e.title===t))}function o(e,t){return document.querySelector(".main-hd"),e.findIndex((e=>e===t))}let c=[];function d(e){const t=l(e);m(c[t])}function l(e){return c.findIndex((t=>t.title===e))}function r(e){document.querySelector(".main-hd-con").style.paddingBottom="1rem";const t=document.querySelector(".project-list");t.textContent="";for(let n=0;n<e.length;n++)t.appendChild(s(e[n]))}function s(e){const t=document.createElement("div");t.classList.add("new-project-con");const n=document.createElement("p");return n.classList.add("project-title"),n.textContent=e.title,t.appendChild(n),t.appendChild(function(){const e=document.createElement("div");e.classList.add("project-btn");const t=document.createElement("span");t.classList.add("material-icons-outlined"),t.classList.add("edit"),t.textContent="edit",e.appendChild(t);const n=document.createElement("span");return n.classList.add("material-icons-outlined"),n.classList.add("delete"),n.textContent="delete",e.appendChild(n),e}()),t}function i(e){const t=document.querySelector(".project-task-list");if(void 0===e)t.textContent="";else{t.textContent="";for(let n=0;n<e.length;n++)console.log(e[n]),t.appendChild(a(e[n]))}t.appendChild(u())}function a(e){const t=document.createElement("div");t.classList.add("project-task");const n=document.createElement("div");n.classList.add("project-task-left"),t.appendChild(n);const o=document.createElement("p");return o.classList.add("project-task-desc"),o.textContent=e,n.appendChild(o),t.appendChild(function(){const e=document.createElement("div");e.classList.add("project-task-btn");const t=document.createElement("span");t.classList.add("material-icons-outlined"),t.classList.add("edit"),t.textContent="edit",e.appendChild(t);const n=document.createElement("span");return n.classList.add("material-icons-outlined"),n.classList.add("delete"),n.textContent="delete",e.appendChild(n),e}()),t}function u(){const e=document.createElement("button");e.classList.add("add-task");const t=document.createElement("span");return t.classList.add("material-icons-outlined"),t.classList.add("add-icon"),t.textContent="add",e.prepend(t,"Add Task"),e}function m(e){document.querySelector(".main-hd").textContent=e.title,document.querySelector(".main-hd-desc").textContent=e.desc,document.querySelector(".main-hd-date-user").textContent=e.dueDate;const t=document.querySelector(".main-hd-priority-user");var n;t.textContent=e.priority,t.style.color="Low"===(n=e.priority)?"green":"Medium"===n?"yellow":"red";const o=document.querySelector(".project-task-list");o.textContent="",o.appendChild(u())}document.querySelector(".add-project").addEventListener("click",(()=>{!function(){const e=document.querySelector(".project-form"),t=document.querySelector(".project-modal");t.showModal(),function(){const e=document.querySelector(".project-modal"),t=document.querySelector(".project-form");t.addEventListener("submit",(n=>{n.preventDefault();const o=document.getElementById("title"),d=document.getElementById("description"),l=document.getElementById("due-date");let s="Low";document.querySelector(".project-modal #medium").checked?s="Medium":document.querySelector(".project-modal #high").checked&&(s="High");const i=((e,t,n,o)=>({title:e,desc:t,dueDate:n,priority:o}))(o.value,d.value,l.value,s);c.push(i),r(c),m(i),e.close(),HTMLFormElement.prototype.reset.call(t)}),{once:!0})}(),document.querySelector(".project-close").addEventListener("click",(()=>{t.close(),HTMLFormElement.prototype.reset.call(e)}))}()})),document.querySelector(".project-list").addEventListener("click",(o=>{if("material-icons-outlined edit"===o.target.className)!function(t){const n=document.querySelector(".edit-form"),o=document.querySelector(".edit-modal");o.showModal(),function(t){const n=document.querySelector(".edit-modal"),o=document.querySelector(".edit-form");o.addEventListener("submit",(d=>{d.preventDefault();const s=document.getElementById("edit-title"),a=document.getElementById("edit-description"),u=document.getElementById("edit-due-date");let p="Low";document.querySelector(".edit-form #medium").checked?p="Medium":document.querySelector(".edit-form #high").checked&&(p="High");const y=l(t);c[y].title=s.value,c[y].desc=a.value,c[y].dueDate=u.value,c[y].priority=p,r(c),m(c[y]),function(t,n){e[t].title=n,i(e[t].desc)}(y,s.value),n.close(),console.log(c),HTMLFormElement.prototype.reset.call(o)}),{once:!0})}(t),document.querySelector(".edit-close").addEventListener("click",(()=>{o.close(),HTMLFormElement.prototype.reset.call(n)}))}(o.target.parentElement.parentElement.childNodes[0].textContent);else if("material-icons-outlined delete"===o.target.className){const t=o.target.parentElement.parentElement.childNodes[0].textContent;(function(e){const t=l(e);c.splice(t,1),console.log(c),r(c),function(e){const t=document.querySelector(".main-hd-con"),n=document.querySelector(".main-hd"),o=document.querySelector(".main-hd-desc"),c=document.querySelector(".main-hd-date-user"),d=document.querySelector(".main-hd-priority-user");0===e.length?(n.textContent="",o.textContent="",c.textContent="",d.textContent="",t.style.paddingBottom="4.9rem"):(n.textContent=e[0].title,o.textContent=e[0].desc,c.textContent=e[0].dueDate,d.textContent=e[0].priority)}(c)})(t),function(t){const o=n(e,t);e.splice(o,1),i(e[o]),0!==e.length&&i(e[0].desc)}(t)}else if("project-title"===o.target.className){const e=o.target.className;o.target.parentElement.parentElement,d(e),t()}else{const e=o.target.childNodes[0].textContent;o.target.parentElement,d(e),t()}})),document.querySelector(".project-task-list").addEventListener("click",(t=>{if("add-task"===t.target.className)!function(){const t=document.querySelector(".task-form"),o=document.querySelector(".task-modal");o.showModal(),function(){const t=document.querySelector(".task-modal"),o=document.querySelector(".task-form");o.addEventListener("submit",(c=>{c.preventDefault();const d=document.querySelector(".main-hd"),l=document.getElementById("task-description");if(function(t){if(0===e.length)return!1;for(let n=0;n<e.length;n++)if(e[n].title===t)return!0;return!1}(d.textContent)){const t=n(e);e[t].desc.push(l.value)}else{const t=((e,t)=>({title:e,desc:t}))(d.textContent,[l.value]);e.push(t)}const r=n(e);i(e[r].desc),t.close(),HTMLFormElement.prototype.reset.call(o)}),{once:!0})}(),document.querySelector(".task-close").addEventListener("click",(()=>{o.close(),HTMLFormElement.prototype.reset.call(t)}))}();else if("material-icons-outlined edit"===t.target.className){const c=t.target.parentElement.parentElement.childNodes[0].textContent;!function(t,c){const d=document.querySelector(".edit-task-form"),l=document.querySelector(".edit-task-modal");l.showModal(),function(t,c){const d=document.querySelector(".edit-task-modal"),l=document.querySelector(".edit-task-form");l.addEventListener("submit",(r=>{r.preventDefault(),document.querySelector(".main-hd");const s=document.getElementById("edit-task-description"),a=n(e,t),u=o(e[a].desc,c);console.log(u),e[a].desc[u]=s.value,i(e[a].desc),d.close(),HTMLFormElement.prototype.reset.call(l)}),{once:!0})}(t,c),document.querySelector(".edit-task-close").addEventListener("click",(()=>{l.close(),HTMLFormElement.prototype.reset.call(d)}))}(document.querySelector(".main-hd").textContent,c)}else if("material-icons-outlined delete"===t.target.className){const c=t.target.parentElement.parentElement.childNodes[0].textContent;!function(t,c){const d=n(e,t),l=o(e[d].desc,c);e[d].desc.splice(l,1),i(e[d].desc)}(document.querySelector(".main-hd").textContent,c)}}))})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LEVBQUVpQixPQUFPUSxjQUFjQSxjQUFjQyxXQUFXLEdBQUd0RSxhSFU3RSxTQUFvQkwsRUFBY08sR0FDOUIsTUFBTVosRUFBUUMsRUFBVUgsRUFBU08sR0FDM0J5RixFQUFZbkYsRUFBY2IsRUFBUUUsR0FBT0csS0FBTVMsR0FDckRkLEVBQVFFLEdBQU9HLEtBQUs4RSxPQUFPYSxFQUFXLEdBQ3RDNUYsRUFBWUosRUFBUUUsR0FBT0csS0FDL0IsQ0diUThGLENBRHFCMUYsU0FBU0MsY0FBYyxZQUFZRSxZQUMvQkUsRUFDN0IsSSIsInNvdXJjZXMiOlsid2VicGFjazovL3RvLWRvLy4vc3JjL3Rhc2suanMiLCJ3ZWJwYWNrOi8vdG8tZG8vLi9zcmMvcHJvamVjdC5qcyIsIndlYnBhY2s6Ly90by1kby8uL3NyYy9VSS5qcyIsIndlYnBhY2s6Ly90by1kby8uL3NyYy9pbmRleC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBkaXNwbGF5VGFzayB9IGZyb20gXCIuL1VJXCI7XG5pbXBvcnQgeyBvbGRQcm9qZWN0VmFsdWUgfSBmcm9tIFwiLi9wcm9qZWN0XCI7XG5cbmxldCB0YXNrQXJyID0gW107XG5cbmNvbnN0IHVzZXJUYXNrID0gKHRpdGxlLCBkZXNjKSA9PiB7XG4gICAgcmV0dXJuIHt0aXRsZSwgZGVzY307XG59XG5cbmZ1bmN0aW9uIHRhc2tGb3JtKCkge1xuICAgIGNvbnN0IHRhc2tNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIudGFzay1tb2RhbFwiKTtcbiAgICBjb25zdCBmb3JtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi50YXNrLWZvcm1cIik7XG4gICAgZm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChlKSA9PiB7XG4gICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgY29uc3QgdGl0bGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLm1haW4taGRcIik7XG4gICAgICAgIGNvbnN0IGRlc2NyaXB0aW9uID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJ0YXNrLWRlc2NyaXB0aW9uXCIpO1xuICAgICAgICBpZighdGFza1RpdGxlTWF0Y2godGl0bGUudGV4dENvbnRlbnQpKSB7XG4gICAgICAgICAgICBjb25zdCBuZXdUYXNrID0gdXNlclRhc2sodGl0bGUudGV4dENvbnRlbnQsIFtkZXNjcmlwdGlvbi52YWx1ZV0pO1xuICAgICAgICAgICAgdGFza0Fyci5wdXNoKG5ld1Rhc2spO1xuICAgICAgICB9ZWxzZSB7XG4gICAgICAgICAgICBjb25zdCBpbmRleCA9IGZpbmRJbmRleCh0YXNrQXJyKTtcbiAgICAgICAgICAgIHRhc2tBcnJbaW5kZXhdLmRlc2MucHVzaChkZXNjcmlwdGlvbi52YWx1ZSk7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgaW5kZXggPSBmaW5kSW5kZXgodGFza0Fycik7XG4gICAgICAgIGRpc3BsYXlUYXNrKHRhc2tBcnJbaW5kZXhdLmRlc2MpO1xuICAgICAgICB0YXNrTW9kYWwuY2xvc2UoKTtcbiAgICAgICAgSFRNTEZvcm1FbGVtZW50LnByb3RvdHlwZS5yZXNldC5jYWxsKGZvcm0pXG4gICAgfSwge29uY2U6IHRydWV9KTtcbn1cblxuZnVuY3Rpb24gZWRpdFRhc2tGb3JtKHByb2plY3RUaXRsZSwgdGFza1RpdGxlKSB7XG4gICAgY29uc3QgZWRpdFRhc2tNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZWRpdC10YXNrLW1vZGFsXCIpO1xuICAgIGNvbnN0IGZvcm0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmVkaXQtdGFzay1mb3JtXCIpO1xuICAgIGZvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZSkgPT4ge1xuICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIGNvbnN0IHRpdGxlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tYWluLWhkXCIpO1xuICAgICAgICBjb25zdCBkZXNjcmlwdGlvbiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiZWRpdC10YXNrLWRlc2NyaXB0aW9uXCIpO1xuICAgICAgICBjb25zdCBpbmRleCA9IGZpbmRJbmRleCh0YXNrQXJyLCBwcm9qZWN0VGl0bGUpO1xuICAgICAgICBjb25zdCB0YXNrSW5kZXggPSBmaW5kVGFza0luZGV4KHRhc2tBcnJbaW5kZXhdLmRlc2MsIHRhc2tUaXRsZSk7XG4gICAgICAgIGNvbnNvbGUubG9nKHRhc2tJbmRleCk7XG4gICAgICAgIHRhc2tBcnJbaW5kZXhdLmRlc2NbdGFza0luZGV4XSA9IGRlc2NyaXB0aW9uLnZhbHVlO1xuICAgICAgICBkaXNwbGF5VGFzayh0YXNrQXJyW2luZGV4XS5kZXNjKTtcbiAgICAgICAgZWRpdFRhc2tNb2RhbC5jbG9zZSgpO1xuICAgICAgICBIVE1MRm9ybUVsZW1lbnQucHJvdG90eXBlLnJlc2V0LmNhbGwoZm9ybSlcbiAgICB9LCB7b25jZTogdHJ1ZX0pO1xufVxuXG5mdW5jdGlvbiB1cGRhdGVUYXNrKGluZGV4LCBuZXdUaXRsZSkge1xuICAgIHRhc2tBcnJbaW5kZXhdLnRpdGxlID0gbmV3VGl0bGU7XG4gICAgZGlzcGxheVRhc2sodGFza0FycltpbmRleF0uZGVzYyk7XG59XG5cbmZ1bmN0aW9uIGRlbGV0ZVRhc2socHJvamVjdFRpdGxlLCB0YXNrVGl0bGUpIHtcbiAgICBjb25zdCBpbmRleCA9IGZpbmRJbmRleCh0YXNrQXJyLCBwcm9qZWN0VGl0bGUpO1xuICAgIGNvbnN0IHRhc2tJbmRleCA9IGZpbmRUYXNrSW5kZXgodGFza0FycltpbmRleF0uZGVzYywgdGFza1RpdGxlKTtcbiAgICB0YXNrQXJyW2luZGV4XS5kZXNjLnNwbGljZSh0YXNrSW5kZXgsIDEpO1xuICAgIGRpc3BsYXlUYXNrKHRhc2tBcnJbaW5kZXhdLmRlc2MpO1xufVxuXG5mdW5jdGlvbiBkZWxldGVFbnRpcmVUYXNrKHByb2plY3RUaXRsZSkge1xuICAgIGNvbnN0IGluZGV4ID0gZmluZEluZGV4KHRhc2tBcnIsIHByb2plY3RUaXRsZSk7XG4gICAgdGFza0Fyci5zcGxpY2UoaW5kZXgsIDEpO1xuICAgIGRpc3BsYXlUYXNrKHRhc2tBcnJbaW5kZXhdKTtcbiAgICBpZih0YXNrQXJyLmxlbmd0aCAhPT0gMCkgZGlzcGxheVRhc2sodGFza0FyclswXS5kZXNjKTtcbn1cblxuZnVuY3Rpb24gc2VsZWN0ZWRUYXNrKCkge1xuICAgIGNvbnN0IGluZGV4ID0gZmluZEluZGV4KHRhc2tBcnIpO1xuICAgIGlmKGluZGV4ICE9IC0xKSBkaXNwbGF5VGFzayh0YXNrQXJyW2luZGV4XS5kZXNjKTtcbn1cblxuZnVuY3Rpb24gZmluZEluZGV4KGFyciwgcHJvamVjdFRpdGxlKSB7XG4gICAgY29uc3QgdGl0bGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLm1haW4taGRcIik7XG4gICAgaWYodHlwZW9mIHByb2plY3RUaXRsZSA9PT0gXCJ1bmRlZmluZWRcIikgcmV0dXJuIGFyci5maW5kSW5kZXgodGFzayA9PiB0YXNrLnRpdGxlID09PSB0aXRsZS50ZXh0Q29udGVudCk7XG4gICAgZWxzZSByZXR1cm4gYXJyLmZpbmRJbmRleCh0YXNrID0+IHRhc2sudGl0bGUgPT09IHByb2plY3RUaXRsZSk7XG59XG5cbmZ1bmN0aW9uIGZpbmRUYXNrSW5kZXgoYXJyLCB0YXNrVGl0bGUpIHtcbiAgICBjb25zdCB0aXRsZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubWFpbi1oZFwiKTtcbiAgICByZXR1cm4gYXJyLmZpbmRJbmRleChpbmRleCA9PiBpbmRleCA9PT0gdGFza1RpdGxlKTtcbn1cblxuZnVuY3Rpb24gdGFza1RpdGxlTWF0Y2godGl0bGUpIHtcbiAgICBpZih0YXNrQXJyLmxlbmd0aCA9PT0gMCkgcmV0dXJuIGZhbHNlO1xuICAgIGZvcihsZXQgaSA9IDA7IGkgPCB0YXNrQXJyLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGlmKHRhc2tBcnJbaV0udGl0bGUgPT09IHRpdGxlKSByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gICAgcmV0dXJuIGZhbHNlO1xufVxuXG5leHBvcnQge3Rhc2tGb3JtLCBzZWxlY3RlZFRhc2ssIGRlbGV0ZUVudGlyZVRhc2ssIGVkaXRUYXNrRm9ybSwgZGVsZXRlVGFzaywgdXBkYXRlVGFza307IiwiaW1wb3J0IHsgZGlzcGxheVByb2plY3QsIGRpc3BsYXlNYWluLCBkaXNwbGF5RGVsZXRlTWFpbiB9IGZyb20gXCIuL1VJXCI7XG5pbXBvcnQgeyB1cGRhdGVUYXNrIH0gZnJvbSBcIi4vdGFza1wiO1xuXG5cbmxldCBwcm9qZWN0QXJyID0gW107XG5cbmNvbnN0IHVzZXJQcm9qZWN0ID0gKHRpdGxlLCBkZXNjLCBkdWVEYXRlLCBwcmlvcml0eSkgPT4ge1xuICAgIHJldHVybiB7dGl0bGUsIGRlc2MsIGR1ZURhdGUsIHByaW9yaXR5fTtcbn1cblxuZnVuY3Rpb24gcHJvamVjdEZvcm0oKSB7XG4gICAgY29uc3QgcHJvamVjdE1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9qZWN0LW1vZGFsXCIpO1xuICAgIGNvbnN0IGZvcm0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2plY3QtZm9ybVwiKTtcbiAgICBmb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGUpID0+IHtcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICBjb25zdCB0aXRsZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwidGl0bGVcIik7XG4gICAgICAgIGNvbnN0IGRlc2NyaXB0aW9uID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJkZXNjcmlwdGlvblwiKTtcbiAgICAgICAgY29uc3QgZHVlRGF0ZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiZHVlLWRhdGVcIik7XG4gICAgICAgIGxldCBwcmlvcml0eSA9IFwiTG93XCI7XG4gICAgICAgIGlmKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvamVjdC1tb2RhbCAjbWVkaXVtXCIpLmNoZWNrZWQpIHByaW9yaXR5ID0gXCJNZWRpdW1cIjtcbiAgICAgICAgZWxzZSBpZihkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2plY3QtbW9kYWwgI2hpZ2hcIikuY2hlY2tlZCkgcHJpb3JpdHkgPSBcIkhpZ2hcIjtcbiAgICAgICAgZWxzZSBwcmlvcml0eTtcbiAgICAgICAgY29uc3QgbmV3UHJvamVjdCA9IHVzZXJQcm9qZWN0KHRpdGxlLnZhbHVlLCBkZXNjcmlwdGlvbi52YWx1ZSwgZHVlRGF0ZS52YWx1ZSwgcHJpb3JpdHkpO1xuICAgICAgICBwcm9qZWN0QXJyLnB1c2gobmV3UHJvamVjdCk7XG4gICAgICAgIGRpc3BsYXlQcm9qZWN0KHByb2plY3RBcnIpO1xuICAgICAgICBkaXNwbGF5TWFpbihuZXdQcm9qZWN0KTtcbiAgICAgICAgcHJvamVjdE1vZGFsLmNsb3NlKCk7XG4gICAgICAgIEhUTUxGb3JtRWxlbWVudC5wcm90b3R5cGUucmVzZXQuY2FsbChmb3JtKTtcbiAgICB9LCB7b25jZTogdHJ1ZX0pO1xufVxuXG5mdW5jdGlvbiBlZGl0UHJvamVjdEZvcm0ocHJvamVjdFRpdGxlKSB7XG5cbiAgICBjb25zdCBlZGl0TW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmVkaXQtbW9kYWxcIik7XG4gICAgY29uc3QgZWRpdEZvcm0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmVkaXQtZm9ybVwiKTtcbiAgICBlZGl0Rm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChlKSA9PiB7XG4gICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgY29uc3QgdGl0bGUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImVkaXQtdGl0bGVcIik7XG4gICAgICAgIGNvbnN0IGRlc2NyaXB0aW9uID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJlZGl0LWRlc2NyaXB0aW9uXCIpO1xuICAgICAgICBjb25zdCBkdWVEYXRlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJlZGl0LWR1ZS1kYXRlXCIpO1xuICAgICAgICBsZXQgcHJpb3JpdHkgPSBcIkxvd1wiO1xuICAgICAgICBpZihkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmVkaXQtZm9ybSAjbWVkaXVtXCIpLmNoZWNrZWQpIHByaW9yaXR5ID0gXCJNZWRpdW1cIjtcbiAgICAgICAgZWxzZSBpZihkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmVkaXQtZm9ybSAjaGlnaFwiKS5jaGVja2VkKSBwcmlvcml0eSA9IFwiSGlnaFwiO1xuICAgICAgICBlbHNlIHByaW9yaXR5O1xuICAgICAgICBjb25zdCBpbmRleCA9IGZpbmRQcm9qZWN0KHByb2plY3RUaXRsZSk7XG4gICAgICAgIHByb2plY3RBcnJbaW5kZXhdLnRpdGxlID0gdGl0bGUudmFsdWU7XG4gICAgICAgIHByb2plY3RBcnJbaW5kZXhdLmRlc2MgPSBkZXNjcmlwdGlvbi52YWx1ZTtcbiAgICAgICAgcHJvamVjdEFycltpbmRleF0uZHVlRGF0ZSA9IGR1ZURhdGUudmFsdWU7XG4gICAgICAgIHByb2plY3RBcnJbaW5kZXhdLnByaW9yaXR5ID0gcHJpb3JpdHk7XG4gICAgICAgIGRpc3BsYXlQcm9qZWN0KHByb2plY3RBcnIpO1xuICAgICAgICBkaXNwbGF5TWFpbihwcm9qZWN0QXJyW2luZGV4XSk7XG4gICAgICAgIHVwZGF0ZVRhc2soaW5kZXgsIHRpdGxlLnZhbHVlKTtcbiAgICAgICAgZWRpdE1vZGFsLmNsb3NlKCk7XG4gICAgICAgIGNvbnNvbGUubG9nKHByb2plY3RBcnIpO1xuICAgICAgICBIVE1MRm9ybUVsZW1lbnQucHJvdG90eXBlLnJlc2V0LmNhbGwoZWRpdEZvcm0pXG4gICAgfSwge29uY2U6IHRydWV9KTtcbn1cblxuZnVuY3Rpb24gZGVsZXRlUHJvamVjdChwcm9qZWN0VGl0bGUpIHtcbiAgICBjb25zdCBpbmRleCA9IGZpbmRQcm9qZWN0KHByb2plY3RUaXRsZSk7XG4gICAgcHJvamVjdEFyci5zcGxpY2UoaW5kZXgsIDEpO1xuICAgIGNvbnNvbGUubG9nKHByb2plY3RBcnIpO1xuICAgIGRpc3BsYXlQcm9qZWN0KHByb2plY3RBcnIpO1xuICAgIGRpc3BsYXlEZWxldGVNYWluKHByb2plY3RBcnIpO1xufVxuXG5mdW5jdGlvbiBzZWxlY3RlZFByb2plY3QocHJvamVjdFRpdGxlKSB7XG4gICAgY29uc3QgaW5kZXggPSBmaW5kUHJvamVjdChwcm9qZWN0VGl0bGUpO1xuICAgIGRpc3BsYXlNYWluKHByb2plY3RBcnJbaW5kZXhdKTtcbn1cblxuZnVuY3Rpb24gZmluZFByb2plY3QocHJvamVjdFRpdGxlKSB7XG4gICAgcmV0dXJuIHByb2plY3RBcnIuZmluZEluZGV4KHByb2plY3QgPT4gcHJvamVjdC50aXRsZSA9PT0gcHJvamVjdFRpdGxlKTtcbn1cblxuZXhwb3J0IHtwcm9qZWN0Rm9ybSwgZWRpdFByb2plY3RGb3JtLCBkZWxldGVQcm9qZWN0LCBzZWxlY3RlZFByb2plY3R9OyIsImltcG9ydCB7IHByb2plY3RGb3JtLCBlZGl0UHJvamVjdEZvcm19IGZyb20gXCIuL3Byb2plY3RcIjtcbmltcG9ydCB7IHRhc2tGb3JtLCBlZGl0VGFza0Zvcm0gfSBmcm9tIFwiLi90YXNrXCI7XG5cblxuZnVuY3Rpb24gZGlzcGxheVByb2plY3RNb2RhbCgpIHtcbiAgICBjb25zdCBmb3JtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9qZWN0LWZvcm1cIik7XG4gICAgY29uc3QgcHJvamVjdE1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9qZWN0LW1vZGFsXCIpO1xuICAgIHByb2plY3RNb2RhbC5zaG93TW9kYWwoKTtcbiAgICBwcm9qZWN0Rm9ybSgpO1xuXG4gICAgY29uc3QgY2xvc2VCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2plY3QtY2xvc2VcIik7XG4gICAgY2xvc2VCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICAgICAgcHJvamVjdE1vZGFsLmNsb3NlKCk7XG4gICAgICAgIEhUTUxGb3JtRWxlbWVudC5wcm90b3R5cGUucmVzZXQuY2FsbChmb3JtKVxuICAgIH0pO1xufVxuXG5mdW5jdGlvbiBkaXNwbGF5RWRpdFByb2plY3RNb2RhbChwcm9qZWN0VGl0bGUpIHtcbiAgICBjb25zdCBmb3JtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5lZGl0LWZvcm1cIik7XG4gICAgY29uc3QgcHJvamVjdE1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5lZGl0LW1vZGFsXCIpO1xuICAgIHByb2plY3RNb2RhbC5zaG93TW9kYWwoKTtcbiAgICBlZGl0UHJvamVjdEZvcm0ocHJvamVjdFRpdGxlKTtcblxuICAgIGNvbnN0IGNsb3NlQnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5lZGl0LWNsb3NlXCIpO1xuICAgIGNsb3NlQnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgICAgIHByb2plY3RNb2RhbC5jbG9zZSgpO1xuICAgICAgICBIVE1MRm9ybUVsZW1lbnQucHJvdG90eXBlLnJlc2V0LmNhbGwoZm9ybSlcbiAgICB9KTtcbn1cblxuLyogZGlzcGxheWluZyBwcm9qZWN0IGxpc3Qgb24gbGVmdCBzaWRlIG9mIHNjcmVlbiAqL1xuZnVuY3Rpb24gZGlzcGxheVByb2plY3QoYXJyKSB7XG4gICAgY29uc3QgaGVhZGVyQ29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tYWluLWhkLWNvblwiKTtcbiAgICBoZWFkZXJDb250YWluZXIuc3R5bGUucGFkZGluZ0JvdHRvbSA9IFwiMXJlbVwiO1xuICAgIGNvbnN0IHByb2plY3RMaXN0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9qZWN0LWxpc3RcIik7XG4gICAgcHJvamVjdExpc3QudGV4dENvbnRlbnQgPSBcIlwiO1xuICAgIGZvcihsZXQgcHJvamVjdCA9IDA7IHByb2plY3QgPCBhcnIubGVuZ3RoOyBwcm9qZWN0KyspIHtcbiAgICAgICAgcHJvamVjdExpc3QuYXBwZW5kQ2hpbGQoY3JlYXRlUHJvamVjdEVsKGFycltwcm9qZWN0XSkpO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gY3JlYXRlUHJvamVjdEVsKGFycikge1xuICAgIGNvbnN0IHByb2plY3RDb24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICAgIHByb2plY3RDb24uY2xhc3NMaXN0LmFkZChcIm5ldy1wcm9qZWN0LWNvblwiKTtcblxuICAgIGNvbnN0IHByb2plY3RUaXRsZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJwXCIpO1xuICAgIHByb2plY3RUaXRsZS5jbGFzc0xpc3QuYWRkKFwicHJvamVjdC10aXRsZVwiKTtcbiAgICBwcm9qZWN0VGl0bGUudGV4dENvbnRlbnQgPSBhcnIudGl0bGU7XG4gICAgcHJvamVjdENvbi5hcHBlbmRDaGlsZChwcm9qZWN0VGl0bGUpO1xuICAgIHByb2plY3RDb24uYXBwZW5kQ2hpbGQoY3JlYXRlQnV0dG9ucygpKTtcbiAgICByZXR1cm4gcHJvamVjdENvbjtcbn1cblxuZnVuY3Rpb24gY3JlYXRlQnV0dG9ucygpIHtcbiAgICBjb25zdCBwcm9qZWN0QnRuID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcbiAgICBwcm9qZWN0QnRuLmNsYXNzTGlzdC5hZGQoXCJwcm9qZWN0LWJ0blwiKTtcblxuICAgIGNvbnN0IGVkaXRCdG4gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwic3BhblwiKTtcbiAgICBlZGl0QnRuLmNsYXNzTGlzdC5hZGQoXCJtYXRlcmlhbC1pY29ucy1vdXRsaW5lZFwiKTtcbiAgICBlZGl0QnRuLmNsYXNzTGlzdC5hZGQoXCJlZGl0XCIpO1xuICAgIGVkaXRCdG4udGV4dENvbnRlbnQgPSBcImVkaXRcIjtcbiAgICBwcm9qZWN0QnRuLmFwcGVuZENoaWxkKGVkaXRCdG4pO1xuXG4gICAgY29uc3QgZGVsZXRlQnRuID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInNwYW5cIik7XG4gICAgZGVsZXRlQnRuLmNsYXNzTGlzdC5hZGQoXCJtYXRlcmlhbC1pY29ucy1vdXRsaW5lZFwiKTtcbiAgICBkZWxldGVCdG4uY2xhc3NMaXN0LmFkZChcImRlbGV0ZVwiKTtcbiAgICBkZWxldGVCdG4udGV4dENvbnRlbnQgPSBcImRlbGV0ZVwiO1xuICAgIHByb2plY3RCdG4uYXBwZW5kQ2hpbGQoZGVsZXRlQnRuKTtcbiAgICByZXR1cm4gcHJvamVjdEJ0bjtcbn1cblxuZnVuY3Rpb24gZGlzcGxheVRhc2tNb2RhbCgpIHtcbiAgICBjb25zdCBmb3JtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi50YXNrLWZvcm1cIik7XG4gICAgY29uc3QgdGFza01vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi50YXNrLW1vZGFsXCIpO1xuICAgIHRhc2tNb2RhbC5zaG93TW9kYWwoKTtcbiAgICB0YXNrRm9ybSgpO1xuXG4gICAgY29uc3QgY2xvc2VCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnRhc2stY2xvc2VcIik7XG4gICAgY2xvc2VCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICAgICAgdGFza01vZGFsLmNsb3NlKCk7XG4gICAgICAgIEhUTUxGb3JtRWxlbWVudC5wcm90b3R5cGUucmVzZXQuY2FsbChmb3JtKTtcbiAgICB9KTtcbn1cblxuZnVuY3Rpb24gZGlzcGxheUVkaXRUYXNrTW9kYWwocHJvamVjdFRpdGxlLHRhc2tUaXRsZSkge1xuICAgIGNvbnN0IGZvcm0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmVkaXQtdGFzay1mb3JtXCIpO1xuICAgIGNvbnN0IGVkaXRUYXNrTW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmVkaXQtdGFzay1tb2RhbFwiKTtcbiAgICBlZGl0VGFza01vZGFsLnNob3dNb2RhbCgpO1xuICAgIGVkaXRUYXNrRm9ybShwcm9qZWN0VGl0bGUsIHRhc2tUaXRsZSk7XG5cbiAgICBjb25zdCBjbG9zZUJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZWRpdC10YXNrLWNsb3NlXCIpO1xuICAgIGNsb3NlQnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgICAgIGVkaXRUYXNrTW9kYWwuY2xvc2UoKTtcbiAgICAgICAgSFRNTEZvcm1FbGVtZW50LnByb3RvdHlwZS5yZXNldC5jYWxsKGZvcm0pO1xuICAgIH0pXG59XG5cbmZ1bmN0aW9uIGRpc3BsYXlUYXNrKGFycikge1xuICAgIGNvbnN0IHRhc2tMaXN0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9qZWN0LXRhc2stbGlzdFwiKTtcbiAgICBpZih0eXBlb2YgYXJyID09PSBcInVuZGVmaW5lZFwiKSB7XG4gICAgICAgIHRhc2tMaXN0LnRleHRDb250ZW50ID0gXCJcIjtcbiAgICB9ZWxzZSB7XG4gICAgICAgIHRhc2tMaXN0LnRleHRDb250ZW50ID0gXCJcIjtcbiAgICAgICAgZm9yKGxldCBpID0gMDsgaSA8IGFyci5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgY29uc29sZS5sb2coYXJyW2ldKTtcbiAgICAgICAgICAgIHRhc2tMaXN0LmFwcGVuZENoaWxkKGNyZWF0ZVRhc2tFbChhcnJbaV0pKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICB0YXNrTGlzdC5hcHBlbmRDaGlsZChjcmVhdGVBZGRUYXNrQnRuKCkpO1xufVxuXG5mdW5jdGlvbiBjcmVhdGVUYXNrRWwoZGVzYykge1xuICAgIGNvbnN0IHByb2plY3RUYXNrID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcbiAgICBwcm9qZWN0VGFzay5jbGFzc0xpc3QuYWRkKFwicHJvamVjdC10YXNrXCIpO1xuXG4gICAgY29uc3QgdGFza0xlZnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICAgIHRhc2tMZWZ0LmNsYXNzTGlzdC5hZGQoXCJwcm9qZWN0LXRhc2stbGVmdFwiKTtcbiAgICBwcm9qZWN0VGFzay5hcHBlbmRDaGlsZCh0YXNrTGVmdCk7XG5cbiAgICBjb25zdCB0YXNrRGVzYyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJwXCIpO1xuICAgIHRhc2tEZXNjLmNsYXNzTGlzdC5hZGQoXCJwcm9qZWN0LXRhc2stZGVzY1wiKTtcbiAgICB0YXNrRGVzYy50ZXh0Q29udGVudCA9IGRlc2M7XG4gICAgdGFza0xlZnQuYXBwZW5kQ2hpbGQodGFza0Rlc2MpO1xuXG4gICAgcHJvamVjdFRhc2suYXBwZW5kQ2hpbGQoY3JlYXRlVGFza0J1dHRvbnMoKSk7XG5cbiAgICByZXR1cm4gcHJvamVjdFRhc2s7XG59XG5cbmZ1bmN0aW9uIGNyZWF0ZVRhc2tCdXR0b25zKCkge1xuICAgIGNvbnN0IHByb2plY3RCdG4gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICAgIHByb2plY3RCdG4uY2xhc3NMaXN0LmFkZChcInByb2plY3QtdGFzay1idG5cIik7XG5cbiAgICBjb25zdCBlZGl0QnRuID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInNwYW5cIik7XG4gICAgZWRpdEJ0bi5jbGFzc0xpc3QuYWRkKFwibWF0ZXJpYWwtaWNvbnMtb3V0bGluZWRcIik7XG4gICAgZWRpdEJ0bi5jbGFzc0xpc3QuYWRkKFwiZWRpdFwiKTtcbiAgICBlZGl0QnRuLnRleHRDb250ZW50ID0gXCJlZGl0XCI7XG4gICAgcHJvamVjdEJ0bi5hcHBlbmRDaGlsZChlZGl0QnRuKTtcblxuICAgIGNvbnN0IGRlbGV0ZUJ0biA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJzcGFuXCIpO1xuICAgIGRlbGV0ZUJ0bi5jbGFzc0xpc3QuYWRkKFwibWF0ZXJpYWwtaWNvbnMtb3V0bGluZWRcIik7XG4gICAgZGVsZXRlQnRuLmNsYXNzTGlzdC5hZGQoXCJkZWxldGVcIik7XG4gICAgZGVsZXRlQnRuLnRleHRDb250ZW50ID0gXCJkZWxldGVcIjtcbiAgICBwcm9qZWN0QnRuLmFwcGVuZENoaWxkKGRlbGV0ZUJ0bik7XG4gICAgcmV0dXJuIHByb2plY3RCdG47XG59XG5cbmZ1bmN0aW9uIGNyZWF0ZUFkZFRhc2tCdG4oKSB7XG4gICAgY29uc3QgYWRkVGFza0J0biA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJidXR0b25cIik7XG4gICAgYWRkVGFza0J0bi5jbGFzc0xpc3QuYWRkKFwiYWRkLXRhc2tcIik7XG5cbiAgICBjb25zdCBhZGRJY29uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInNwYW5cIik7XG4gICAgYWRkSWNvbi5jbGFzc0xpc3QuYWRkKFwibWF0ZXJpYWwtaWNvbnMtb3V0bGluZWRcIik7XG4gICAgYWRkSWNvbi5jbGFzc0xpc3QuYWRkKFwiYWRkLWljb25cIik7XG4gICAgYWRkSWNvbi50ZXh0Q29udGVudCA9IFwiYWRkXCI7XG4gICAgYWRkVGFza0J0bi5wcmVwZW5kKGFkZEljb24sIFwiQWRkIFRhc2tcIik7XG4gICAgcmV0dXJuIGFkZFRhc2tCdG47XG59XG5cbmZ1bmN0aW9uIGRpc3BsYXlNYWluKHByb2plY3QpIHtcbiAgICBjb25zdCBoZWFkZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLm1haW4taGRcIik7XG4gICAgaGVhZGVyLnRleHRDb250ZW50ID0gcHJvamVjdC50aXRsZTtcblxuICAgIGNvbnN0IGRlc2MgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLm1haW4taGQtZGVzY1wiKTtcbiAgICBkZXNjLnRleHRDb250ZW50ID0gcHJvamVjdC5kZXNjO1xuXG4gICAgY29uc3QgZHVlRGF0ZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubWFpbi1oZC1kYXRlLXVzZXJcIik7XG4gICAgZHVlRGF0ZS50ZXh0Q29udGVudCA9IHByb2plY3QuZHVlRGF0ZTtcblxuICAgIGNvbnN0IHByaW9yaXR5ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tYWluLWhkLXByaW9yaXR5LXVzZXJcIik7XG4gICAgcHJpb3JpdHkudGV4dENvbnRlbnQgPSBwcm9qZWN0LnByaW9yaXR5O1xuICAgIHByaW9yaXR5LnN0eWxlLmNvbG9yID0gcHJpb3JpdHlDb2xvcihwcm9qZWN0LnByaW9yaXR5KTtcblxuICAgIGNvbnN0IHRhc2tMaXN0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9qZWN0LXRhc2stbGlzdFwiKTtcbiAgICB0YXNrTGlzdC50ZXh0Q29udGVudCA9IFwiXCI7XG4gICAgdGFza0xpc3QuYXBwZW5kQ2hpbGQoY3JlYXRlQWRkVGFza0J0bigpKTtcbn1cblxuZnVuY3Rpb24gZGlzcGxheURlbGV0ZU1haW4oYXJyKSB7XG4gICAgY29uc3QgaGVhZGVyQ29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tYWluLWhkLWNvblwiKTtcblxuICAgIGNvbnN0IGhlYWRlciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubWFpbi1oZFwiKTtcblxuICAgIGNvbnN0IGRlc2MgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLm1haW4taGQtZGVzY1wiKTtcblxuICAgIGNvbnN0IGR1ZURhdGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLm1haW4taGQtZGF0ZS11c2VyXCIpO1xuXG4gICAgY29uc3QgcHJpb3JpdHkgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLm1haW4taGQtcHJpb3JpdHktdXNlclwiKTtcblxuICAgIGlmKGFyci5sZW5ndGggPT09IDApIHtcbiAgICAgICAgaGVhZGVyLnRleHRDb250ZW50ID0gXCJcIjtcbiAgICAgICAgZGVzYy50ZXh0Q29udGVudCA9IFwiXCI7XG4gICAgICAgIGR1ZURhdGUudGV4dENvbnRlbnQgPSBcIlwiO1xuICAgICAgICBwcmlvcml0eS50ZXh0Q29udGVudCA9IFwiXCI7XG4gICAgICAgIGhlYWRlckNvbnRhaW5lci5zdHlsZS5wYWRkaW5nQm90dG9tID0gXCI0LjlyZW1cIjtcbiAgICB9ZWxzZSB7XG4gICAgICAgIGhlYWRlci50ZXh0Q29udGVudCA9IGFyclswXS50aXRsZTtcbiAgICAgICAgZGVzYy50ZXh0Q29udGVudCA9IGFyclswXS5kZXNjO1xuICAgICAgICBkdWVEYXRlLnRleHRDb250ZW50ID0gYXJyWzBdLmR1ZURhdGU7XG4gICAgICAgIHByaW9yaXR5LnRleHRDb250ZW50ID0gYXJyWzBdLnByaW9yaXR5O1xuICAgIH1cblxufVxuXG5mdW5jdGlvbiBwcmlvcml0eUNvbG9yKGxldmVsKSB7XG4gICAgaWYobGV2ZWwgPT09IFwiTG93XCIpIHJldHVybiBcImdyZWVuXCI7XG4gICAgZWxzZSBpZihsZXZlbCA9PT0gXCJNZWRpdW1cIikgcmV0dXJuIFwieWVsbG93XCI7XG4gICAgZWxzZSByZXR1cm4gXCJyZWRcIjtcbn1cblxuZXhwb3J0IHtkaXNwbGF5UHJvamVjdCwgZGlzcGxheVByb2plY3RNb2RhbCwgZGlzcGxheUVkaXRQcm9qZWN0TW9kYWwsIGRpc3BsYXlNYWluLCBkaXNwbGF5RGVsZXRlTWFpbiwgZGlzcGxheVRhc2tNb2RhbCwgZGlzcGxheVRhc2ssIGRpc3BsYXlFZGl0VGFza01vZGFsfTsiLCJpbXBvcnQgeyBkaXNwbGF5UHJvamVjdE1vZGFsLCBkaXNwbGF5RWRpdFByb2plY3RNb2RhbCwgZGlzcGxheVRhc2tNb2RhbCwgZGlzcGxheUVkaXRUYXNrTW9kYWx9IGZyb20gXCIuL1VJXCI7XG5pbXBvcnQgeyBkZWxldGVQcm9qZWN0LCBzZWxlY3RlZFByb2plY3QgfSBmcm9tIFwiLi9wcm9qZWN0XCI7XG5pbXBvcnQgeyBzZWxlY3RlZFRhc2ssIGRlbGV0ZUVudGlyZVRhc2ssIGRlbGV0ZVRhc2sgfSBmcm9tIFwiLi90YXNrXCI7XG5cbmNvbnN0IGFkZFByb2plY3RCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmFkZC1wcm9qZWN0XCIpO1xuYWRkUHJvamVjdEJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgIGRpc3BsYXlQcm9qZWN0TW9kYWwoKTtcbn0pO1xuXG5jb25zdCBlZGl0UHJvamVjdEJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvamVjdC1saXN0XCIpO1xuZWRpdFByb2plY3RCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChlKSA9PiB7XG4gICAgaWYoZS50YXJnZXQuY2xhc3NOYW1lID09PSBcIm1hdGVyaWFsLWljb25zLW91dGxpbmVkIGVkaXRcIikge1xuICAgICAgICBjb25zdCBwcm9qZWN0VGl0bGUgPSBlLnRhcmdldC5wYXJlbnRFbGVtZW50LnBhcmVudEVsZW1lbnQuY2hpbGROb2Rlc1swXS50ZXh0Q29udGVudDtcbiAgICAgICAgZGlzcGxheUVkaXRQcm9qZWN0TW9kYWwocHJvamVjdFRpdGxlKTtcbiAgICB9ZWxzZSBpZihlLnRhcmdldC5jbGFzc05hbWUgPT09IFwibWF0ZXJpYWwtaWNvbnMtb3V0bGluZWQgZGVsZXRlXCIpIHtcbiAgICAgICAgY29uc3QgcHJvamVjdFRpdGxlID0gZS50YXJnZXQucGFyZW50RWxlbWVudC5wYXJlbnRFbGVtZW50LmNoaWxkTm9kZXNbMF0udGV4dENvbnRlbnQ7XG4gICAgICAgIGRlbGV0ZVByb2plY3QocHJvamVjdFRpdGxlKTtcbiAgICAgICAgZGVsZXRlRW50aXJlVGFzayhwcm9qZWN0VGl0bGUpO1xuICAgIH1lbHNlIHtcbiAgICAgICAgaWYoZS50YXJnZXQuY2xhc3NOYW1lID09PSBcInByb2plY3QtdGl0bGVcIikge1xuICAgICAgICAgICAgY29uc3QgcHJvamVjdFRpdGxlID0gZS50YXJnZXQuY2xhc3NOYW1lO1xuICAgICAgICAgICAgY29uc3QgcHJvamVjdENvbiA9IGUudGFyZ2V0LnBhcmVudEVsZW1lbnQucGFyZW50RWxlbWVudDtcbiAgICAgICAgICAgIHNlbGVjdGVkUHJvamVjdChwcm9qZWN0VGl0bGUpO1xuICAgICAgICAgICAgc2VsZWN0ZWRUYXNrKCk7XG4gICAgICAgIH1lbHNlIHtcbiAgICAgICAgICAgIGNvbnN0IHByb2plY3RUaXRsZSA9IGUudGFyZ2V0LmNoaWxkTm9kZXNbMF0udGV4dENvbnRlbnQ7XG4gICAgICAgICAgICBjb25zdCBwcm9qZWN0Q29uID0gZS50YXJnZXQucGFyZW50RWxlbWVudDtcbiAgICAgICAgICAgIHNlbGVjdGVkUHJvamVjdChwcm9qZWN0VGl0bGUpO1xuICAgICAgICAgICAgc2VsZWN0ZWRUYXNrKCk7XG4gICAgICAgIH1cbiAgICB9XG59KTtcblxuY29uc3QgdGFza0xpc3QgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2plY3QtdGFzay1saXN0XCIpO1xudGFza0xpc3QuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChlKSA9PiB7XG4gICAgaWYoZS50YXJnZXQuY2xhc3NOYW1lID09PSBcImFkZC10YXNrXCIpIHtcbiAgICAgICAgZGlzcGxheVRhc2tNb2RhbCgpO1xuICAgIH1lbHNlIGlmKGUudGFyZ2V0LmNsYXNzTmFtZSA9PT0gXCJtYXRlcmlhbC1pY29ucy1vdXRsaW5lZCBlZGl0XCIpIHtcbiAgICAgICAgY29uc3QgdGFza1RpdGxlID0gZS50YXJnZXQucGFyZW50RWxlbWVudC5wYXJlbnRFbGVtZW50LmNoaWxkTm9kZXNbMF0udGV4dENvbnRlbnQ7XG4gICAgICAgIGNvbnN0IHByb2plY3RUaXRsZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubWFpbi1oZFwiKS50ZXh0Q29udGVudDtcbiAgICAgICAgZGlzcGxheUVkaXRUYXNrTW9kYWwocHJvamVjdFRpdGxlLCB0YXNrVGl0bGUpO1xuICAgIH1lbHNlIGlmKGUudGFyZ2V0LmNsYXNzTmFtZSA9PT0gXCJtYXRlcmlhbC1pY29ucy1vdXRsaW5lZCBkZWxldGVcIikge1xuICAgICAgICBjb25zdCB0YXNrVGl0bGUgPSBlLnRhcmdldC5wYXJlbnRFbGVtZW50LnBhcmVudEVsZW1lbnQuY2hpbGROb2Rlc1swXS50ZXh0Q29udGVudDtcbiAgICAgICAgY29uc3QgcHJvamVjdFRpdGxlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tYWluLWhkXCIpLnRleHRDb250ZW50O1xuICAgICAgICBkZWxldGVUYXNrKHByb2plY3RUaXRsZSwgdGFza1RpdGxlKTtcbiAgICB9XG59KSJdLCJuYW1lcyI6WyJ0YXNrQXJyIiwic2VsZWN0ZWRUYXNrIiwiaW5kZXgiLCJmaW5kSW5kZXgiLCJkaXNwbGF5VGFzayIsImRlc2MiLCJhcnIiLCJwcm9qZWN0VGl0bGUiLCJ0aXRsZSIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvciIsInRhc2siLCJ0ZXh0Q29udGVudCIsImZpbmRUYXNrSW5kZXgiLCJ0YXNrVGl0bGUiLCJwcm9qZWN0QXJyIiwic2VsZWN0ZWRQcm9qZWN0IiwiZmluZFByb2plY3QiLCJkaXNwbGF5TWFpbiIsInByb2plY3QiLCJkaXNwbGF5UHJvamVjdCIsInN0eWxlIiwicGFkZGluZ0JvdHRvbSIsInByb2plY3RMaXN0IiwibGVuZ3RoIiwiYXBwZW5kQ2hpbGQiLCJjcmVhdGVQcm9qZWN0RWwiLCJwcm9qZWN0Q29uIiwiY3JlYXRlRWxlbWVudCIsImNsYXNzTGlzdCIsImFkZCIsInByb2plY3RCdG4iLCJlZGl0QnRuIiwiZGVsZXRlQnRuIiwiY3JlYXRlQnV0dG9ucyIsInRhc2tMaXN0IiwiaSIsImNvbnNvbGUiLCJsb2ciLCJjcmVhdGVUYXNrRWwiLCJjcmVhdGVBZGRUYXNrQnRuIiwicHJvamVjdFRhc2siLCJ0YXNrTGVmdCIsInRhc2tEZXNjIiwiY3JlYXRlVGFza0J1dHRvbnMiLCJhZGRUYXNrQnRuIiwiYWRkSWNvbiIsInByZXBlbmQiLCJkdWVEYXRlIiwicHJpb3JpdHkiLCJsZXZlbCIsImNvbG9yIiwiYWRkRXZlbnRMaXN0ZW5lciIsImZvcm0iLCJwcm9qZWN0TW9kYWwiLCJzaG93TW9kYWwiLCJlIiwicHJldmVudERlZmF1bHQiLCJnZXRFbGVtZW50QnlJZCIsImRlc2NyaXB0aW9uIiwiY2hlY2tlZCIsIm5ld1Byb2plY3QiLCJ1c2VyUHJvamVjdCIsInZhbHVlIiwicHVzaCIsImNsb3NlIiwiSFRNTEZvcm1FbGVtZW50IiwicHJvdG90eXBlIiwicmVzZXQiLCJjYWxsIiwib25jZSIsInByb2plY3RGb3JtIiwiZGlzcGxheVByb2plY3RNb2RhbCIsInRhcmdldCIsImNsYXNzTmFtZSIsImVkaXRNb2RhbCIsImVkaXRGb3JtIiwibmV3VGl0bGUiLCJ1cGRhdGVUYXNrIiwiZWRpdFByb2plY3RGb3JtIiwiZGlzcGxheUVkaXRQcm9qZWN0TW9kYWwiLCJwYXJlbnRFbGVtZW50IiwiY2hpbGROb2RlcyIsInNwbGljZSIsImhlYWRlckNvbnRhaW5lciIsImhlYWRlciIsImRpc3BsYXlEZWxldGVNYWluIiwiZGVsZXRlUHJvamVjdCIsImRlbGV0ZUVudGlyZVRhc2siLCJ0YXNrTW9kYWwiLCJ0YXNrVGl0bGVNYXRjaCIsIm5ld1Rhc2siLCJ1c2VyVGFzayIsInRhc2tGb3JtIiwiZGlzcGxheVRhc2tNb2RhbCIsImVkaXRUYXNrTW9kYWwiLCJ0YXNrSW5kZXgiLCJlZGl0VGFza0Zvcm0iLCJkaXNwbGF5RWRpdFRhc2tNb2RhbCIsImRlbGV0ZVRhc2siXSwic291cmNlUm9vdCI6IiJ9